<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="10/5/2016 9:57:23 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="AMS06X"
  DTS:CreatorName="AMS\adminb"
  DTS:DTSID="{66321C35-00A6-47CA-83F9-E85CE3A21187}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="11274"
  DTS:ObjectName="Deuda y cobranzas H_CASCADA_PAGOS"
  DTS:PackageType="5"
  DTS:VersionBuild="14"
  DTS:VersionGUID="{A7BAE745-E77B-4164-8712-DE8203CA1C5C}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{83C21356-644B-4CB2-95EA-97F795D1467E}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">1,7,OnError</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{83C21356-644B-4CB2-95EA-97F795D1467E}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Actualiza cascada Afiliados"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{0AEACB7D-E3C2-4F69-B366-84DAEBE42825}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza cascada Afiliados"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F0B675C4-6A74-4D7F-9ACD-726CE3910D97}"
          SQLTask:SqlStatementSource="DELETE H_CASCADA_PAGO&#xA;--ACTUALIZA COMPANIA SANCOR&#xA;&#xA;INSERT INTO H_CASCADA_PAGO&#xA;SELECT DISTINCT 1,&#xA;&#x9;&#x9;&#x9;&#x9;id_tipo_deudor,&#xA;&#x9;&#x9;&#x9;&#x9;id_rango_pago,&#xA;&#x9;&#x9;&#x9;&#x9;0,&#xA;&#x9;&#x9;&#x9;&#x9;0&#xA;FROM H_COBRANZAS&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;id_tipo_deudor = H.id_tipo_deudor,&#xA;&#x9;id_rango_pago = H.id_rango_pago,&#xA;&#x9;total_pagado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_tipo_deudor, id_rango_pago, SUM(imp_comprobante_credito_aplicado-imp_comprobante_debito_aplicado) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_COBRANZAS C INNER JOIN D_TIPO_COMPROBANTE_DEUDA_COBRANZA D ON (C.id_tipo_comprobante_deuda_cobranza = D.id_tipo_comprobante_deuda_cobranza)&#xA;&#x9;&#x9;&#x9;WHERE id_periodo in (select id_periodo from D_PERIODO WHERE id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;and (id_periodo_ultima_aplicacion &gt;= (select MIN(id_periodo) from D_PERIODO WHERE id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;or id_periodo_ultima_aplicacion in (select top 1 H.id_periodo_ultima_aplicacion  from H_COBRANZAS H group by  H.id_periodo_ultima_aplicacion order by H.id_periodo_ultima_aplicacion asc))&#xA;&#x9;&#x9;&#x9;AND id_rango_pago IN (1, 2, 3, 4)&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza not in ('A', 'C', 'T')&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AJIA')&#xA;&#x9;&#x9;&#x9;and C.id_marca_incobrable in ('I')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDA')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_comprobante_aplicacion_cobranza in ('RGJA')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDA')&#xA;&#x9;&#x9;&#x9;and C.id_marca_incobrable in ('I')))&#xA;&#x9;&#x9;&#x9;and C.id_tipo_deudor in ('I')&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza in ('L', 'P', 'R')&#xA;&#x9;&#x9;&#x9;and C.id_compania = 1&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;GROUP BY id_tipo_deudor, id_rango_pago) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor AND C.id_rango_pago=H.id_rango_pago)&#xA;WHERE C.id_compania = 1 and C.id_tipo_deudor = 'I'&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;total_liquidado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_tipo_deudor, SUM(imp_comprobante_credito_deuda-imp_comprobante_debito_deuda) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_COBRANZAS C INNER JOIN D_TIPO_COMPROBANTE_DEUDA_COBRANZA D ON (C.id_tipo_comprobante_deuda_cobranza = D.id_tipo_comprobante_deuda_cobranza)&#xA;&#x9;&#x9;&#x9;WHERE id_periodo in (select id_periodo from D_PERIODO WHERE id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza not in ('A', 'C', 'T')&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AJIA')&#xA;&#x9;&#x9;&#x9;and C.id_marca_incobrable in ('I')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDA')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_comprobante_aplicacion_cobranza in ('RGJA')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDA')&#xA;&#x9;&#x9;&#x9;and C.id_marca_incobrable in ('I')))&#xA;&#x9;&#x9;&#x9;and C.id_tipo_deudor in ('I')&#xA;&#x9;&#x9;&#x9;and (D.id_origen_comprobante_deuda_cobranza in ('L')&#xA;&#x9;&#x9;&#x9;or D.id_origen_comprobante_deuda_cobranza in ('P')&#xA;&#x9;&#x9;&#x9;or (D.id_origen_comprobante_deuda_cobranza in ('R') and id_origen_recupero_cobranza IN (2,3,4)))&#xA;&#x9;&#x9;&#x9;and C.id_compania = 1&#xA;&#x9;&#x9;&#x9;GROUP BY id_tipo_deudor) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor)&#xA;WHERE C.id_compania = 1 and C.id_tipo_deudor = 'I'&#xA;&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;total_pagado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_compania, id_tipo_deudor, AVG(total_liquidado_cascada_pago)-SUM(total_pagado_cascada_pago) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_CASCADA_PAGO &#xA;&#x9;&#x9;&#x9;WHERE id_rango_pago IN (1, 2, 3, 4)&#xA;&#x9;&#x9;&#x9;GROUP BY id_compania, id_tipo_deudor) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor)&#xA;WHERE id_rango_pago = 5 and C.id_tipo_deudor = 'I'&#xA;&#xA;&#xA;&#xA;&#xA;--ACTUALIZA COMPANIA STAFF&#xA;&#xA;INSERT INTO H_CASCADA_PAGO&#xA;SELECT DISTINCT 2,&#xA;&#x9;&#x9;&#x9;&#x9;id_tipo_deudor,&#xA;&#x9;&#x9;&#x9;&#x9;id_rango_pago,&#xA;&#x9;&#x9;&#x9;&#x9;0,&#xA;&#x9;&#x9;&#x9;&#x9;0&#xA;FROM H_COBRANZAS&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;id_tipo_deudor = H.id_tipo_deudor,&#xA;&#x9;id_rango_pago = H.id_rango_pago,&#xA;&#x9;total_pagado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_tipo_deudor, id_rango_pago, SUM(imp_comprobante_credito_aplicado-imp_comprobante_debito_aplicado) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_COBRANZAS C INNER JOIN D_TIPO_COMPROBANTE_DEUDA_COBRANZA D ON (C.id_tipo_comprobante_deuda_cobranza = D.id_tipo_comprobante_deuda_cobranza)&#xA;&#x9;&#x9;&#x9;WHERE id_periodo in (select id_periodo from D_PERIODO WHERE id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;and (id_periodo_ultima_aplicacion &gt;= (select MIN(id_periodo) from D_PERIODO WHERE id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;or id_periodo_ultima_aplicacion in (select top 1 H.id_periodo_ultima_aplicacion  from H_COBRANZAS H group by  H.id_periodo_ultima_aplicacion order by H.id_periodo_ultima_aplicacion asc))&#xA;&#x9;&#x9;&#x9;AND id_rango_pago IN (1, 2, 3, 4)&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza not in ('A', 'C', 'T')&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AJIA')&#xA;&#x9;&#x9;&#x9;and C.id_marca_incobrable in ('I')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDA')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_comprobante_aplicacion_cobranza in ('RGJA')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDA')&#xA;&#x9;&#x9;&#x9;and C.id_marca_incobrable in ('I')))&#xA;&#x9;&#x9;&#x9;and C.id_tipo_deudor in ('I')&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza in ('L', 'P', 'R')&#xA;&#x9;&#x9;&#x9;and C.id_compania = 2&#x9;&#xA;&#x9;&#x9;&#x9;GROUP BY id_tipo_deudor, id_rango_pago) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor AND C.id_rango_pago=H.id_rango_pago)&#xA;WHERE C.id_compania = 2 and C.id_tipo_deudor = 'I'&#xA;&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;total_liquidado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_tipo_deudor, SUM(imp_comprobante_credito_deuda-imp_comprobante_debito_deuda) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_COBRANZAS C INNER JOIN D_TIPO_COMPROBANTE_DEUDA_COBRANZA D ON (C.id_tipo_comprobante_deuda_cobranza = D.id_tipo_comprobante_deuda_cobranza)&#xA;&#x9;&#x9;&#x9;WHERE id_periodo in (select id_periodo from D_PERIODO WHERE id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza not in ('A', 'C', 'T')&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AJIA')&#xA;&#x9;&#x9;&#x9;and C.id_marca_incobrable in ('I')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDA')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_comprobante_aplicacion_cobranza in ('RGJA')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDA')&#xA;&#x9;&#x9;&#x9;and C.id_marca_incobrable in ('I')))&#xA;&#x9;&#x9;&#x9;and C.id_tipo_deudor in ('I')&#xA;&#x9;&#x9;&#x9;and (D.id_origen_comprobante_deuda_cobranza in ('L')&#xA;&#x9;&#x9;&#x9;or D.id_origen_comprobante_deuda_cobranza in ('P')&#xA;&#x9;&#x9;&#x9;or (D.id_origen_comprobante_deuda_cobranza in ('R') and id_origen_recupero_cobranza IN (2,3,4)))&#xA;&#x9;&#x9;&#x9;and C.id_compania = 2&#xA;&#x9;&#x9;&#x9;GROUP BY id_tipo_deudor) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor)&#xA;WHERE C.id_compania = 2 and C.id_tipo_deudor = 'I'&#xA;&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;total_pagado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_compania, id_tipo_deudor, AVG(total_liquidado_cascada_pago)-SUM(total_pagado_cascada_pago) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_CASCADA_PAGO &#xA;&#x9;&#x9;&#x9;WHERE id_rango_pago IN (1, 2, 3, 4)&#xA;&#x9;&#x9;&#x9;GROUP BY id_compania, id_tipo_deudor) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor)&#xA;WHERE id_rango_pago = 5 and C.id_tipo_deudor = 'I'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualiza cascada Empresas"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{9EF162B0-A243-43DA-B607-18852F175BE6}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza cascada Empresas"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F0B675C4-6A74-4D7F-9ACD-726CE3910D97}"
          SQLTask:SqlStatementSource="UPDATE H_CASCADA_PAGO&#xA;SET&#x9;id_tipo_deudor = H.id_tipo_deudor,&#xA;&#x9;id_rango_pago = H.id_rango_pago,&#xA;&#x9;total_pagado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_tipo_deudor, id_rango_pago, SUM(imp_comprobante_credito_aplicado-imp_comprobante_debito_aplicado) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_COBRANZAS C INNER JOIN D_TIPO_COMPROBANTE_DEUDA_COBRANZA D ON (C.id_tipo_comprobante_deuda_cobranza = D.id_tipo_comprobante_deuda_cobranza)&#xA;&#x9;&#x9;&#x9;WHERE id_periodo in (select id_periodo from D_PERIODO where id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;and (id_periodo_ultima_aplicacion &gt;= (select MIN(id_periodo) from D_PERIODO where id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;or id_periodo_ultima_aplicacion in (select top 1 H.id_periodo_ultima_aplicacion  from H_COBRANZAS H group by  H.id_periodo_ultima_aplicacion order by H.id_periodo_ultima_aplicacion asc))&#xA;&#x9;&#x9;&#x9;and id_rango_pago IN (1, 2, 3, 4)&#xA;&#x9;&#x9;&#x9;and C.id_cuit_empresa_cobranza not in (30674286852, 30590354798, 30709566241, 30710344651, 30501677643)&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza not in ('C', 'T', 'X', 'A')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_deudor in ('E')&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AJUE')&#xA;&#x9;&#x9;&#x9;and C.id_cuit_empresa_cobranza = 30501677643))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AMRE')&#xA;&#x9;&#x9;&#x9;and C.id_forma_pago in ('PR ')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDE')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_comprobante_aplicacion_cobranza in ('RGJA')))&#xA;&#x9;&#x9;&#x9;and C.id_compania = 1&#xA;&#x9;&#x9;&#x9;GROUP BY id_tipo_deudor, id_rango_pago) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor AND C.id_rango_pago=H.id_rango_pago)&#xA;WHERE C.id_compania = 1 and C.id_tipo_deudor = 'E'&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;total_liquidado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_tipo_deudor, SUM(imp_comprobante_credito_deuda-imp_comprobante_debito_deuda) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_COBRANZAS C INNER JOIN D_TIPO_COMPROBANTE_DEUDA_COBRANZA D ON (C.id_tipo_comprobante_deuda_cobranza = D.id_tipo_comprobante_deuda_cobranza)&#xA;&#x9;&#x9;&#x9;WHERE id_periodo in (select id_periodo from D_PERIODO where id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;and C.id_cuit_empresa_cobranza not in (30674286852, 30590354798, 30709566241, 30710344651, 30501677643)&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza not in ('C', 'T', 'X', 'A')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_deudor in ('E')&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AJUE')&#xA;&#x9;&#x9;&#x9;and C.id_cuit_empresa_cobranza = 30501677643))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AMRE')&#xA;&#x9;&#x9;&#x9;and C.id_forma_pago in ('PR ')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDE')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_comprobante_aplicacion_cobranza in ('RGJA')))&#xA;&#x9;&#x9;&#x9;and C.id_compania = 1&#xA;&#x9;&#x9;&#x9;GROUP BY id_tipo_deudor) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor)&#xA;WHERE C.id_compania = 1 and C.id_tipo_deudor = 'E'&#xA;&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;total_pagado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_compania, id_tipo_deudor, AVG(total_liquidado_cascada_pago)-SUM(total_pagado_cascada_pago) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_CASCADA_PAGO &#xA;&#x9;&#x9;&#x9;WHERE id_rango_pago IN (1, 2, 3, 4)&#xA;&#x9;&#x9;&#x9;GROUP BY id_compania, id_tipo_deudor) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor)&#xA;WHERE id_rango_pago = 5 and C.id_tipo_deudor = 'E'&#xA;&#xA;&#xA;&#xA;&#xA;--ACTUALIZA COMPANIA STAFF&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;id_tipo_deudor = H.id_tipo_deudor,&#xA;&#x9;id_rango_pago = H.id_rango_pago,&#xA;&#x9;total_pagado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_tipo_deudor, id_rango_pago, SUM(imp_comprobante_credito_aplicado-imp_comprobante_debito_aplicado) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_COBRANZAS C INNER JOIN D_TIPO_COMPROBANTE_DEUDA_COBRANZA D ON (C.id_tipo_comprobante_deuda_cobranza = D.id_tipo_comprobante_deuda_cobranza)&#xA;&#x9;&#x9;&#x9;WHERE id_periodo in (select id_periodo from D_PERIODO where id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;and (id_periodo_ultima_aplicacion &gt;= (select MIN(id_periodo) from D_PERIODO where id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;or id_periodo_ultima_aplicacion in (select top 1 H.id_periodo_ultima_aplicacion  from H_COBRANZAS H group by  H.id_periodo_ultima_aplicacion order by H.id_periodo_ultima_aplicacion asc))&#xA;&#x9;&#x9;&#x9;and id_rango_pago IN (1, 2, 3, 4)&#xA;&#x9;&#x9;&#x9;and C.id_cuit_empresa_cobranza not in (30674286852, 30590354798, 30709566241, 30710344651, 30501677643)&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza not in ('C', 'T', 'X', 'A')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_deudor in ('E')&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AJUE')&#xA;&#x9;&#x9;&#x9;and C.id_cuit_empresa_cobranza = 30501677643))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AMRE')&#xA;&#x9;&#x9;&#x9;and C.id_forma_pago in ('PR ')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDE')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_comprobante_aplicacion_cobranza in ('RGJA')))&#xA;&#x9;&#x9;&#x9;and C.id_compania = 2&#xA;&#x9;&#x9;&#x9;GROUP BY id_tipo_deudor, id_rango_pago) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor AND C.id_rango_pago=H.id_rango_pago)&#xA;WHERE C.id_compania = 2 and C.id_tipo_deudor = 'E'&#xA;&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;total_liquidado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_tipo_deudor, SUM(imp_comprobante_credito_deuda-imp_comprobante_debito_deuda) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_COBRANZAS C INNER JOIN D_TIPO_COMPROBANTE_DEUDA_COBRANZA D ON (C.id_tipo_comprobante_deuda_cobranza = D.id_tipo_comprobante_deuda_cobranza)&#xA;&#x9;&#x9;&#x9;WHERE id_periodo in (select id_periodo from D_PERIODO where id_periodo_anual_cobranza = 3)&#xA;&#x9;&#x9;&#x9;and C.id_cuit_empresa_cobranza not in (30674286852, 30590354798, 30709566241, 30710344651, 30501677643)&#xA;&#x9;&#x9;&#x9;and D.id_origen_comprobante_deuda_cobranza not in ('C', 'T', 'X', 'A')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_deudor in ('E')&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AJUE')&#xA;&#x9;&#x9;&#x9;and C.id_cuit_empresa_cobranza = 30501677643))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('AMRE')&#xA;&#x9;&#x9;&#x9;and C.id_forma_pago in ('PR ')))&#xA;&#x9;&#x9;&#x9;and (not (C.id_tipo_comprobante_deuda_cobranza in ('CHDE')&#xA;&#x9;&#x9;&#x9;and C.id_tipo_comprobante_aplicacion_cobranza in ('RGJA')))&#xA;&#x9;&#x9;&#x9;and C.id_compania = 2&#xA;&#x9;&#x9;&#x9;GROUP BY id_tipo_deudor) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor)&#xA;WHERE C.id_compania = 2 and C.id_tipo_deudor = 'E'&#xA;&#xA;&#xA;&#xA;UPDATE H_CASCADA_PAGO&#xA;SET&#x9;total_pagado_cascada_pago = sumTotal&#xA;FROM H_CASCADA_PAGO C&#xA;INNER JOIN (SELECT id_compania, id_tipo_deudor, AVG(total_liquidado_cascada_pago)-SUM(total_pagado_cascada_pago) AS sumTotal&#xA;&#x9;&#x9;&#x9;FROM H_CASCADA_PAGO &#xA;&#x9;&#x9;&#x9;WHERE id_rango_pago IN (1, 2, 3, 4)&#xA;&#x9;&#x9;&#x9;GROUP BY id_compania, id_tipo_deudor) AS H&#xA;ON (C.id_tipo_deudor=H.id_tipo_deudor)&#xA;WHERE id_rango_pago = 5 and C.id_tipo_deudor = 'E'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{17F2B15D-813B-4596-B6EB-770EDD89A515}"
      DTS:From="Package\Actualiza cascada Afiliados"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Actualiza cascada Empresas" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="183,44"
          Id="Package\Actualiza cascada Afiliados"
          TopLeft="217.481132075472,64.5" />
        <NodeLayout
          Size="185,44"
          Id="Package\Actualiza cascada Empresas"
          TopLeft="216.5,139.405660377358" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="308.820754716981,108.424528301887">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,30.9811320754717"
              Start="0,0"
              End="0,23.4811320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.4811320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>