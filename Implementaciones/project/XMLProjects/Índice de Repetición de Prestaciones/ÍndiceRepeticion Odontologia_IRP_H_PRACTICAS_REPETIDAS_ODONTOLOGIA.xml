<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="6/25/2019 3:00:20 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DES2921"
  DTS:CreatorName="AMS\aquaglia"
  DTS:DTSID="{DB8B80F3-69C2-40B1-8633-BEBD1CF27465}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="3082"
  DTS:ObjectName="ÍndiceRepeticion Odontologia_IRP_H_PRACTICAS_REPETIDAS_ODONTOLOGIA"
  DTS:PackageType="5"
  DTS:VersionBuild="19"
  DTS:VersionGUID="{A17AD215-5AEB-4BA3-803A-298ACC5E66EA}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{C6F8BD02-9CCE-4570-BC6D-CF060B589F78}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">1,7,OnError</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{C6F8BD02-9CCE-4570-BC6D-CF060B589F78}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Armado de H_PRACTICAS_REPETIDAS_ODONTOLOGIA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{df4028ba-51be-4a2e-8883-d4827fb8396f}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Armado de H_PRACTICAS_REPETIDAS_ODONTOLOGIA"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{AF81043D-1159-4CE8-9D9C-6F22CFB556AE}"
          SQLTask:SqlStatementSource="SET DATEFORMAT 'YMD'&#xA;&#xA;Truncate Table H_PRACTICAS_REPETIDAS_ODONTOLOGIA&#xA;&#xA;select&#x9;&#xA;&#x9;a11.id_profesional  id_profesional,&#xA;&#x9;a11.id_tipo_prestador  id_tipo_prestador,&#xA;&#x9;a11.id_persona  id_persona,&#xA;&#x9;a11.id_periodo  ID_Periodo,&#xA;&#x9;a11.id_acreedor  id_acreedor,&#xA;&#x9;a11.id_tipo_prestador  id_tipo_prestador0,&#xA;&#x9;a11.id_prestacion id_prestacion,&#xA;&#x9;sum(a11.cant_prest_amb_acep) Suma_Cant_prest_amb_acep,&#xA;&#x9;sum(a11.imp_pret_amb_pag)  Suma_imp_prest_amb_pag&#xA;into #PASO1&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;D_PERIODO&#x9;a12&#xA;&#x9;  on &#x9;(a11.id_periodo = a12.id_periodo)&#xA;&#x9;join&#x9;D_PLANES&#x9;a13&#xA;&#x9;  on &#x9;(a11.id_plan_producto = a13.id_plan_producto and &#xA;&#x9;a11.id_producto = a13.id_producto)&#xA;where&#x9;(not ((a11.id_producto = 16 and a11.id_plan_producto = 'CC   ')&#xA;   or  (a11.id_producto=16 and a11.id_plan_producto='CM   ')&#xA;   or  (a11.id_producto=16 and a11.id_plan_producto='CS1  ')&#xA;   or  (a11.id_producto=16 and a11.id_plan_producto='CS100')&#xA;   or  (a11.id_producto=4 and a11.id_plan_producto='M    ')&#xA;   or  (a11.id_producto=16 and a11.id_plan_producto='M    ')&#xA;   or  (a11.id_producto=20 and a11.id_plan_producto='M    ')&#xA;   or  (a11.id_producto=14 and a11.id_plan_producto='Z    ')&#xA;   or  (a11.id_producto=20 and a11.id_plan_producto='Z    ')&#xA;   or  (a11.id_producto=1 and a11.id_plan_producto='C    ')&#xA;   or  (a11.id_producto=4 and a11.id_plan_producto='Z    '))&#xA; and a11.id_reintegro in ('F')&#xA; and a11.ccosto2 = 1&#xA; and a13.Id_SubRubro_Ley in (1, 2) --, 6, 5, 3, 7) sólo para grav y no grav&#xA; and a11.id_origen_prestacion in ('A')&#xA; and a11.cant_prest_amb_acep &gt; 0 -- cantidad de prácticas &gt; 0&#xA;  --para Ejercicio 17/18--&gt;25 y 18/19--&gt;26&#xA; and a11.id_prestacion in ('NO0209    ', 'NO0216    ', 'NO0215    ', 'NO0208    ', 'NO0802    ')&#xA; and a11.id_acreedor in (7483, 7599, 7779, 7851, 7883, 8419, 8425, 9077, 14154, 30261, 30262, 34985, 35498, 37039, 39496, 41083, 45498, 49300, 54134, 54486, 72216, 74608, 74889, 77805, 96066, 116345, 135650)&#xA;--**--para Ejercicio 19/20 --&gt;27&#xA;-- SELECT * FROM Consultas_DW.DBO.FILTRO_ACREEDOR_PREST_ARANCELES WHERE PrestacionID LIKE 'NO%'&#xA;--**--&#xA; )&#xA; group by&#xA;&#x9;a11.id_profesional,&#xA;&#x9;a11.id_tipo_prestador,&#xA;&#x9;a11.id_persona,&#xA;&#x9;a11.id_periodo,&#xA;&#x9;a11.id_acreedor,&#xA;&#x9;a11.id_tipo_prestador, &#xA;&#x9;a11.id_prestacion&#xA;&#xA;&#xA;-- Paso los datos a H definitiva&#xA;insert into h_practicas_repetidas_odontologia&#xA;   (id_periodo,&#xA;&#x9;id_acreedor,&#xA;&#x9;id_tipo_prestador,&#xA;&#x9;id_profesional_actuante,&#xA;&#x9;id_tipo_profesional_actuante,&#xA;&#x9;id_persona,&#xA;&#x9;id_prestacion,&#xA;&#x9;cantidad_practicas_repetidas_odonto,&#xA;&#x9;importe_practicas_repetidas_odonto)&#xA;select distinct&#xA;&#x9;pa11.ID_Periodo, &#xA;&#x9;pa11.id_acreedor,&#xA;&#x9;pa11.id_tipo_prestador0,&#xA;&#x9;pa11.id_profesional,&#xA;&#x9;pa11.id_tipo_prestador,&#xA;&#x9;pa11.id_persona,&#xA;&#x9;pa11.id_prestacion,&#xA;&#x9;pa11.Suma_Cant_prest_amb_acep,&#xA;&#x9;pa11.Suma_imp_prest_amb_pag&#xA;from&#x9;#PASO1 pa11 &#xA;&#xA;-- Busca si existen períodos sin dato para algún acreedor &#xA;-- y en el paso siguiente genera un registro para que exista al menos un registro por período acreedor&#xA;-- para que el reporte acumulado que usa RunningSum pueda represetnar el dato en el reporte&#xA;SELECT DISTINCT P.id_periodo, id_acreedor &#xA;INTO #TEMP &#xA;FROM D_PERIODO P CROSS JOIN H_PRACTICAS_REPETIDAS_ODONTOLOGIA&#xA;WHERE ID_EJERCICIO IN (select top 2 H.id_ejercicio from D_PERIODO H where H.vigente_consumo =1&#xA;group by H.id_ejercicio order by H.id_ejercicio DESC)-- (25, 26)&#xA;&#xA;-- paso todo lo recopilado a H definitva&#xA;INSERT INTO H_PRACTICAS_REPETIDAS_ODONTOLOGIA&#xA;SELECT T.id_periodo, T.id_acreedor, 'P', 0, 'P', 0, '', 0, 0  &#xA;FROM #TEMP T WHERE NOT EXISTS (SELECT * FROM #PASO1 P &#xA;WHERE T.id_periodo=P.id_periodo AND T.id_acreedor=P.id_acreedor)&#xA;&#xA;&#xA;DROP TABLE #TEMP&#xA;DROP TABLE #PASO1&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Armado de H_PRACTICAS_REPETIDAS_ODONTOLOGIA (cambio de Ejercicio)"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{be5b20ca-0e48-4a51-a80a-b41b9f428029}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Armado de H_PRACTICAS_REPETIDAS_ODONTOLOGIA (cambio de Ejercicio)"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{AF81043D-1159-4CE8-9D9C-6F22CFB556AE}"
          SQLTask:SqlStatementSource="SET DATEFORMAT 'YMD'&#xA;&#xA;delete from H_PRACTICAS_REPETIDAS_ODONTOLOGIA&#xA;&#xA;select&#x9;&#xA;&#x9;a11.id_profesional  id_profesional,&#xA;&#x9;a11.id_tipo_prestador  id_tipo_prestador,&#xA;&#x9;a11.id_persona  id_persona,&#xA;&#x9;a11.id_periodo  ID_Periodo,&#xA;&#x9;a11.id_acreedor  id_acreedor,&#xA;&#x9;a11.id_tipo_prestador  id_tipo_prestador0,&#xA;&#x9;a11.id_prestacion id_prestacion,&#xA;&#x9;sum(a11.cant_prest_amb_acep) Suma_Cant_prest_amb_acep,&#xA;&#x9;sum(a11.imp_pret_amb_pag)  Suma_imp_prest_amb_pag&#xA;into #PASO1&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;D_PERIODO&#x9;a12&#xA;&#x9;  on &#x9;(a11.id_periodo = a12.id_periodo)&#xA;&#x9;join&#x9;D_PLANES&#x9;a13&#xA;&#x9;  on &#x9;(a11.id_plan_producto = a13.id_plan_producto and &#xA;&#x9;a11.id_producto = a13.id_producto)&#xA;where&#x9;(not ((a11.id_producto = 16 and a11.id_plan_producto = 'CC   ')&#xA;   or  (a11.id_producto=16 and a11.id_plan_producto='CM   ')&#xA;   or  (a11.id_producto=16 and a11.id_plan_producto='CS1  ')&#xA;   or  (a11.id_producto=16 and a11.id_plan_producto='CS100')&#xA;   or  (a11.id_producto=4 and a11.id_plan_producto='M    ')&#xA;   or  (a11.id_producto=16 and a11.id_plan_producto='M    ')&#xA;   or  (a11.id_producto=20 and a11.id_plan_producto='M    ')&#xA;   or  (a11.id_producto=14 and a11.id_plan_producto='Z    ')&#xA;   or  (a11.id_producto=20 and a11.id_plan_producto='Z    ')&#xA;   or  (a11.id_producto=1 and a11.id_plan_producto='C    ')&#xA;   or  (a11.id_producto=4 and a11.id_plan_producto='Z    '))&#xA; and a11.id_reintegro in ('F')&#xA; and a11.ccosto2 = 1&#xA; and a13.Id_SubRubro_Ley in (1, 2) --, 6, 5, 3, 7) sólo para grav y no grav&#xA; and a11.id_origen_prestacion in ('A')&#xA; and a11.cant_prest_amb_acep &gt; 0 -- cantidad de prácticas &gt; 0&#xA; and a11.id_prestacion in (SELECT distinct PrestacionID FROM Consultas_DW.DBO.FILTRO_ACREEDOR_PREST_ARANCELES WHERE PrestacionID LIKE 'NO%')&#xA; and a11.id_acreedor in (SELECT distinct AcreedorID FROM Consultas_DW.DBO.FILTRO_ACREEDOR_PREST_ARANCELES WHERE PrestacionID LIKE 'NO%')&#xA; and (a12.ID_EJERCICIO in (Select top 1 E.id_ejercicio from D_PERIODO E WHERE E.id_ejercicio in (select top 2 H.id_ejercicio from D_PERIODO H where H.vigente_consumo =1 group by H.id_ejercicio order by H.id_ejercicio DESC) order by E.id_ejercicio ASC)&#xA; or a12.ID_EJERCICIO in (select top 1 H.id_ejercicio from D_PERIODO H  where H.vigente_consumo = 1 group by  H.id_ejercicio order by H.id_ejercicio desc))&#xA; )&#xA; group by&#xA;&#x9;a11.id_profesional,&#xA;&#x9;a11.id_tipo_prestador,&#xA;&#x9;a11.id_persona,&#xA;&#x9;a11.id_periodo,&#xA;&#x9;a11.id_acreedor,&#xA;&#x9;a11.id_tipo_prestador, &#xA;&#x9;a11.id_prestacion&#xA;&#xA;&#xA;&#xA;&#xA;-- Paso los datos a H definitiva&#xA;insert into h_practicas_repetidas_odontologia&#xA;   (id_periodo,&#xA;&#x9;id_acreedor,&#xA;&#x9;id_tipo_prestador,&#xA;&#x9;id_profesional_actuante,&#xA;&#x9;id_tipo_profesional_actuante,&#xA;&#x9;id_persona,&#xA;&#x9;id_prestacion,&#xA;&#x9;cantidad_practicas_repetidas_odonto,&#xA;&#x9;importe_practicas_repetidas_odonto)&#xA;select distinct&#xA;&#x9;pa11.ID_Periodo, &#xA;&#x9;pa11.id_acreedor,&#xA;&#x9;pa11.id_tipo_prestador0,&#xA;&#x9;pa11.id_profesional,&#xA;&#x9;pa11.id_tipo_prestador,&#xA;&#x9;pa11.id_persona,&#xA;&#x9;pa11.id_prestacion,&#xA;&#x9;pa11.Suma_Cant_prest_amb_acep,&#xA;&#x9;pa11.Suma_imp_prest_amb_pag&#xA;from&#x9;#PASO1 pa11 &#xA;&#xA;-- Busca si existen períodos sin dato para algún acreedor &#xA;-- y en el paso siguiente genera un registro para que exista al menos un registro por período acreedor&#xA;-- para que el reporte acumulado que usa RunningSum pueda represetnar el dato en el reporte&#xA;SELECT DISTINCT P.id_periodo, id_acreedor &#xA;INTO #TEMP &#xA;FROM D_PERIODO P CROSS JOIN H_PRACTICAS_REPETIDAS_ODONTOLOGIA&#xA;WHERE ID_EJERCICIO IN (select top 2 H.id_ejercicio from D_PERIODO H where H.vigente_consumo =1&#xA;group by H.id_ejercicio order by H.id_ejercicio DESC)&#xA;&#xA;-- paso todo lo recopilado a H definitva&#xA;INSERT INTO H_PRACTICAS_REPETIDAS_ODONTOLOGIA&#xA;SELECT T.id_periodo, T.id_acreedor, 'P', 0, 'P', 0, '', 0, 0  &#xA;FROM #TEMP T WHERE NOT EXISTS (SELECT * FROM #PASO1 P &#xA;WHERE T.id_periodo=P.id_periodo AND T.id_acreedor=P.id_acreedor)&#xA;&#xA;&#xA;DROP TABLE #TEMP&#xA;DROP TABLE #PASO1&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssge="clr-namespace:Microsoft.SqlServer.Graph.Extended;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
        <NodeLayout
          Size="369,42"
          Id="Package\Armado de H_PRACTICAS_REPETIDAS_ODONTOLOGIA"
          TopLeft="92.4952830188679,13.2924528301887" />
        <NodeLayout
          Size="475,42"
          Id="Package\Armado de H_PRACTICAS_REPETIDAS_ODONTOLOGIA (cambio de Ejercicio)"
          TopLeft="39.4952830188679,115.990566037736" />
        <AnnotationLayout
          Text="--&gt; Acticar con cambio de Ejercicio.&#xD;&#xA;Cambian los prestadores que se analizan, la logica es la misma"
          ParentId="Package"
          Size="341,51"
          Id="4e16e12d-8bd7-4463-9767-79397e042f75"
          TopLeft="529.764150943396,111.330188679245">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="11.25"
              Color="#FF080000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
        <AnnotationLayout
          Text="--&gt; Desactivar con cambio de Ejercicio"
          ParentId="Package"
          Size="221,38"
          Id="036c9cf1-1736-4e17-8897-d9870b6dbd7b"
          TopLeft="519.839622641509,18.5">
          <AnnotationLayout.FontInfo>
            <mssge:FontInfo
              Family="Tahoma"
              Size="11.25"
              Color="#FF080000">
              <mssge:FontInfo.TextDecorations>
                <av:TextDecorationCollection />
              </mssge:FontInfo.TextDecorations>
            </mssge:FontInfo>
          </AnnotationLayout.FontInfo>
        </AnnotationLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>