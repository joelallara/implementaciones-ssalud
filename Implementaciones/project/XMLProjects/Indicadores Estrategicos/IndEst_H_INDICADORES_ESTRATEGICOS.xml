<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="10/28/2019 10:03:18 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DES6103"
  DTS:CreatorName="AMS\jallara"
  DTS:DTSID="{F015FAA3-0B26-411F-853B-EB87D0A58EA8}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="11274"
  DTS:ObjectName="IndEst_H_INDICADORES_ESTRATEGICOS"
  DTS:PackageType="5"
  DTS:VersionBuild="7"
  DTS:VersionGUID="{81A068D1-33DB-4C66-95D3-524FEF6F2E82}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{7C1E3109-6B6E-45B9-8C39-D1DFC2968D2B}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{7C1E3109-6B6E-45B9-8C39-D1DFC2968D2B}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Actualizo lo existente en H_INDICADORES_ESTRATEGICOS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{de0108c6-191e-4e8a-90bd-b00406b0f9dd}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualizo lo existente en H_INDICADORES_ESTRATEGICOS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{40B1FFCE-4DC1-4E73-BA3E-E7A00EC122E0}"
          SQLTask:SqlStatementSource="UPDATE H_INDICADORES_ESTRATEGICOS &#xA;SET valor_indicador_cierre_ej_ant = A.valor_indicador_cierre_ej_ant, &#xA; valor_indicador_estrategico = A.valor_indicador_estrategico,&#xA; objetivo_presupuesto = A.objetivo_presupuesto,&#xA; valor_indicador_estrategico_mensual = A.valor_indicador_estrategico_mensual,&#xA; objetivo_presupuesto_mensual = A.objetivo_presupuesto_mensual&#xA;FROM H_INDICADORES_ESTRATEGICOS H&#xA;INNER JOIN AUX_H_INDICADORES_ESTRATEGICOS A on H.id_indicador_estrategico =  A.id_indicador_estrategico and H.id_periodo = A.id_periodo&#xA;and H.id_compania = A.id_compania&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Coloca marca en periodo actual"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{85d200c9-dc21-4a51-8439-d30ede74762c}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Coloca marca en periodo actual"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{40B1FFCE-4DC1-4E73-BA3E-E7A00EC122E0}"
          SQLTask:SqlStatementSource="UPDATE H_INDICADORES_ESTRATEGICOS &#xA;SET id_marca_periodo_actual = 0&#xA;&#xA;SELECT h.id_indicador_estrategico,  MAX(h.id_periodo) as periodomax  &#xA;INTO #TEMP_INDICADORES_ESTRATEGICOS&#xA;FROM H_INDICADORES_ESTRATEGICOS h &#xA;WHERE  id_indicador_estrategico not in (70,23,26,27,28)  --esto se hace porque este indicador no se tiene que mostrar mas, y si me lo marca algun mes como el actual vuelve a aparecer en los reportes&#xA;GROUP BY id_indicador_estrategico&#xA;&#xA;UPDATE H_INDICADORES_ESTRATEGICOS &#xA;SET id_marca_periodo_actual = 1&#xA;FROM H_INDICADORES_ESTRATEGICOS H &#xA;INNER JOIN #TEMP_INDICADORES_ESTRATEGICOS T ON H.id_indicador_estrategico = T.id_indicador_estrategico and H.id_periodo = T.periodomax &#xA;&#xA;DROP TABLE #TEMP_INDICADORES_ESTRATEGICOS" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Inserta en H_INDICADORES_ESTRATEGICOS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{ee2d1489-c856-41ae-8740-e8882a126a7b}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Inserta en H_INDICADORES_ESTRATEGICOS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{40B1FFCE-4DC1-4E73-BA3E-E7A00EC122E0}"
          SQLTask:SqlStatementSource="INSERT INTO H_INDICADORES_ESTRATEGICOS([id_indicador_estrategico]&#xA;           ,[id_periodo]&#xA;,[id_compania]&#xA;           ,[id_periodo_cierre_ej_ant]&#xA;           ,[valor_indicador_cierre_ej_ant]&#xA;           ,[valor_indicador_estrategico]&#xA;           ,[objetivo_presupuesto]&#xA;           ,[id_marca_periodo_actual]&#xA;           ,[valor_indicador_estrategico_mensual]&#xA;           ,[objetivo_presupuesto_mensual])&#xA;SELECT [id_indicador_estrategico]&#xA;           ,[id_periodo]&#xA;,[id_compania]&#xA;           ,[id_periodo_cierre_ej_ant]&#xA;           ,[valor_indicador_cierre_ej_ant]&#xA;           ,[valor_indicador_estrategico]&#xA;           ,[objetivo_presupuesto]&#xA;           ,0&#xA;           ,[valor_indicador_estrategico_mensual]&#xA;           ,[objetivo_presupuesto_mensual]&#xA;FROM AUX_H_INDICADORES_ESTRATEGICOS A&#xA;WHERE NOT EXISTS&#xA; (SELECT h.id_indicador_estrategico, h.id_periodo &#xA;  FROM  H_INDICADORES_ESTRATEGICOS H&#xA;  WHERE H.id_periodo = A.id_periodo and H.id_indicador_estrategico = A.id_indicador_estrategico and H.id_compania = A.id_compania)&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{B6727F2F-D188-4740-98A0-2BAF12D39F35}"
      DTS:From="Package\Actualizo lo existente en H_INDICADORES_ESTRATEGICOS"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Inserta en H_INDICADORES_ESTRATEGICOS" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{96105a83-5f18-4f5f-abfa-4eed75c6d1af}"
      DTS:From="Package\Inserta en H_INDICADORES_ESTRATEGICOS"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Coloca marca en periodo actual" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="383,42"
          Id="Package\Actualizo lo existente en H_INDICADORES_ESTRATEGICOS"
          TopLeft="32.4166666666665,17.830188679245" />
        <NodeLayout
          Size="234,42"
          Id="Package\Coloca marca en periodo actual"
          TopLeft="106.916666666667,171.830188679245" />
        <NodeLayout
          Size="313,42"
          Id="Package\Inserta en H_INDICADORES_ESTRATEGICOS"
          TopLeft="67.4166666666665,95.641509433962" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="223.916666666667,59.830188679245">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,35.811320754717"
              Start="0,0"
              End="0,28.311320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.311320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="223.916666666667,137.641509433962">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34.188679245283"
              Start="0,0"
              End="0,26.688679245283">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.688679245283" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>