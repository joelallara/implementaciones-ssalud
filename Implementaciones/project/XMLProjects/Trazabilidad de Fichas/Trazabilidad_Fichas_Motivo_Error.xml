<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="9/23/2019 2:50:59 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="LA22676-08835"
  DTS:CreatorName="AMS\nprida"
  DTS:DTSID="{E44A6E2D-736F-44BD-8870-B3A21251E54C}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="11274"
  DTS:ObjectName="Trazabilidad_Fichas_Motivo_Error"
  DTS:PackageType="5"
  DTS:VersionBuild="17"
  DTS:VersionGUID="{251A2FCF-FB56-4782-99DB-2038A169FF51}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{06B9D998-075E-4C54-86FA-3466BED66C46}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{06B9D998-075E-4C54-86FA-3466BED66C46}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Actualiza contar distintos DNI"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarea Ejecutar SQL"
      DTS:DTSID="{6252F09A-FA21-4E60-8C87-40FDDE2A8113}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza contar distintos DNI"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{5B962E97-F748-4463-B2EC-EB00E61A8CFD}"
          SQLTask:SqlStatementSource="&#xA;declare @Periodo int = (select max(id_periodo_produccion) from H_TRAZABILIDAD_FICHAS)&#xA;&#xA;&#xA;--- CALCULA para aquellas fichas con el mismo dni, cual es la primera segun los filtros &#xA;&#xA;select a11.*, ROW_NUMBER() over(partition by id_periodo_produccion,nro_documento order by id_fecha_carga_trazabilidad desc, id_ficha  ) as distinto_dni&#xA;into #temp_DNI&#xA;from&#x9;H_TRAZABILIDAD_FICHAS&#x9;a11&#xA;&#x9;join&#x9;D_PLANES&#x9;a12&#xA;&#x9;  on &#x9;(a11.id_plan_producto = a12.id_plan_producto and &#xA;&#x9;a11.id_producto = a12.id_producto)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a11.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;where&#x9;(a12.Id_SubRubro_Ley in (1, 2, 5, 6)&#xA; and a11.id_tipo_movimiento_trazabilidad in (1)&#xA; and a11.id_subtipo_movimiento_trazabilidad in (1)&#xA; and a11.id_sector_carga not in (999))&#xA; and id_motivo_error = 0&#xA;&#xA; update H_TRAZABILIDAD_FICHAS&#xA; set [contar_documentos_distintos] =  case when distinto_dni = 1 then distinto_dni else 0 end&#xA; from&#x9;H_TRAZABILIDAD_FICHAS&#x9;a11&#xA;&#x9;&#x9;inner join #temp_DNI t on a11.nro_documento = t.nro_documento and t.id_ficha = a11.id_ficha &#xA;&#x9;&#x9;and t.id_plan_producto = a11.id_plan_producto and t.id_producto = a11.id_producto &#xA;&#x9;&#x9;and t.id_subproducto = a11.id_subproducto&#xA;&#x9;&#x9;and a11.id_periodo_produccion = @Periodo &#xA;&#xA;&#xA;&#xA;&#x9;&#x9;&#xA;&#xA;drop table #temp_DNI&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualiza id_marca_informe_trazabilidad para fichas con Seguro de Vida"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarea Ejecutar SQL"
      DTS:DTSID="{7B402765-9FC5-414C-B5DA-F152AF0D2375}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza id_marca_informe_trazabilidad para fichas con Seguro de Vida"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{5B962E97-F748-4463-B2EC-EB00E61A8CFD}"
          SQLTask:SqlStatementSource="Declare  @Periodo_Producción int, @Periodo_Anterior Int&#xA;SET @Periodo_Producción = ( Select PERPRO from AS400.HOST03.DWHSMPD.DFECPRO)&#xA;&#xA;&#xA;--Obtengo las fichas con marca informe trazabilidad&#xA;select id_ficha&#xA;into #InformeTraza&#xA;from H_TRAZABILIDAD_FICHAS&#xA;where id_marca_informe_trazabilidad = 1&#xA;&#x9;and id_periodo_produccion = @Periodo_Producción&#xA;&#xA;&#xA;--Marco ficha referente al plan seguro de vida para las fichas obtenidas en el paso anterior&#xA;update H_TRAZABILIDAD_FICHAS&#xA;set id_marca_informe_trazabilidad = 3&#xA;from H_TRAZABILIDAD_FICHAS tf&#xA; JOIN D_PLANES p&#xA;&#x9;on (tf.id_plan_producto = p.id_plan_producto and tf.id_producto = p.id_producto)&#xA; JOIN D_SUBRUBRO_LEY S&#xA;&#x9;on (p.id_SubRubro_ley = s.id_SubRubro_ley)&#xA; JOIN #InformeTraza inf&#xA;&#x9;on (inf.id_ficha = tf.id_ficha)&#xA;where p.id_SubRubro_ley = 9" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualiza Marca Motivo Error"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{eaf46fe5-45f0-47a8-af28-4321a12d63d5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza Marca Motivo Error"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{5B962E97-F748-4463-B2EC-EB00E61A8CFD}"
          SQLTask:SqlStatementSource="----- Declara el periodo producción que vamos a procesar. &#xA;Declare  @Periodo_Producción int, @Periodo_Anterior Int&#xA;SET @Periodo_Producción = ( Select PERPRO from AS400.HOST03.DWHSMPD.DFECPRO)&#xA;SET @Periodo_Anterior = (select dbo.PeriodosAnteriores(@Periodo_Producción,2))&#xA;&#xA;&#xA;--- Inicializacion motivo de error&#xA;update H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 0 &#xA;where id_periodo_produccion = @Periodo_Producción&#xA;&#xA;--- Primer control, marcar todo lo que no es Salud&#xA;update H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 1&#xA;FROM H_TRAZABILIDAD_FICHAS TZ&#xA;INNER JOIN D_PRODUCTOS PR ON (PR.id_producto = TZ.id_producto)&#xA;where PR.id_clase_producto &lt;&gt; 'S' and id_periodo_produccion = @Periodo_Producción&#xA;&#xA;--- Segundo control, para todo lo que es salud excluir si viene de padron los PMO&#xA;update H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 2&#xA;FROM H_TRAZABILIDAD_FICHAS TZ&#xA;where id_sector_carga = 999 and id_plan_producto = 'PMO' and id_periodo_produccion = @Periodo_Producción&#xA;and id_motivo_error = 0&#xA;&#xA;--- Tercer control, cambio segmento = 'S'&#xA;update H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 3&#xA;FROM H_TRAZABILIDAD_FICHAS TZ&#xA;where id_marca_cambio_segmento = 'S' and id_periodo_produccion = @Periodo_Producción&#xA;and id_motivo_error = 0&#xA;&#xA;--- Cuarto control, promotor = 999999&#xA;update H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 4&#xA;FROM H_TRAZABILIDAD_FICHAS TZ&#xA;where id_promotor IN  (999999, 99999, 111114) and id_periodo_produccion = @Periodo_Producción&#xA;and id_motivo_error = 0&#xA;&#xA;--- Quinto control, no es ficha de alta ni de afiliacion ni de integrante&#xA;update H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 5&#xA;FROM H_TRAZABILIDAD_FICHAS TZ&#xA;where id_tipo_movimiento_trazabilidad &lt;&gt; 1 and id_periodo_produccion = @Periodo_Producción&#xA;and id_motivo_error = 0&#xA;&#xA;--- Sexto control, Unifica S, no es afiliacion principal y cant. Capitas = 1&#xA;update H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 6&#xA;FROM H_TRAZABILIDAD_FICHAS TZ&#xA;where id_unifica='S' and id_afiliacion_principal='N' and cantidad_integrantes = 1 and id_periodo_produccion = @Periodo_Producción&#xA;and id_motivo_error = 0&#xA;&#xA;--- Septimo control, Ficha Anulada Abacom&#xA;---Armado temporal de DES ABACOM&#xA;SELECT SOLICITUD_NUMERO &#xA;INTO #paso &#xA;    FROM AS400.HOST03.ASOCIADO.DES&#xA;    WHERE SOLICITUD_NUMERO IS NOT NULL&#xA;&#xA;update H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 7&#xA;FROM H_TRAZABILIDAD_FICHAS TZ&#xA;where id_periodo_produccion = @Periodo_Producción and id_motivo_error = 0 and id_sector_carga = 0&#xA;and NOT EXISTS (select &#xA;SOLICITUD_NUMERO from #paso WHERE TZ.id_ficha = SOLICITUD_NUMERO)&#xA;&#xA;--- Octavo control, persona esta en stock del periodo -- solo para las fichas que no son ni abacom &#xA;--- ni padrones&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 8 &#xA;FROM H_TRAZABILIDAD_FICHAS TZ &#xA;WHERE id_periodo_produccion = @Periodo_Producción AND id_motivo_error = 0 AND id_sector_carga &lt;&gt; 0&#xA;AND id_sector_carga &lt;&gt; 999 &#xA;AND id_subtipo_movimiento_trazabilidad = 1&#xA;AND nro_documento IN (SELECT P.Nro_documento FROM H_COMER_STOCK_AFILIA S INNER JOIN D_PERSONAS P ON  (P.id_persona=S.id_persona)&#xA;where S.id_periodo = @Periodo_Producción)&#xA;&#xA;--- Noveno control, el documento me fija si tiene una ficha el periodo anterior que haya sido sumada a producción&#xA;&#xA;---Armado de documentos del periodo anterior a los que se le acepto una ficha&#xA;SELECT NRO_DOCUMENTO INTO #PASO1 &#xA;FROM H_TRAZABILIDAD_FICHAS&#xA;WHERE id_periodo_produccion = @Periodo_Anterior AND id_marca_informe_trazabilidad = 1&#xA;GROUP BY nro_documento&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 9&#xA;FROM H_TRAZABILIDAD_FICHAS TZ &#xA;WHERE id_periodo_produccion = @Periodo_Producción AND id_motivo_error = 0&#xA;AND nro_documento IN (SELECT nro_documento FROM #PASO1)&#xA;&#xA;--- Decimo control, ver si hay mas de una ficha para un mismo documento, considerar la ultima hecha&#xA;&#xA;--- Armado de documentos, &#xA;SELECT nro_documento, COUNT(*) as cant INTO #PASO2&#xA;FROM H_TRAZABILIDAD_FICHAS &#xA;WHERE id_periodo_produccion = @Periodo_Producción AND id_motivo_error = 0&#xA;GROUP BY nro_documento &#xA;HAVING COUNT(DISTINCT id_ficha)&gt;1&#xA;&#xA;SELECT H.nro_documento, MAX(H.id_fecha_carga_trazabilidad) id_fecha_carga_trazabilidad &#xA;INTO #PASO3 FROM #PASO2 T INNER JOIN H_TRAZABILIDAD_FICHAS H ON (H.nro_documento=T.nro_documento)&#xA;WHERE H.id_motivo_Error = 0 AND id_periodo_produccion = @Periodo_Producción&#xA;GROUP BY H.nro_documento&#xA;&#xA;SELECT H.id_periodo_produccion, H.id_ficha, H.nro_documento, &#xA;H.id_tipo_movimiento_trazabilidad, H.id_fecha_carga_trazabilidad&#xA;INTO #PASO4 FROM H_TRAZABILIDAD_FICHAS H INNER JOIN #PASO3 T ON (H.nro_documento=T.nro_documento)&#xA;WHERE H.id_fecha_carga_trazabilidad=T.id_fecha_carga_trazabilidad &#xA;AND id_motivo_error = 0&#xA;AND id_periodo_produccion = @Periodo_Producción &#xA;&#xA;-- Existen registros que contienen distintas fichas para un mismo dia de carga, &#xA;-- estos se insertan para despues seleccionar el menor.&#xA;SELECT nro_documento, id_fecha_carga_trazabilidad INTO #PASO5 &#xA;FROM H_TRAZABILIDAD_FICHAS H WHERE EXISTS (SELECT * FROM #PASO4 T WHERE&#xA;              H.nro_documento=T.nro_documento&#xA;              AND H.id_ficha&lt;&gt;T.id_ficha)&#xA;AND H.id_motivo_error = 0&#xA;AND H.id_periodo_produccion = @Periodo_Producción&#xA;GROUP BY nro_documento, id_fecha_carga_trazabilidad&#xA;HAVING COUNT(*)&gt;1          &#xA;&#xA;--- inicializo La marca actual de documento repetido&#xA;UPDATE H_TRAZABILIDAD_FICHAS &#xA;SET id_marca_documento_repetido = 0&#xA;WHERE id_periodo_produccion = @Periodo_Producción&#xA;&#xA;-- Actualizo con 1 todos los registros que NO contengan fecha repetida.&#xA;UPDATE H_TRAZABILIDAD_FICHAS&#xA;SET id_marca_documento_repetido = 1&#xA;FROM H_TRAZABILIDAD_FICHAS H INNER JOIN #PASO4 T ON (H.nro_documento=T.nro_documento)&#xA;WHERE H.id_ficha&lt;&gt;T.id_ficha AND H.nro_documento=T.nro_documento &#xA;AND H.id_motivo_error = 0 &#xA;AND H.id_periodo_produccion = @Periodo_Producción &#xA;AND H.nro_documento NOT IN (SELECT nro_documento FROM #PASO5)&#xA;&#xA;&#xA;-- Los que tienen fecha repetida, se selecciona el valor menor de la ficha y se setea en 1.&#xA;UPDATE H&#xA;SET H.id_marca_documento_repetido= 1&#xA;FROM H_TRAZABILIDAD_FICHAS H &#xA;WHERE H.id_ficha in(&#xA;SELECT MIN(id_ficha) FROM H_TRAZABILIDAD_FICHAS H WHERE EXISTS (SELECT * FROM #PASO5 T &#xA;WHERE H.nro_documento=T.nro_documento AND &#xA;H.id_fecha_carga_trazabilidad=T.id_fecha_carga_trazabilidad)&#xA;AND id_motivo_error = 0 &#xA;AND id_periodo_produccion = @Periodo_Producción               &#xA;GROUP BY nro_documento,id_fecha_carga_trazabilidad)&#xA;&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 10&#xA;FROM H_TRAZABILIDAD_FICHAS TZ &#xA;WHERE id_periodo_produccion = @Periodo_Producción AND id_motivo_error = 0&#xA;AND id_marca_documento_repetido = 1&#xA;&#xA;&#xA;/* Parche Solucion al Error del Motivo 10 - 9 / 10 / 2019  */&#xA;---- Se crearon estos 3 pasos para corregir error donde un mismo nro documento tenia 2 fechas distintas y no podia decidir cual de las dos marcar.&#xA;---- Ahora marca la ficha valor más chica para la fecha menor, dejando como id_marca_informe_trazabilidad  la ficha mayor con mayor fecha ( la ultima que se hizo)&#xA;&#xA;---- Busca los registros que tiene para un mismo dni 2 fichas contadas&#xA;&#xA;select  nro_documento, count(nro_documento) as cant&#xA;into #temp_DOCUMENTO &#xA;from H_TRAZABILIDAD_FICHAS&#xA;where id_motivo_error = 0&#xA;and id_periodo_produccion = @Periodo_Producción&#xA;and id_tipo_movimiento_trazabilidad = 1&#xA;group by nro_documento&#xA;HAVING COUNT(nro_documento)&gt;1  &#xA;&#xA;&#xA;----- Nro documento y ficha minima&#xA;&#xA;SELECT nro_documento,MIN(id_ficha) as id_ficha &#xA;into #TEMP_DOCUMENTO_FICHA&#xA;FROM H_TRAZABILIDAD_FICHAS  H &#xA;WHERE nro_documento in (SELECT nro_documento FROM #temp_DOCUMENTO )&#xA;and id_marca_documento_repetido = 0&#xA;and id_periodo_produccion = @Periodo_Producción&#xA;group by nro_documento&#xA;&#xA;----- Actualiza para los registros seleccionados anteriormente con el criterio que la ficha ultima creada es la que se debe tomar como correcta&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS SET id_marca_documento_repetido = 1&#xA;from H_TRAZABILIDAD_FICHAS H&#xA;inner join #TEMP_DOCUMENTO_FICHA T ON T.id_ficha = H.id_ficha and T.nro_documento = H.nro_documento&#xA;where id_motivo_error = 0&#xA;and id_periodo_produccion = @Periodo_Producción&#xA;&#xA;---- Marca con Motivo Error 10  los casos del parche&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS&#xA;SET id_motivo_error = 10&#xA;FROM H_TRAZABILIDAD_FICHAS TZ &#xA;WHERE id_periodo_produccion = @Periodo_Producción AND id_motivo_error = 0&#xA;AND id_marca_documento_repetido = 1&#xA;&#xA;--- Por ultimo, la marca informe trazabilidad sera 1 si el id_motivo_error = 0&#xA;UPDATE H_TRAZABILIDAD_FICHAS&#xA;SET id_marca_informe_trazabilidad = 0&#xA;WHERE id_periodo_produccion = @Periodo_Producción&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS&#xA;SET id_marca_informe_trazabilidad = 1&#xA;WHERE id_periodo_produccion = @Periodo_Producción AND id_motivo_error = 0" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualizacion Datos Ejecutivos Empresa"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tarea Ejecutar SQL"
      DTS:DTSID="{774df185-ae5d-471c-b867-7a943c5b37e5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualizacion Datos Ejecutivos Empresa"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{5B962E97-F748-4463-B2EC-EB00E61A8CFD}"
          SQLTask:SqlStatementSource="-- deducir el gerente zonal del ejecutivo de empresa a partir de la cascada comercial&#xA;Declare @Periodo_Produccion int&#xA;Set @Periodo_Produccion = (Select PERPRO from AS400.HOST03.DWHSMPD.DFECPRO)&#xA;&#xA;update H_TRAZABILIDAD_FICHAS &#xA;set id_gerente_zonal_ejecutivo = GZ.id_gerente_zonal&#xA;from H_TRAZABILIDAD_FICHAS TRZ &#xA;inner join H_CASCADA_COMERCIAL CAS ON (TRZ.id_ejecutivo_empresa = CAS.id_asesor_cascada_comercial AND&#xA;TRZ.id_tipo_puesto_ejecutivo_empresa = CAS.id_tipo_puesto_cascada_comercial&#xA;AND TRZ.id_periodo_produccion = CAS.id_periodo)&#xA;inner join D_GERENTE_ZONAL GZ ON (GZ.id_asesor_cascada_comercial = cas.id_asesor_superior_cascada_comercial)&#xA;where id_ejecutivo_empresa &lt;&gt; 0 and TRZ.id_periodo_produccion = @Periodo_Produccion&#xA;&#xA;update H_TRAZABILIDAD_FICHAS &#xA;set id_gerente_regional_ejecutivo = 1,&#xA;id_zona_comercial_ejecutivo = 9999&#xA;where id_gerente_zonal_ejecutivo in (1,2,7,14,8, 3, 18) &#xA;and id_periodo_produccion = @Periodo_Produccion&#xA;update H_TRAZABILIDAD_FICHAS &#xA;set id_gerente_regional_ejecutivo = 2,&#xA;id_zona_comercial_ejecutivo = 9999&#xA;where id_gerente_zonal_ejecutivo in (4, 5, 6,10,11,12,13, 16, 17, 19) and id_periodo_produccion = @Periodo_Produccion&#xA;&#xA;update H_TRAZABILIDAD_FICHAS &#xA;set cantidad_integrantes_ejecutivo = (cantidad_integrantes * porcentaje_ejecutivo)/100&#xA;where id_ejecutivo_empresa &lt;&gt; 0 and id_periodo_produccion = @Periodo_Produccion&#xA;&#xA;update H_TRAZABILIDAD_FICHAS &#xA;set cantidad_integrantes_promotor = (cantidad_integrantes - cantidad_integrantes_ejecutivo)&#xA;where id_ejecutivo_empresa &lt;&gt; 0 and id_periodo_produccion = @Periodo_Produccion&#xA;&#xA;--- actualizar cantidad_integrantes_promotor y cantidad_integrantes_ejecutivo, cuando no participa&#xA;--- ningun ejecutivo de empresas&#xA;&#xA;update H_TRAZABILIDAD_FICHAS &#xA;set cantidad_integrantes_promotor = cantidad_integrantes,&#xA;cantidad_integrantes_ejecutivo = 0&#xA;where id_ejecutivo_empresa = 0 and  id_periodo_produccion = @Periodo_Produccion&#xA;&#xA;&#xA;-- cocinada Padron HIPOD&#xA;UPDATE H_TRAZABILIDAD_FICHAS &#xA;set id_ejecutivo_empresa = 10068,&#xA;id_gerente_zonal_ejecutivo = 16, &#xA;id_gerente_regional_ejecutivo = 2,&#xA;porcentaje_ejecutivo = 100,&#xA;id_zona_comercial_ejecutivo = 9999,&#xA;cantidad_integrantes_promotor = 0,&#xA;cantidad_integrantes_ejecutivo = 1&#xA;WHERE id_promotor = 10068&#xA;AND id_sector_carga = 999&#xA;and  id_periodo_produccion = @Periodo_Produccion&#xA;&#xA;&#xA;----- Setea con valor por defecto si el gerente zonal ejecutivo es null&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS SET id_gerente_zonal_ejecutivo = 99 &#xA;where id_gerente_zonal_ejecutivo is null&#xA;&#xA;----- Setea con valor por defecto si el gerente regional ejecutivo es null&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS SET  id_gerente_regional_ejecutivo =   99&#xA;where id_gerente_regional_ejecutivo is null&#xA;&#xA;----- Setea con valor por defecto si el gerente regional ejecutivo es null&#xA;&#xA;UPDATE H_TRAZABILIDAD_FICHAS SET  id_zona_comercial_ejecutivo =   9999&#xA;where id_zona_comercial_ejecutivo is null&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restricción]"
      DTS:CreationName=""
      DTS:DTSID="{ED080B99-E867-477A-A848-372F8602C10F}"
      DTS:From="Package\Actualiza Marca Motivo Error"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restricción"
      DTS:To="Package\Actualiza contar distintos DNI" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restricción 1]"
      DTS:CreationName=""
      DTS:DTSID="{9CEAAD53-40AC-462A-AECC-CCD628336137}"
      DTS:From="Package\Actualiza contar distintos DNI"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restricción 1"
      DTS:To="Package\Actualizacion Datos Ejecutivos Empresa" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restricción 2]"
      DTS:CreationName=""
      DTS:DTSID="{9A7D262F-428D-44BA-BC3C-7DD247BE83B1}"
      DTS:From="Package\Actualizacion Datos Ejecutivos Empresa"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restricción 2"
      DTS:To="Package\Actualiza id_marca_informe_trazabilidad para fichas con Seguro de Vida" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Esta sección CDATA contiene la información de diseño del paquete. Esta sección incluye información como, por ejemplo, las coordenadas (x,y), el ancho y el alto.-->
<!--Si edita manualmente esta sección y comete un error, puede eliminarlo. -->
<!--El paquete podrá cargarse normalmente, pero se perderá la información de diseño anterior y el diseñador reorganizará los elementos automáticamente en la superficie de diseño.-->
<Objects
  Version="8">
  <!--Cada uno de los nodos siguientes contiene propiedades que no afectan al comportamiento en tiempo de ejecución.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="223.2,41.6"
          Id="Package\Actualiza contar distintos DNI"
          TopLeft="307.941664613618,179.308889570307" />
        <NodeLayout
          Size="220,41.6"
          Id="Package\Actualiza Marca Motivo Error"
          TopLeft="309.541664613618,106" />
        <NodeLayout
          Size="276,41.6"
          Id="Package\Actualizacion Datos Ejecutivos Empresa"
          TopLeft="281.541664613618,252.617779140614" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restricción]"
          TopLeft="419.541664613618,147.6">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31.7088895703069"
              Start="0,0"
              End="0,24.2088895703069">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.2088895703069" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restricción 1]"
          TopLeft="419.541664613618,220.908889570307">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31.7088895703069"
              Start="0,0"
              End="0,24.2088895703069">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.2088895703069" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="412.8,41.6"
          Id="Package\Actualiza id_marca_informe_trazabilidad para fichas con Seguro de Vida"
          TopLeft="213.141664613618,325.926668710921" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restricción 2]"
          TopLeft="419.541664613618,294.217779140614">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31.7088895703069"
              Start="0,0"
              End="0,24.2088895703069">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.2088895703069" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>