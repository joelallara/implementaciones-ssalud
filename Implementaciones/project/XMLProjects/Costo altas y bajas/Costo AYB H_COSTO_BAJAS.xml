<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/23/2015 9:48:32 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="AMS06X"
  DTS:CreatorName="AMS\pgonzalez"
  DTS:DTSID="{CB4A9F41-7298-489C-9D15-F2D5B337B514}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="11274"
  DTS:ObjectName="Costo AYB H_COSTO_BAJAS"
  DTS:PackageType="5"
  DTS:VersionBuild="59"
  DTS:VersionGUID="{524893A3-D4F9-4331-9166-0B7DFB77DA42}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{53C02930-B8E7-4332-BD95-23E45CBACE55}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">1,7,OnError</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{53C02930-B8E7-4332-BD95-23E45CBACE55}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Actualiza Campos de PE en la tabla H_COSTO_BAJAS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{d8746152-1f15-4b79-b381-7100a2a6e048}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza Campos de PE en la tabla H_COSTO_BAJAS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="DECLARE @Periodo INT&#xA;SET @Periodo = (Select top 1 H.id_periodo as id_anual_costo &#xA;from D_PERIODO H where H.vigente_consumo = 1 &#xA;group by H.id_periodo &#xA;order by H.id_periodo desc)&#xA;&#xA;&#xA;---ACTUALIZA EMPRESAS COSTO BAJAS 12 MESES&#xA;UPDATE H_COSTO_BAJAS&#xA;SET id_empresa_PE_baja12 = isNULL(S.id_empresa_PE, 0),&#xA;    id_tipo_entidad_PE_baja12= isNULL(S.id_tipo_entidad_PE, 'I'),&#xA;    id_marca_PE_baja12 = isNULL(S.id_marca_PE, 7),&#xA;    id_convenio_especial_baja12 = isNULL(S.id_convenio_especial, 0)&#xA;FROM H_COSTO_BAJAS C&#xA;INNER JOIN H_COMER_STOCK_AFILIA S&#xA;ON (C.id_persona=S.id_persona)&#xA;INNER JOIN TRANS_PERIODO T ON (C.id_periodo_desgloce=T.id_periodo and S.id_periodo=T.ID_PERIODO_ANTERIOR)&#xA;WHERE C.id_anual_costo = @Periodo&#xA;&#xA;&#xA;-- ACTUALIZA CONVENIOS EMPRESA&#xA;---ACTUALIZA EMPRESAS COSTO ALTAS 12 MESES&#xA;&#xA;UPDATE H_COSTO_BAJAS&#xA;SET id_convenio = isNULL(S.id_convenio, 0),&#xA;    id_tipo_entidad_convenio = isNULL(S.id_tipo_entidad_convenio, 'I')&#xA;FROM H_COSTO_BAJAS C&#xA;INNER JOIN H_COMER_STOCK_AFILIA S&#xA;ON (C.id_persona=S.id_persona)&#xA;INNER JOIN TRANS_PERIODO T ON (C.id_periodo_desgloce=T.id_periodo and S.id_periodo=T.ID_PERIODO_ANTERIOR)&#xA;WHERE C.id_anual_costo = @Periodo&#xA;&#xA;UPDATE H_COSTO_BAJAS&#xA;SET id_convenio =  0,&#xA;    id_tipo_entidad_convenio = 'I'&#xA;FROM H_COSTO_BAJAS C&#xA;WHERE C.id_anual_costo = @Periodo and id_convenio is null&#xA;&#xA;&#xA;&#xA;select distinct id_convenio,id_tipo_entidad_convenio,0 as id_periodo_maximo into #convenios_nuevos from H_COSTO_BAJAS h&#xA;where not exists  (select id_convenio ,id_tipo_entidad_convenio &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from H_CONVENIOS_EMPRESAS C where id_periodo = @periodo&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;and h.id_periodo = &#x9;c.id_periodo and h.id_convenio = c.id_convenio and h.id_tipo_entidad_convenio = c.id_tipo_entidad_convenio) &#xA;&#x9;&#x9;and id_periodo = @periodo&#xA;&#xA;update #convenios_nuevos&#xA;set id_periodo_maximo = maximo_periodo from&#xA;#convenios_nuevos c inner join (&#xA;select t.id_convenio, max(h.id_periodo) as maximo_periodo from #convenios_nuevos t inner join H_CONVENIOS_EMPRESAS h on t.id_convenio = h.id_convenio&#xA;&#x9;and t.id_tipo_entidad_convenio = h.id_tipo_entidad_convenio&#xA;group by t.id_convenio) A on c.id_convenio = a.id_convenio&#xA;&#xA;&#xA;insert into H_CONVENIOS_EMPRESAS&#xA;select @periodo,c.id_convenio,c.id_tipo_entidad_convenio,e.id_subtipo_venta,id_rango_stock,id_rango_costo,id_blindaje,interes_comercial,es_mutual&#xA;,id_holding,'CostoBaja' from #convenios_nuevos c inner join H_CONVENIOS_EMPRESAS e&#xA;on  c.id_convenio = e.id_convenio and c.id_periodo_maximo = e.id_periodo and c.id_tipo_entidad_convenio = e.id_tipo_entidad_convenio&#xA;&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Costo Bajas 12 Meses - Cuarta Parte"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{20C1D6B7-39E0-47F0-8108-068027B05825}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Costo Bajas 12 Meses - Cuarta Parte"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="--DECIMO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A10&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 10 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas10&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 10 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA10&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas10 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 10 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI10&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas10 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 10 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R10&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas10 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 10 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T10&#xA;from&#x9;TMP#CA10&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI10&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R10&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#10&#xA;from&#x9;TMP#A10&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T10&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;&#xA;&#xA;--UNDECIMO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A11&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 11 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas11&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 11 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA11&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas11 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 11 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI11&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas11 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 11 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R11&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas11 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 11 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T11&#xA;from&#x9;TMP#CA11&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI11&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R11&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#11&#xA;from&#x9;TMP#A11&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T11&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;&#xA;&#xA;--DUODECIMO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A12&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 12 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas12&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 12 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA12&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas12 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 12 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI12&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas12 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 12 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R12&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas12 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 12 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T12&#xA;from&#x9;TMP#CA12&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI12&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R12&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#12&#xA;from&#x9;TMP#A12&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T12&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Costo Bajas 12 Meses - Primera Parte"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{908551f5-ad2f-417c-9bbb-403f5915fe36}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Costo Bajas 12 Meses - Primera Parte"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="SET DATEFORMAT 'YMD'&#xA;&#xA;--PRIMER MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A1&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 1 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas1&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 1 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA1&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas1 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 1 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI1&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas1 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 1 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R1&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas1 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 1 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T1&#xA;from&#x9;TMP#CA1&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI1&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R1&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#1&#xA;from&#x9;TMP#A1&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T1&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;&#xA;&#xA;--SEGUNDO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A2&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 2 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas2&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 2 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA2&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas2 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 2 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI2&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas2 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 2 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R2&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas2 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 2 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T2&#xA;from&#x9;TMP#CA2&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI2&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R2&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#2&#xA;from&#x9;TMP#A2&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T2&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;&#xA;--TERCER MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A3&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 3 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas3&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 3 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA3&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas3 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 3 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI3&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas3 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 3 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R3&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas3 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 3 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T3&#xA;from&#x9;TMP#CA3&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI3&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R3&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#3&#xA;from&#x9;TMP#A3&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T3&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Costo Bajas 12 Meses - Quinta Parte"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{68FD6C53-F5B6-43F1-B14C-85A085EECF57}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Costo Bajas 12 Meses - Quinta Parte"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="SET DATEFORMAT 'YMD'&#xA;DELETE FROM AUX_H_COSTO_BAJAS&#xA;&#xA;DECLARE @PeriodoCosto Int&#xA;SET @PeriodoCosto = (Select top 1 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc)&#xA;&#xA;DELETE H_COSTO_BAJAS WHERE id_periodo = @PeriodoCosto&#xA;&#xA;&#xA;INSERT INTO AUX_H_COSTO_BAJAS (id_anual_costo, &#xA;&#x9;id_ultimo_periodo_costo, &#xA;&#x9;id_periodo,&#xA;&#x9;id_periodo_desgloce,&#xA;&#x9;id_persona, &#xA;&#x9;id_zona_comercial, &#xA;&#x9;id_subrubro_ley, &#xA;&#x9;id_supervisor, &#xA;&#x9;id_producto,&#xA;&#x9;id_plan_producto, &#xA;&#x9;cant_bajas_reales,&#xA;&#x9;consumo,&#xA;&#x9;recaudacion)&#xA;&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto,  id_plan_producto, cant_bajas_reales, Consumo, Recaudacion &#xA;FROM TMP#1&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#2&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#3&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#4&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#5&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#6&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#7&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#8&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#9&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#10&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#11&#xA;UNION ALL&#xA;Select @PeriodoCosto, 0 as id_ultimo_periodo_costo, @PeriodoCosto, ID_Periodo, id_persona, Id_Zona_Comercial, Id_SubRubro_Ley, id_supervisor, id_producto, id_plan_producto, cant_bajas_reales, Consumo, Recaudacion&#xA;FROM TMP#12&#xA;&#xA;&#xA;------UPDATE AUX_H_COSTO_BAJAS&#xA;------SET id_promotor = A.id_promotor&#xA;------FROM H_BAJAS_GENUINAS A INNER JOIN AUX_H_COSTO_BAJAS H ON (A.id_persona=H.id_persona)&#xA;------WHERE A.id_producto=H.id_producto&#xA;&#xA;-----INSERT INTO H_COSTO_BAJAS&#xA;-----SELECT * FROM AUX_H_COSTO_BAJAS&#xA;&#xA;----- implementado 04  de mayo 2017 inserta la id entidad en 0 para luego poder actualizarla&#xA;----- implementado 10  de JULIO 2017 inserta 4 campos nuevos de proyecto &#xA;&#xA;INSERT INTO H_COSTO_BAJAS (id_anual_costo, &#xA;&#x9;id_ultimo_periodo_costo, &#xA;&#x9;id_periodo,&#xA;&#x9;id_periodo_desgloce,&#xA;&#x9;id_persona, &#xA;&#x9;id_zona_comercial, &#xA;&#x9;id_subrubro_ley, &#xA;&#x9;id_supervisor, &#xA;&#x9;id_producto,&#xA;&#x9;id_plan_producto, &#xA;&#x9;cant_bajas_reales,&#xA;&#x9;consumo,&#xA;&#x9;recaudacion, &#xA;&#x9;&#x9;&#x9; [id_entidad]&#xA;&#x9;&#x9;&#x9; ,[id_empresa_PE_baja12]&#xA;&#x9;&#x9;&#x9;,[id_tipo_entidad_PE_baja12]&#xA;&#x9;&#x9;&#x9;,[id_marca_PE_baja12]&#xA;&#x9;&#x9;&#x9;, [id_convenio_especial_baja12])&#xA;SELECT id_anual_costo, &#xA;&#x9;id_ultimo_periodo_costo, &#xA;&#x9;id_periodo,&#xA;&#x9;id_periodo_desgloce,&#xA;&#x9;id_persona, &#xA;&#x9;id_zona_comercial, &#xA;&#x9;id_subrubro_ley, &#xA;&#x9;id_supervisor, &#xA;&#x9;id_producto,&#xA;&#x9;id_plan_producto, &#xA;&#x9;cant_bajas_reales,&#xA;&#x9;consumo,&#xA;&#x9;recaudacion &#xA;&#x9;&#x9;&#x9;, 0 as id_entidad&#xA;&#x9;&#x9;&#x9;, NULL AS [id_empresa_PE_baja12]&#xA;&#x9;&#x9;&#x9;, NULL AS [id_tipo_entidad_PE_baja12]&#xA;&#x9;&#x9;&#x9;, NULL AS [id_marca_PE_baja12]&#xA;&#x9;&#x9;&#x9;, NULL AS [id_convenio_especial_baja12]&#xA;&#x9;&#x9;&#x9;FROM AUX_H_COSTO_BAJAS&#xA;&#xA;&#xA;------- Apartir del 20 del abril 2017 , se actualiza tambien entidad&#xA;&#xA;UPDATE H_COSTO_BAJAS&#xA;SET id_promotor = A.id_promotor,&#xA;id_entidad = a.id_entidad&#xA;FROM H_BAJAS_GENUINAS A INNER JOIN H_COSTO_BAJAS H ON (A.id_persona=H.id_persona and a.id_periodo = h.id_periodo_desgloce)&#xA;WHERE H.id_anual_costo = @PeriodoCosto&#xA;&#xA;update H_COSTO_BAJAS set id_ultimo_periodo_costo = 1 where id_anual_costo = @PeriodoCosto and id_periodo_desgloce in (select MAX(id_periodo_desgloce) from H_COSTO_BAJAS)&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#1') begin drop table TMP#1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#2') begin  drop table TMP#2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#3')begin  drop table TMP#3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#4') begin  drop table TMP#4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#5') begin  drop table TMP#5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#6') begin  drop table TMP#6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#7') begin drop table TMP#7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#8') begin  drop table TMP#8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#9')begin  drop table TMP#9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#10') begin  drop table TMP#10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#11') begin  drop table TMP#11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#12') begin  drop table TMP#12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A1') begin  drop table TMP#A1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A2') begin  drop table TMP#A2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A3') begin  drop table TMP#A3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A4') begin  drop table TMP#A4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A5') begin  drop table TMP#A5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A6') begin  drop table TMP#A6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A7') begin  drop table TMP#A7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A8') begin  drop table TMP#A8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A9') begin  drop table TMP#A9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A10') begin  drop table TMP#A10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A11') begin  drop table TMP#A11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A12') begin  drop table TMP#A12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T1') begin  drop table TMP#T1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T2') begin  drop table TMP#T2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T3') begin  drop table TMP#T3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T4') begin  drop table TMP#T4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T5') begin  drop table TMP#T5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T6') begin  drop table TMP#T6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T7') begin  drop table TMP#T7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T8') begin  drop table TMP#T8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T9') begin  drop table TMP#T9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T10') begin  drop table TMP#T10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T11') begin  drop table TMP#T11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T12') begin  drop table TMP#T12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA1') begin  drop table TMP#CA1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA2') begin  drop table TMP#CA2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA3') begin  drop table TMP#CA3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA4') begin  drop table TMP#CA4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA5') begin  drop table TMP#CA5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA6') begin  drop table TMP#CA6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA7') begin  drop table TMP#CA7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA8') begin  drop table TMP#CA8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA9') begin  drop table TMP#CA9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA10') begin  drop table TMP#CA10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA11') begin  drop table TMP#CA11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA12') begin  drop table TMP#CA12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI1') begin  drop table TMP#CI1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI2') begin  drop table TMP#CI2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI3') begin  drop table TMP#CI3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI4') begin  drop table TMP#CI4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI5') begin  drop table TMP#CI5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI6') begin  drop table TMP#CI6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI7') begin  drop table TMP#CI7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI8') begin  drop table TMP#CI8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI9') begin  drop table TMP#CI9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI10') begin  drop table TMP#CI10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI11') begin  drop table TMP#CI11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI12') begin  drop table TMP#CI12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R1') begin  drop table TMP#R1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R2') begin  drop table TMP#R2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R3') begin  drop table TMP#R3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R4') begin  drop table TMP#R4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R5') begin  drop table TMP#R5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R6') begin  drop table TMP#R6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R7') begin  drop table TMP#R7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R8') begin  drop table TMP#R8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R9') begin  drop table TMP#R9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R10') begin  drop table TMP#R10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R11') begin  drop table TMP#R11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R12') begin  drop table TMP#R12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas1') begin  drop table TMP#Personas1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas2') begin  drop table TMP#Personas2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas3') begin  drop table TMP#Personas3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas4') begin  drop table TMP#Personas4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas5') begin  drop table TMP#Personas5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas6') begin  drop table TMP#Personas6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas7') begin  drop table TMP#Personas7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas8') begin  drop table TMP#Personas8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas9') begin  drop table TMP#Personas9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas10') begin  drop table TMP#Personas10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas11') begin  drop table TMP#Personas11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas12') begin  drop table TMP#Personas12 end&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Costo Bajas 12 Meses - Segunda Parte"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{0da4846c-89b3-4552-91e2-68affbdd7cde}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Costo Bajas 12 Meses - Segunda Parte"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="--CUARTO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A4&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 4 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas4&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 4 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA4&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas4 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 4 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI4&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas4 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 4 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R4&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas4 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 4 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T4&#xA;from&#x9;TMP#CA4&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI4&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R4&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#4&#xA;from&#x9;TMP#A4&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T4&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;&#xA;&#xA;--QUINTO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A5&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 5 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas5&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 5 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA5&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas5 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 5 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI5&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas5 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 5 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R5&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas5 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 5 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T5&#xA;from&#x9;TMP#CA5&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI5&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R5&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#5&#xA;from&#x9;TMP#A5&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T5&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;&#xA;&#xA;--SEXTO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A6&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 6 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas6&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 6 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA6&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas6 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 6 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI6&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas6 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 6 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R6&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas6 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 6 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T6&#xA;from&#x9;TMP#CA6&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI6&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R6&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#6&#xA;from&#x9;TMP#A6&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T6&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Costo Bajas 12 Meses - Tercera Parte"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{d8e0dfc0-dfef-4732-8f90-f4f535353320}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Costo Bajas 12 Meses - Tercera Parte"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="--SEPTIMO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A7&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 7 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas7&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 7 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA7&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas7 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 7 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI7&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas7 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 7 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R7&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas7 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 7 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T7&#xA;from&#x9;TMP#CA7&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI7&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R7&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#7&#xA;from&#x9;TMP#A7&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T7&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;&#xA;&#xA;--OCTAVO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A8&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 8 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas8&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 8 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA8&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas8 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 8 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI8&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas8 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 8 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R8&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas8 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 8 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T8&#xA;from&#x9;TMP#CA8&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI8&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R8&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#8&#xA;from&#x9;TMP#A8&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T8&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;&#xA;&#xA;--NOVENO MES DE CONSUMO&#xA;&#xA;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_persona,&#xA;&#x9;sum(a11.comer_cant_bajas_genuina)  WJXBFS1&#xA;into TMP#A9&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 9 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;a11.id_producto,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;a11.ID_Periodo,&#xA;&#x9;a11.id_persona&#xA;&#x9;&#xA;&#xA;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;select&#x9;a11.Id_Persona ,a11.id_supervisor&#xA;into TMP#Personas9&#xA;from&#x9;H_BAJAS_GENUINAS&#x9;a11&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;where&#x9;(a11.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 9 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a11.Id_Persona,  a11.id_supervisor&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;into TMP#CA9&#xA;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas9 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 9 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo,&#xA;&#x9;a11.id_plan_producto,&#xA;    PE.id_supervisor,&#xA;    a11.id_producto,&#xA;    PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;into TMP#CI9&#xA;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;    join    TMP#Personas9 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 9 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.ccosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;A11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona,&#xA;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;into TMP#R9&#xA;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;join&#x9;TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#x9;a12&#xA;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA; join    TMP#Personas9 PE&#xA;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;where&#x9;(a12.ID_Periodo in (select MIN(Ultimo.Periodo) from&#xA;(Select top 9 H.id_periodo as Periodo from D_PERIODO H where H.vigente_consumo=1 group by  H.id_periodo order by H.id_periodo desc) Ultimo)&#xA; and a11.rcosto3 = 1&#xA; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;a12.ID_Periodo ,&#xA;&#x9;a11.id_plan_producto,&#xA;&#x9;PE.id_supervisor,&#xA;&#x9;a11.id_producto,&#xA;&#x9;PE.id_persona&#xA;&#xA;&#xA;select&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto) id_producto,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;into TMP#T9&#xA;from&#x9;TMP#CA9&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#CI9&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor&#xA;&#x9;and pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;full outer join&#x9;TMP#R9&#x9;pa13&#xA;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and &#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona and&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto)&#xA;&#x9;&#xA;&#xA;select&#x9;distinct coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;IsNull(pa11.WJXBFS1,0)  cant_bajas_reales,&#xA;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;INTO TMP#9&#xA;from&#x9;TMP#A9&#x9;pa11&#xA;&#x9;full outer join&#x9;TMP#T9&#x9;pa12&#xA;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;pa11.id_producto = pa12.id_producto and&#xA;pa11.id_persona = pa12.id_persona)&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Inserta Periodos en TRANS_PERIODO_CONSUMO_BAJAS_12_MESES"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{274e516f-6c59-47ce-909c-69815640a54e}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Inserta Periodos en TRANS_PERIODO_CONSUMO_BAJAS_12_MESES"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="&#xA;-- declara periodos&#xA;declare @Periodo_Costo_Bajas_12_Meses int&#xA;Select @Periodo_Costo_Bajas_12_Meses = max(id_periodo) from H_ORD_AMB_DET&#xA;&#xA;-- Controla con el maximo periodo de ambulatorio.&#xA;If @Periodo_Costo_Bajas_12_Meses = (Select max(id_periodo_consumo) from TRANS_PERIODO_CONSUMO_BAJAS_12_MESES)&#xA;DELETE FROM TRANS_PERIODO_CONSUMO_BAJAS_12_MESES WHERE id_periodo in (select id_periodo from TRANS_PERIODO_CONSUMO_BAJAS_12_MESES where id_periodo_consumo = @Periodo_Costo_Bajas_12_Meses)&#xA;&#xA;DECLARE @Periodo INT SET @Periodo = (Select top 1 H.id_periodo from D_PERIODO H where H.vigente_consumo=1 group by H.id_periodo order by H.id_periodo desc)&#xA;&#xA;INSERT INTO TRANS_PERIODO_CONSUMO_BAJAS_12_MESES&#xA;(id_periodo, id_periodo_consumo)&#xA;Select top 12 @Periodo as Id_Periodo, H.id_periodo as id_periodo_consumo&#xA;from D_PERIODO H where H.vigente_consumo=1 group by&#xA;H.id_periodo order by H.id_periodo desc" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Verifico Periodo a Actualizar"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6db7d938-a980-4d64-88f6-1b3fdbf9010a}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Verifico Periodo a Actualizar"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="&#xA;/* Tomo el periodo a procesar igual al ultimo periodo de consumos. Para ello, si entre ambulatorio&#xA; e internaciones no son iguales los periodos se termina el proceso. Si son iguales sigo &#xA; borrando el Costo de Altas 12 meses si ya esta cargado. */&#xA;&#xA;declare @Periodo_Consumos int&#xA;Select @Periodo_Consumos = max(id_periodo) from H_ORD_AMB_DET&#xA;&#xA;If @Periodo_Consumos &lt;&gt; (Select max(id_periodo) from H_ORD_INT_CAB)&#xA;RAISERROR ('Diferentes Periodos de Consumos entre Internaciones y Ambulatorio - Proceso cancelado.', 16, 1)&#xA;&#xA;If @Periodo_Consumos &lt;&gt; (Select max(id_periodo) from D_PERIODO H where H.vigente_consumo = 1)&#xA;RAISERROR ('Periodo Proceso Actualización H_COSTO_BAJAS Incorrecto.', 16, 1)&#xA;&#xA;DELETE FROM H_COSTO_BAJAS WHERE id_anual_costo = @Periodo_Consumos&#xA;&#xA;/* Borra tablas temporales que se utilizaran en el proceso */&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#1') begin drop table TMP#1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#2') begin  drop table TMP#2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#3')begin  drop table TMP#3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#4') begin  drop table TMP#4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#5') begin  drop table TMP#5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#6') begin  drop table TMP#6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#7') begin drop table TMP#7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#8') begin  drop table TMP#8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#9')begin  drop table TMP#9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#10') begin  drop table TMP#10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#11') begin  drop table TMP#11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#12') begin  drop table TMP#12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A1') begin  drop table TMP#A1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A2') begin  drop table TMP#A2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A3') begin  drop table TMP#A3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A4') begin  drop table TMP#A4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A5') begin  drop table TMP#A5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A6') begin  drop table TMP#A6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A7') begin  drop table TMP#A7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A8') begin  drop table TMP#A8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A9') begin  drop table TMP#A9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A10') begin  drop table TMP#A10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A11') begin  drop table TMP#A11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A12') begin  drop table TMP#A12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T1') begin  drop table TMP#T1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T2') begin  drop table TMP#T2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T3') begin  drop table TMP#T3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T4') begin  drop table TMP#T4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T5') begin  drop table TMP#T5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T6') begin  drop table TMP#T6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T7') begin  drop table TMP#T7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T8') begin  drop table TMP#T8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T9') begin  drop table TMP#T9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T10') begin  drop table TMP#T10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T11') begin  drop table TMP#T11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T12') begin  drop table TMP#T12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA1') begin  drop table TMP#CA1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA2') begin  drop table TMP#CA2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA3') begin  drop table TMP#CA3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA4') begin  drop table TMP#CA4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA5') begin  drop table TMP#CA5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA6') begin  drop table TMP#CA6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA7') begin  drop table TMP#CA7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA8') begin  drop table TMP#CA8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA9') begin  drop table TMP#CA9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA10') begin  drop table TMP#CA10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA11') begin  drop table TMP#CA11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA12') begin  drop table TMP#CA12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI1') begin  drop table TMP#CI1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI2') begin  drop table TMP#CI2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI3') begin  drop table TMP#CI3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI4') begin  drop table TMP#CI4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI5') begin  drop table TMP#CI5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI6') begin  drop table TMP#CI6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI7') begin  drop table TMP#CI7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI8') begin  drop table TMP#CI8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI9') begin  drop table TMP#CI9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI10') begin  drop table TMP#CI10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI11') begin  drop table TMP#CI11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI12') begin  drop table TMP#CI12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R1') begin  drop table TMP#R1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R2') begin  drop table TMP#R2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R3') begin  drop table TMP#R3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R4') begin  drop table TMP#R4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R5') begin  drop table TMP#R5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R6') begin  drop table TMP#R6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R7') begin  drop table TMP#R7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R8') begin  drop table TMP#R8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R9') begin  drop table TMP#R9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R10') begin  drop table TMP#R10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R11') begin  drop table TMP#R11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R12') begin  drop table TMP#R12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas1') begin  drop table TMP#Personas1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas2') begin  drop table TMP#Personas2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas3') begin  drop table TMP#Personas3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas4') begin  drop table TMP#Personas4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas5') begin  drop table TMP#Personas5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas6') begin  drop table TMP#Personas6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas7') begin  drop table TMP#Personas7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas8') begin  drop table TMP#Personas8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas9') begin  drop table TMP#Personas9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas10') begin  drop table TMP#Personas10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas11') begin  drop table TMP#Personas11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas12') begin  drop table TMP#Personas12 end&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{FC708A64-2023-4F30-878E-994DCC079493}"
      DTS:From="Package\Inserta Periodos en TRANS_PERIODO_CONSUMO_BAJAS_12_MESES"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Verifico Periodo a Actualizar" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{71470408-D124-472C-9F6E-538E0D7C1A5E}"
      DTS:From="Package\Verifico Periodo a Actualizar"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Costo Bajas 12 Meses - Primera Parte" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{0F8BBD7C-9D88-4EA9-9E40-40C0A777FF51}"
      DTS:From="Package\Costo Bajas 12 Meses - Primera Parte"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Costo Bajas 12 Meses - Segunda Parte" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{4427BEFF-9E04-4BB4-8A28-C973C38F3565}"
      DTS:From="Package\Costo Bajas 12 Meses - Segunda Parte"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Costo Bajas 12 Meses - Tercera Parte" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{034B2650-BCCE-4E5C-955F-D807F0BB5BFE}"
      DTS:From="Package\Costo Bajas 12 Meses - Tercera Parte"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\Costo Bajas 12 Meses - Cuarta Parte" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{1FB7567B-1B14-49C2-A995-33F6F06F44E1}"
      DTS:From="Package\Costo Bajas 12 Meses - Cuarta Parte"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\Costo Bajas 12 Meses - Quinta Parte" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{75D0D167-423D-4D56-835F-6FE66DB6CE0B}"
      DTS:From="Package\Costo Bajas 12 Meses - Quinta Parte"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\Actualiza Campos de PE en la tabla H_COSTO_BAJAS" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="351,42"
          Id="Package\Actualiza Campos de PE en la tabla H_COSTO_BAJAS"
          TopLeft="45.0518867924528,596.858490566038" />
        <NodeLayout
          Size="260,42"
          Id="Package\Costo Bajas 12 Meses - Cuarta Parte"
          TopLeft="90.5518867924528,427.898921832884" />
        <NodeLayout
          Size="266,42"
          Id="Package\Costo Bajas 12 Meses - Primera Parte"
          TopLeft="87.5518867924528,174.459568733154" />
        <NodeLayout
          Size="260,42"
          Id="Package\Costo Bajas 12 Meses - Quinta Parte"
          TopLeft="90.5518867924528,512.378706199461" />
        <NodeLayout
          Size="271,42"
          Id="Package\Costo Bajas 12 Meses - Segunda Parte"
          TopLeft="85.0518867924528,258.939353099731" />
        <NodeLayout
          Size="265,42"
          Id="Package\Costo Bajas 12 Meses - Tercera Parte"
          TopLeft="88.0518867924528,343.419137466307" />
        <NodeLayout
          Size="438,42"
          Id="Package\Inserta Periodos en TRANS_PERIODO_CONSUMO_BAJAS_12_MESES"
          TopLeft="1.55188679245282,5.5" />
        <NodeLayout
          Size="217,42"
          Id="Package\Verifico Periodo a Actualizar"
          TopLeft="112.051886792453,89.9797843665768" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="220.551886792453,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.4797843665768"
              Start="0,0"
              End="0,34.9797843665768">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.9797843665768" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="220.551886792453,131.979784366577">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.4797843665768"
              Start="0,0"
              End="0,34.9797843665768">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.9797843665768" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="220.551886792453,216.459568733154">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.4797843665768"
              Start="0,0"
              End="0,34.9797843665768">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.9797843665768" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="220.551886792453,300.939353099731">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.4797843665768"
              Start="0,0"
              End="0,34.9797843665768">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.9797843665768" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="220.551886792453,385.419137466307">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.4797843665768"
              Start="0,0"
              End="0,34.9797843665768">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.9797843665768" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="220.551886792453,469.898921832884">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.4797843665768"
              Start="0,0"
              End="0,34.9797843665768">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.9797843665768" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="220.551886792453,554.378706199461">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.4797843665768"
              Start="0,0"
              End="0,34.9797843665768">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,34.9797843665768" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>