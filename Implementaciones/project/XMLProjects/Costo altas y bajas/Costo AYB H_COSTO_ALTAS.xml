<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/23/2015 9:48:32 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="AMS06X"
  DTS:CreatorName="AMS\pgonzalez"
  DTS:DTSID="{71BA52AF-8C6F-4BD7-9697-45F3D2AA2180}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="11274"
  DTS:ObjectName="Costo AYB H_COSTO_ALTAS"
  DTS:PackageType="5"
  DTS:VersionBuild="65"
  DTS:VersionGUID="{5311607A-92F2-4207-A92F-799A4A86C2CD}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{22929354-3902-4BDA-9E81-2B3920748336}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">1,7,OnError</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{22929354-3902-4BDA-9E81-2B3920748336}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Actualiza Campos de PE en la tabla H_COSTO_ALTAS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{736f0ad6-d533-4680-98bc-d40820251e63}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza Campos de PE en la tabla H_COSTO_ALTAS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="DECLARE @Periodo INT&#xA;SET @Periodo = (Select top 1 H.id_periodo as id_anual_costo &#xA;from D_PERIODO H where H.vigente_consumo = 1 &#xA;group by H.id_periodo &#xA;order by H.id_periodo desc)&#xA; &#xA;---ACTUALIZA EMPRESAS COSTO ALTAS 12 MESES&#xA;UPDATE H_COSTO_ALTAS&#xA;SET id_empresa_PE_alt12 = isNULL(S.id_empresa_PE, 0),&#xA;    id_tipo_entidad_PE_alt12 = isNULL(S.id_tipo_entidad_PE, 'I'),&#xA;    id_marca_PE_alt12 = isNULL(S.id_marca_PE, 7),&#xA;    id_convenio_especial_alt12 = isNULL(S.id_convenio_especial, 0)&#xA;FROM H_COSTO_ALTAS C INNER JOIN H_COMER_STOCK_AFILIA S&#xA;ON (C.id_periodo_desgloce=S.id_periodo AND C.id_persona=S.id_persona)&#xA;WHERE C.id_anual_costo = @Periodo&#xA;&#xA;&#xA;-- ACTUALIZA CONVENIOS EMPRESA&#xA;---ACTUALIZA EMPRESAS COSTO ALTAS 12 MESES&#xA;UPDATE H_COSTO_ALTAS&#xA;SET id_convenio = isNULL(S.id_convenio, 0),&#xA;    id_tipo_entidad_convenio = isNULL(S.id_tipo_entidad_convenio, 'I')&#xA;FROM H_COSTO_ALTAS C INNER JOIN H_COMER_STOCK_AFILIA S&#xA;ON (C.id_periodo_desgloce=S.id_periodo AND C.id_persona=S.id_persona)&#xA;WHERE C.id_anual_costo = @Periodo&#xA;&#xA;&#xA;&#xA;&#xA;select distinct id_convenio,id_tipo_entidad_convenio,0 as id_periodo_maximo into #convenios_nuevos from H_COSTO_ALTAS h&#xA;where  not exists  (select id_convenio ,id_tipo_entidad_convenio &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from H_CONVENIOS_EMPRESAS C where id_periodo = @periodo&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;and h.id_periodo = &#x9;c.id_periodo and h.id_convenio = c.id_convenio and h.id_tipo_entidad_convenio = c.id_tipo_entidad_convenio) &#xA;&#x9;&#x9;and id_periodo = @periodo&#xA;update #convenios_nuevos&#xA;set id_periodo_maximo = maximo_periodo from&#xA;#convenios_nuevos c inner join (&#xA;select t.id_convenio, max(h.id_periodo) as maximo_periodo from #convenios_nuevos t inner join H_CONVENIOS_EMPRESAS h on t.id_convenio = h.id_convenio&#xA;&#x9;and t.id_tipo_entidad_convenio = h.id_tipo_entidad_convenio&#xA;group by t.id_convenio) A on c.id_convenio = a.id_convenio&#xA;&#xA;&#xA;insert into H_CONVENIOS_EMPRESAS&#xA;select @periodo,c.id_convenio,c.id_tipo_entidad_convenio,e.id_subtipo_venta,id_rango_stock,id_rango_costo,id_blindaje,interes_comercial,es_mutual&#xA;,id_holding,'CostoAlta' from #convenios_nuevos c inner join H_CONVENIOS_EMPRESAS e&#xA;on  c.id_convenio = e.id_convenio and c.id_periodo_maximo = e.id_periodo and c.id_tipo_entidad_convenio = e.id_tipo_entidad_convenio&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Calculo del Costo"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{ADA92F57-7DA4-485B-B998-FB558D081CDD}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Calculo del Costo"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="/* OBSERVACIÓN: Para cada @PeriodoCosto, se analizan 12 meses de Altas (@PeriodoDesgloce) siguiendo la logica que esta plasmada en el Excel &quot;Logica de llenado Costo altas y bajas&quot; &#xA;y para cada @PeriodoDesgloce se analizan 12 meses de Consumo y Recaudacion siguiendo la logica de la TRANS_PERIODO_CONSUMO */&#xA;&#xA;DECLARE @PeriodoCosto INT = (select max(id_periodo) from D_PERIODO where vigente_consumo = 1) --mes de costo de altas que estamos calculando&#xA;&#xA;DECLARE @PeriodoDesgloceTope int = (select DW_SALUD.DBO.PeriodosAnteriores(@PeriodoCosto, 13)) --viene a ser el periodo de alta TOPE, el ultimo que correspondería analizar.&#xA;&#xA;DECLARE @PeriodoDesgloce int = (select DW_SALUD.DBO.PeriodosAnteriores(@PeriodoDesgloceTope, 12)) --con esta variable recorremos todos los periodos de altas que se analizan para cada @PeriodoCosto, arrancando del ultimo, hasta el @PeriodoDesgloceTope&#xA;&#xA;--SELECT @PeriodoCosto,@PeriodoDesgloce,@PeriodoDesgloceTope&#xA;&#xA;&#xA;truncate table AUX_H_COSTO_ALTAS&#xA;&#xA;WHILE @PeriodoDesgloce &lt;= @PeriodoDesgloceTope&#xA;BEGIN&#xA;&#x9;select&#x9;a11.id_supervisor, a13.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;&#x9;a14.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;&#x9;a11.ID_Periodo  ID_Periodo,&#xA;&#x9;&#x9;a11.id_plan_producto,&#xA;&#x9;&#x9;a11.id_producto,&#xA;&#x9;&#x9;a11.id_persona,&#xA;&#x9;&#x9;sum(a11.comer_cant_altas_genuina)  WJXBFS1&#xA;&#x9;into TMP#A1&#xA;&#x9;from&#x9;H_ALTAS_GENUINAS&#x9;a11&#xA;&#x9;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;&#x9;where&#x9;(a11.ID_Periodo in (@PeriodoDesgloce)&#xA;&#x9; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a16 WHERE a11.id_producto=a16.id_producto and a11.id_plan_producto=a16.id_plan_producto))&#xA;&#x9;group by&#x9;a11.id_supervisor, a13.Id_Zona_Comercial,&#xA;&#x9;&#x9;a14.Id_SubRubro_Ley,&#xA;&#x9;&#x9;a11.ID_Periodo,&#xA;&#x9;&#x9;a11.id_producto,&#xA;&#x9;&#x9;a11.id_plan_producto,&#xA;&#x9;&#x9;a11.id_persona&#xA;&#xA;&#xA;&#x9;-- Busca las personas del Periodo para luego filtrar el consumo y recaudación para esas personas solamente&#xA;&#xA;&#x9;select&#x9;a11.Id_Persona, a11.id_supervisor&#xA;&#x9;into TMP#Personas1&#xA;&#x9;from&#x9;H_ALTAS_GENUINAS&#x9;a11&#xA;&#x9;&#x9;join&#x9;D_PERSONAS&#x9;a12&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Persona = a12.Id_Persona)&#xA;&#x9;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a13&#xA;&#x9;&#x9;  on &#x9;(a12.id_localidad_afiliado = a13.id_localidad_afiliado)&#xA;&#x9;&#x9;join&#x9;D_PLANES&#x9;a14&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Plan_Producto = a14.Id_Plan_Producto and &#xA;&#x9;&#x9;a11.Id_Producto = a14.Id_Producto)&#xA;&#x9;where&#x9;(a11.ID_Periodo in (@PeriodoDesgloce)&#xA;&#x9; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a16 WHERE a11.id_producto=a16.id_producto and a11.id_plan_producto=a16.id_plan_producto))&#xA;&#x9;group by&#x9;a11.Id_Persona, a11.id_supervisor&#xA;&#xA;&#xA;&#x9;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;&#x9;a11.id_plan_producto,&#xA;&#x9;&#x9;PE.id_supervisor,&#xA;&#x9;&#x9;a11.id_producto,&#xA;&#x9;&#x9;PE.id_persona,&#xA;&#x9;&#x9;sum(a11.imp_prest_amb_acep)  WJXBFS1&#xA;&#x9;into TMP#CA1&#xA;&#x9;from&#x9;H_ORD_AMB_DET&#x9;a11&#xA;&#x9;&#x9;join&#x9;TRANS_PERIODO_CONSUMO&#x9;a12&#xA;&#x9;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;&#x9; join    TMP#Personas1 PE&#xA;&#x9;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;&#x9;where&#x9;(a12.ID_Periodo in (@PeriodoDesgloce)&#xA;&#x9; and a11.ccosto3 = 1&#xA;&#x9; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;&#x9;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;&#x9;a12.ID_Periodo ,&#xA;&#x9;&#x9;a11.id_producto,&#xA;&#x9;&#x9;a11.id_plan_producto,&#xA;&#x9;&#x9;PE.id_supervisor,&#xA;&#x9;&#x9;PE.id_persona&#xA;&#xA;&#xA;&#x9;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;&#x9;a16.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;&#x9;a11.id_plan_producto,&#xA;&#x9;&#x9;a11.id_producto,&#xA;&#x9;&#x9;PE.id_supervisor,&#xA;&#x9;&#x9;PE.id_persona,&#xA;&#x9;&#x9;sum(a11.imp_prest_int_acep)  WJXBFS1&#xA;&#x9;into TMP#CI1&#xA;&#x9;from&#x9;H_ORD_INT_DET&#x9;a11&#xA;&#x9;&#x9;join&#x9;TRANS_PERIODO_CONSUMO&#x9;a12&#xA;&#x9;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;&#x9;join&#x9;D_PLANES&#x9;a16&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Plan_Producto = a16.Id_Plan_Producto and &#xA;&#x9;&#x9;a11.Id_Producto = a16.Id_Producto)&#xA;&#x9; join    TMP#Personas1 PE&#xA;&#x9;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;&#x9;where&#x9;(a12.ID_Periodo in (@PeriodoDesgloce)&#xA;&#x9; and a11.ccosto3 = 1&#xA;&#x9; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;&#x9;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;&#x9;a16.Id_SubRubro_Ley,&#xA;&#x9;&#x9;a12.ID_Periodo ,a11.id_producto,&#xA;&#x9;&#x9;a11.id_plan_producto,&#xA;&#x9;&#x9;PE.id_supervisor,&#xA;&#x9;&#x9;PE.id_persona&#xA;&#xA;&#xA;&#x9;select&#x9;a14.Id_Zona_Comercial  Id_Zona_Comercial,&#xA;&#x9;&#x9;a15.Id_SubRubro_Ley  Id_SubRubro_Ley,&#xA;&#x9;&#x9;a12.ID_Periodo  ID_Periodo,&#xA;&#x9;&#x9;a11.id_plan_producto,&#xA;&#x9;&#x9;a11.id_producto,&#xA;&#x9;&#x9;PE.id_supervisor,&#xA;&#x9;&#x9;PE.id_persona,&#xA;&#x9;&#x9;sum(a11.total_recaudacion)  WJXBFS1&#xA;&#x9;into TMP#R1&#xA;&#x9;from&#x9;H_RECAUDACION_DETALLE&#x9;a11&#xA;&#x9;&#x9;join&#x9;TRANS_PERIODO_CONSUMO&#x9;a12&#xA;&#x9;&#x9;  on &#x9;(a11.ID_Periodo = a12.Id_Periodo_Consumo)&#xA;&#x9;&#x9;join&#x9;D_PERSONAS&#x9;a13&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Persona = a13.Id_Persona)&#xA;&#x9;&#x9;join&#x9;D_LOCALIDADES_AFILIADO&#x9;a14&#xA;&#x9;&#x9;  on &#x9;(a13.id_localidad_afiliado = a14.id_localidad_afiliado)&#xA;&#x9;&#x9;join&#x9;D_PLANES&#x9;a15&#xA;&#x9;&#x9;  on &#x9;(a11.Id_Plan_Producto = a15.Id_Plan_Producto and &#xA;&#x9;&#x9;a11.Id_Producto = a15.Id_Producto)&#xA;&#x9; join    TMP#Personas1 PE&#xA;&#x9;&#x9;  on&#x9;(a11.id_persona = PE.id_persona)&#xA;&#x9;where&#x9;(a12.ID_Periodo in (@PeriodoDesgloce)&#xA;&#x9; and a11.rcosto3 = 1&#xA;&#x9; and Not Exists (SELECT * FROM FILTRO_PLAN_PRODUCTO a17 WHERE a11.id_producto=a17.id_producto and a11.id_plan_producto=a17.id_plan_producto))&#xA;&#x9;group by&#x9;a14.Id_Zona_Comercial,&#xA;&#x9;&#x9;a15.Id_SubRubro_Ley,&#xA;&#x9;&#x9;a12.ID_Periodo ,&#xA;&#x9;&#x9;a11.id_producto,&#xA;&#x9;&#x9;PE.id_supervisor,&#xA;&#x9;&#x9;a11.id_plan_producto,&#xA;&#x9;&#x9;PE.id_persona&#xA;&#xA;&#xA;&#x9;select&#x9;&#xA;&#x9;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial, pa13.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley, pa13.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo, pa13.ID_Periodo)  ID_Periodo,&#xA;&#x9;&#x9;coalesce(pa11.id_persona, pa12.id_persona, pa13.id_persona)  id_persona,&#xA;&#x9;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto, pa13.id_plan_producto)  id_plan_producto,&#xA;&#x9;&#x9;coalesce(pa11.id_producto, pa12.id_producto, pa13.id_producto)  id_producto,&#xA;&#x9;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor, pa13.id_supervisor)  id_supervisor,&#xA;&#x9;&#x9;(ISNULL(pa11.WJXBFS1, 0) + ISNULL(pa12.WJXBFS1, 0))  WJXBFS1,&#xA;&#x9;&#x9;pa13.WJXBFS1  WJXBFS2&#xA;&#x9;into TMP#T1&#xA;&#x9;from&#x9;TMP#CA1&#x9;pa11&#xA;&#x9;&#x9;full outer join&#x9;TMP#CI1&#x9;pa12&#xA;&#x9;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;&#x9;&#x9;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;&#x9;pa11.id_producto = pa12.id_producto and &#xA;&#x9;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#x9;&#x9;full outer join&#x9;TMP#R1&#x9;pa13&#xA;&#x9;&#x9;  on &#x9;(coalesce(pa11.ID_Periodo, pa12.ID_Periodo) = pa13.ID_Periodo and &#xA;&#x9;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley) = pa13.Id_SubRubro_Ley and &#xA;&#x9;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial) = pa13.Id_Zona_Comercial and&#xA;&#x9;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor) = pa13.id_supervisor and&#xA;&#x9;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto) = pa13.id_plan_producto and&#xA;&#x9;&#x9;coalesce(pa11.id_producto, pa12.id_producto) = pa13.id_producto and &#xA;&#x9;&#x9;coalesce(pa11.id_persona, pa12.id_persona) = pa13.id_persona)&#xA;&#x9;&#xA;&#xA;&#xA;&#x9;/* insertamos los datos en auxiliar */&#xA;&#x9;INSERT INTO AUX_H_COSTO_ALTAS (id_anual_costo&#xA;&#x9;&#x9;&#x9;,[id_ultimo_periodo_costo]&#xA;&#x9;&#x9;&#x9;,[id_periodo]&#xA;&#x9;&#x9;&#x9;,[id_periodo_desgloce]&#xA;&#x9;&#x9;&#x9;,[id_persona]&#xA;&#x9;&#x9;&#x9;,[Id_Zona_Comercial]&#xA;&#x9;&#x9;&#x9;,[Id_SubRubro_Ley]&#xA;&#x9;&#x9;&#x9;,[id_supervisor]&#xA;&#x9;&#x9;&#x9;,[id_producto]&#xA;&#x9;&#x9;&#x9;,[id_plan_producto]&#xA;&#x9;&#x9;&#x9;,[Cant_Altas_Reales]&#xA;&#x9;&#x9;&#x9;,[Consumo]&#xA;&#x9;&#x9;&#x9;,[Recaudacion])&#xA;&#x9;select&#x9;distinct @PeriodoCosto,&#xA;&#x9;&#x9;0 as [id_ultimo_periodo_costo],&#xA;&#x9;&#x9;@PeriodoCosto as id_periodo,&#xA;&#x9;&#x9;coalesce(pa11.ID_Periodo, pa12.ID_Periodo)  ID_Periodo,&#xA;&#x9;&#x9;coalesce(pa11.id_persona, pa12.id_persona)  id_persona,&#xA;&#x9;&#x9;coalesce(pa11.Id_Zona_Comercial, pa12.Id_Zona_Comercial)  Id_Zona_Comercial,&#xA;&#x9;&#x9;coalesce(pa11.Id_SubRubro_Ley, pa12.Id_SubRubro_Ley)  Id_SubRubro_Ley,&#xA;&#x9;&#x9;coalesce(pa11.id_supervisor, pa12.id_supervisor)  id_supervisor,&#xA;&#x9;&#x9;coalesce(pa11.id_producto, pa12.id_producto)  id_producto,&#xA;&#x9;&#x9;coalesce(pa11.id_plan_producto, pa12.id_plan_producto)  id_plan_producto,&#xA;&#x9;&#x9;IsNull(pa11.WJXBFS1,0)  Cant_Altas_Reales,&#xA;&#x9;&#x9;IsNull(pa12.WJXBFS1,0)  Consumo,&#xA;&#x9;&#x9;IsNull(pa12.WJXBFS2,0)  Recaudacion&#xA;&#x9;from&#x9;TMP#A1&#x9;pa11&#xA;&#x9;&#x9;full outer join&#x9;TMP#T1&#x9;pa12&#xA;&#x9;&#x9;  on &#x9;(pa11.ID_Periodo = pa12.ID_Periodo and &#xA;&#x9;&#x9;pa11.Id_SubRubro_Ley = pa12.Id_SubRubro_Ley and &#xA;&#x9;&#x9;pa11.Id_Zona_Comercial = pa12.Id_Zona_Comercial and&#xA;&#x9;pa11.id_supervisor = pa12.id_supervisor and &#xA;&#x9;pa11.id_plan_producto = pa12.id_plan_producto and&#xA;&#x9;pa11.id_producto = pa12.id_producto and&#xA;&#x9;pa11.id_persona = pa12.id_persona)&#xA;&#xA;&#xA;&#x9;DROP TABLE TMP#A1&#xA;&#x9;DROP TABLE TMP#Personas1&#xA;&#x9;DROP TABLE TMP#CA1&#xA;&#x9;DROP TABLE TMP#CI1&#xA;&#x9;DROP TABLE TMP#R1&#xA;&#x9;DROP TABLE TMP#T1&#xA;&#x9;&#xA;&#x9;/* avanzamos al siguiente periodo que se debe calcular  */&#xA;&#x9;set @PeriodoDesgloce = (select DW_SALUD.dbo.PeriodosPosteriores(@PeriodoDesgloce,2)) --se pone 2 como parametro xq internamente el proceso le resta 1, entonces en realidad avanza un solo periodo y no 2 como parece.&#xA;END&#xA;&#xA;/* insertamos en la tabla principal */&#xA;INSERT INTO H_COSTO_ALTAS (id_anual_costo&#xA;&#x9;&#x9;&#x9;,[id_ultimo_periodo_costo]&#xA;&#x9;&#x9;&#x9;,[id_periodo]&#xA;&#x9;&#x9;&#x9;,[id_periodo_desgloce]&#xA;&#x9;&#x9;&#x9;,[id_persona]&#xA;&#x9;&#x9;&#x9;,[Id_Zona_Comercial]&#xA;&#x9;&#x9;&#x9;,[Id_SubRubro_Ley]&#xA;&#x9;&#x9;&#x9;,[id_supervisor]&#xA;&#x9;&#x9;&#x9;,[id_producto]&#xA;&#x9;&#x9;&#x9;,[id_plan_producto]&#xA;&#x9;&#x9;&#x9;,[Cant_Altas_Reales]&#xA;&#x9;&#x9;&#x9;,[Consumo]&#xA;&#x9;&#x9;&#x9;,[Recaudacion] &#xA;&#x9;&#x9;&#x9;, [id_entidad]&#xA;&#x9;&#x9;&#x9;,[id_empresa_PE_alt12]&#xA;&#x9;&#x9;&#x9;,[id_tipo_entidad_PE_alt12]&#xA;&#x9;&#x9;&#x9;,[id_marca_PE_alt12]&#xA;&#x9;&#x9;&#x9;, [id_convenio_especial_alt12])&#xA;SELECT id_anual_costo&#xA;&#x9;&#x9;&#x9;,id_ultimo_periodo_costo&#xA;&#x9;&#x9;&#x9;,id_periodo&#xA;&#x9;&#x9;&#x9;,[id_periodo_desgloce]&#xA;&#x9;&#x9;&#x9;,[id_persona]&#xA;&#x9;&#x9;&#x9;,[Id_Zona_Comercial]&#xA;&#x9;&#x9;&#x9;,[Id_SubRubro_Ley]&#xA;&#x9;&#x9;&#x9;,[id_supervisor]&#xA;&#x9;&#x9;&#x9;,[id_producto]&#xA;&#x9;&#x9;&#x9;,[id_plan_producto]&#xA;&#x9;&#x9;&#x9;,[Cant_Altas_Reales]&#xA;&#x9;&#x9;&#x9;,[Consumo]&#xA;&#x9;&#x9;&#x9;,[Recaudacion] &#xA;&#x9;&#x9;&#x9;, 0 as id_entidad&#xA;&#x9;&#x9;&#x9;,NULL as [id_empresa_PE_alt12]&#xA;&#x9;&#x9;&#x9;,NULL as[id_tipo_entidad_PE_alt12]&#xA;&#x9;&#x9;&#x9;,NULL as[id_marca_PE_alt12]&#xA;&#x9;&#x9;&#x9;,NULL as [id_convenio_especial_alt12]&#xA;&#x9;&#x9;&#x9;FROM AUX_H_COSTO_ALTAS&#xA;&#xA;&#xA;&#xA;&#xA;UPDATE H_COSTO_ALTAS&#xA;SET id_promotor = A.id_promotor,&#xA;id_entidad = a.id_entidad&#xA;FROM H_ALTAS_GENUINAS A INNER JOIN H_COSTO_ALTAS H ON (A.id_persona=H.id_persona and a.id_periodo = h.id_periodo_desgloce)&#xA;WHERE H.id_anual_costo = @PeriodoCosto&#xA;&#xA;&#xA;update H_COSTO_ALTAS set id_ultimo_periodo_costo = 1 where id_anual_costo = @PeriodoCosto and id_periodo_desgloce in (select MAX(id_periodo_desgloce) from H_COSTO_ALTAS)&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Inserta Periodos en TRANS_PERIODO_CONSUMO"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{237d1aa1-7a87-4957-845b-3c934703d116}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Inserta Periodos en TRANS_PERIODO_CONSUMO"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="&#xA;-- declara periodos&#xA;declare @Periodo_Costo_Altas_12_Meses int&#xA;Select @Periodo_Costo_Altas_12_Meses = max(id_periodo) from H_ORD_AMB_DET&#xA;&#xA;-- Controla con el maximo periodo de ambulatorio.&#xA;If @Periodo_Costo_Altas_12_Meses = (Select max(id_periodo_consumo) from TRANS_PERIODO_CONSUMO)&#xA;DELETE FROM TRANS_PERIODO_CONSUMO WHERE id_periodo in (select id_periodo from TRANS_PERIODO_CONSUMO where id_periodo_consumo = @Periodo_Costo_Altas_12_Meses)&#xA;&#xA;&#xA;-- inserta periodos a procesar&#xA;DECLARE @Periodo INT SET @Periodo = (select MIN(id_periodo) from D_PERIODO where id_periodo in (Select top 13 H.id_periodo from D_PERIODO H where H.vigente_consumo=1 group by H.id_periodo order by H.id_periodo desc))&#xA;&#xA;INSERT INTO TRANS_PERIODO_CONSUMO&#xA;(id_periodo, id_periodo_consumo)&#xA;Select top 12 @Periodo as Id_Periodo, H.id_periodo as id_periodo_consumo&#xA;from D_PERIODO H where H.vigente_consumo=1 group by&#xA;H.id_periodo order by H.id_periodo desc" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Verifico Periodo a Actualizar"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{856e60ae-fb32-4253-99b5-5d3cea9dad66}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Verifico Periodo a Actualizar"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{8C331FA0-0ECE-49EF-8D49-C6696B5E1258}"
          SQLTask:SqlStatementSource="&#xA;/* Tomo el periodo a procesar igual al ultimo periodo de consumos. Para ello, si entre ambulatorio&#xA; e internaciones no son iguales los periodos se termina el proceso. Si son iguales sigo &#xA; borrando el Costo de Altas 12 meses si ya esta cargado. */&#xA;&#xA;declare @Periodo_Consumos int&#xA;Select @Periodo_Consumos = max(id_periodo) from H_ORD_AMB_DET&#xA;&#xA;If @Periodo_Consumos &lt;&gt; (Select max(id_periodo) from H_ORD_INT_DET)&#xA;RAISERROR ('Diferentes Periodos de Consumos entre Internaciones y Ambulatorio - Proceso cancelado.', 16, 1)&#xA;&#xA;If @Periodo_Consumos &lt;&gt; (Select max(id_periodo) from D_PERIODO H where H.vigente_consumo = 1)&#xA;RAISERROR ('Periodo Proceso Actualización H_COSTO_ALTAS Incorrecto.', 16, 1)&#xA;&#xA;DELETE FROM H_COSTO_ALTAS WHERE id_anual_costo = @Periodo_Consumos&#xA;&#xA;&#xA;/* Borra temporales a utilizar en el proceso general si ya existen */&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#1') begin drop table TMP#1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#2') begin  drop table TMP#2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#3')begin  drop table TMP#3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#4') begin  drop table TMP#4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#5') begin  drop table TMP#5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#6') begin  drop table TMP#6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#7') begin drop table TMP#7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#8') begin  drop table TMP#8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#9')begin  drop table TMP#9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#10') begin  drop table TMP#10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#11') begin  drop table TMP#11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#12') begin  drop table TMP#12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A1') begin  drop table TMP#A1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A2') begin  drop table TMP#A2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A3') begin  drop table TMP#A3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A4') begin  drop table TMP#A4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A5') begin  drop table TMP#A5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A6') begin  drop table TMP#A6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A7') begin  drop table TMP#A7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A8') begin  drop table TMP#A8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A9') begin  drop table TMP#A9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A10') begin  drop table TMP#A10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A11') begin  drop table TMP#A11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#A12') begin  drop table TMP#A12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T1') begin  drop table TMP#T1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T2') begin  drop table TMP#T2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T3') begin  drop table TMP#T3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T4') begin  drop table TMP#T4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T5') begin  drop table TMP#T5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T6') begin  drop table TMP#T6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T7') begin  drop table TMP#T7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T8') begin  drop table TMP#T8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T9') begin  drop table TMP#T9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T10') begin  drop table TMP#T10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T11') begin  drop table TMP#T11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#T12') begin  drop table TMP#T12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA1') begin  drop table TMP#CA1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA2') begin  drop table TMP#CA2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA3') begin  drop table TMP#CA3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA4') begin  drop table TMP#CA4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA5') begin  drop table TMP#CA5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA6') begin  drop table TMP#CA6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA7') begin  drop table TMP#CA7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA8') begin  drop table TMP#CA8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA9') begin  drop table TMP#CA9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA10') begin  drop table TMP#CA10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA11') begin  drop table TMP#CA11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CA12') begin  drop table TMP#CA12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI1') begin  drop table TMP#CI1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI2') begin  drop table TMP#CI2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI3') begin  drop table TMP#CI3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI4') begin  drop table TMP#CI4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI5') begin  drop table TMP#CI5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI6') begin  drop table TMP#CI6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI7') begin  drop table TMP#CI7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI8') begin  drop table TMP#CI8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI9') begin  drop table TMP#CI9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI10') begin  drop table TMP#CI10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI11') begin  drop table TMP#CI11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#CI12') begin  drop table TMP#CI12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R1') begin  drop table TMP#R1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R2') begin  drop table TMP#R2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R3') begin  drop table TMP#R3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R4') begin  drop table TMP#R4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R5') begin  drop table TMP#R5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R6') begin  drop table TMP#R6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R7') begin  drop table TMP#R7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R8') begin  drop table TMP#R8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R9') begin  drop table TMP#R9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R10') begin  drop table TMP#R10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R11') begin  drop table TMP#R11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#R12') begin  drop table TMP#R12 end&#xA;&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas1') begin  drop table TMP#Personas1 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas2') begin  drop table TMP#Personas2 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas3') begin  drop table TMP#Personas3 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas4') begin  drop table TMP#Personas4 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas5') begin  drop table TMP#Personas5 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas6') begin  drop table TMP#Personas6 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas7') begin  drop table TMP#Personas7 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas8') begin  drop table TMP#Personas8 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas9') begin  drop table TMP#Personas9 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas10') begin  drop table TMP#Personas10 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas11') begin  drop table TMP#Personas11 end&#xA;if exists (SELECT * FROM sysobjects WHERE name = 'TMP#Personas12') begin  drop table TMP#Personas12 end" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{810C23A9-5E35-406E-92AF-523046F0D430}"
      DTS:From="Package\Inserta Periodos en TRANS_PERIODO_CONSUMO"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Verifico Periodo a Actualizar" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{CDD15B65-A9B6-4B4A-9CAA-1A4623F745BA}"
      DTS:From="Package\Verifico Periodo a Actualizar"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Calculo del Costo" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{C9D79842-29B0-4871-AAF9-C4EE980CCBA5}"
      DTS:From="Package\Calculo del Costo"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Actualiza Campos de PE en la tabla H_COSTO_ALTAS" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="351,42"
          Id="Package\Actualiza Campos de PE en la tabla H_COSTO_ALTAS"
          TopLeft="3.9528301886792,274.990566037736" />
        <NodeLayout
          Size="165,42"
          Id="Package\Calculo del Costo"
          TopLeft="96.9528301886792,185.827044025157" />
        <NodeLayout
          Size="335,42"
          Id="Package\Inserta Periodos en TRANS_PERIODO_CONSUMO"
          TopLeft="11.9528301886792,5.5" />
        <NodeLayout
          Size="217,42"
          Id="Package\Verifico Periodo a Actualizar"
          TopLeft="70.9528301886792,95.6635220125787" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="179.452830188679,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,48.1635220125787"
              Start="0,0"
              End="0,40.6635220125787">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,40.6635220125787" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="179.452830188679,137.663522012579">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,48.1635220125787"
              Start="0,0"
              End="0,40.6635220125787">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,40.6635220125787" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="179.452830188679,227.827044025157">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,47.1635220125787"
              Start="0,0"
              End="0,39.6635220125787">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,39.6635220125787" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>