<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="3/25/2019 11:14:17 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="DES3070"
  DTS:CreatorName="AMS\mpaludi"
  DTS:DTSID="{08CBE61D-47A5-4299-8C43-958DA02C52F2}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="3082"
  DTS:ObjectName="Inversiones H_INVERSIONES"
  DTS:PackageType="5"
  DTS:VersionBuild="207"
  DTS:VersionGUID="{A9781292-891F-44A1-971C-F7F611557E54}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[File_Archivo Planif Financiera_Destination_Path]"
      DTS:CreationName="FILE"
      DTS:DTSID="{2CE01C72-FC3D-4B68-864B-908754BCEA79}"
      DTS:ObjectName="File_Archivo Planif Financiera_Destination_Path">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:FileUsageType="2"
          DTS:ConnectionString="\\P-IS-01\SSIS2017$\03 - Archivos\Inversiones" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[File_Archivo Planif Financiera_Historico_Path]"
      DTS:CreationName="FILE"
      DTS:DTSID="{31EE885E-1B8E-40CF-AC5A-B62048E9393A}"
      DTS:ObjectName="File_Archivo Planif Financiera_Historico_Path">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:FileUsageType="2"
          DTS:ConnectionString="\\P-IS-01\SSIS2017$\03 - Archivos\Inversiones\Historico" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[File_Archivo Planif Financiera_Historico_Source]"
      DTS:CreationName="FILE"
      DTS:DTSID="{E57C0FE8-854B-4BD2-9BD0-7B7C00AEDE5C}"
      DTS:ObjectName="File_Archivo Planif Financiera_Historico_Source">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="\\P-IS-01\SSIS2017$\03 - Archivos\Inversiones\Archivo Planif Financiera.xlsx" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[File_Archivo Planif Financiera_Source_Path]"
      DTS:CreationName="FILE"
      DTS:DTSID="{3DC1BA31-244E-4219-BCC5-AFF6416D6D1C}"
      DTS:ObjectName="File_Archivo Planif Financiera_Source_Path">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="\\ams12\procesoplanillasestadisticas$\Planificacion Financiera (Inversiones)\Archivo Planif Financiera.xlsx" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[File_XLS_Archivo Planif Financiera]"
      DTS:CreationName="EXCEL"
      DTS:DTSID="{AA27905C-4BC6-4988-BE23-535471202086}"
      DTS:ObjectName="File_XLS_Archivo Planif Financiera">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\\P-IS-01\SSIS2017$\03 - Archivos\Inversiones\Archivo Planif Financiera.xlsx;Extended Properties=&quot;EXCEL 12.0 XML;HDR=YES&quot;;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{D5A17238-DB56-4E5A-9F80-ED5A64524F60}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{BA5C921D-5BCF-42C2-B272-A47D25666586}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Variable">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{D5A17238-DB56-4E5A-9F80-ED5A64524F60}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Actualiza Aux"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{DF37F69E-B824-43D4-96D9-5BF7A1D18B58}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza Aux"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="&#xA;-- Quita los separadores por miles&#xA;update aux_h_inversiones&#xA;set cantidad_total = REPLACE(cantidad_total, '.', '')&#xA;--Cambia las &quot;,&quot; por &quot;.&quot;&#xA;update aux_h_inversiones&#xA;set cantidad_total = REPLACE(cantidad_total, ',', '.')&#xA;update aux_h_inversiones&#xA;set cantidad_total = REPLACE(cantidad_total, '-', '0')&#xA;update aux_h_inversiones&#xA;set imp_unitario= REPLACE(imp_unitario,'-', '0') &#xA;&#xA;update aux_h_inversiones&#xA;set imp_renta_dolar = REPLACE( imp_renta_dolar, '.', '')&#xA;--Cambia las &quot;,&quot; por &quot;.&quot;&#xA;update aux_h_inversiones&#xA;set imp_renta_dolar = REPLACE( imp_renta_dolar, ',', '.')&#xA;update aux_h_inversiones&#xA;set imp_renta_dolar = REPLACE( imp_renta_dolar , '-', '0')&#xA;&#xA;&#xA;update aux_h_inversiones&#xA;set imp_renta_pesos = REPLACE( imp_renta_pesos, '.', '')&#xA;--Cambia las &quot;,&quot; por &quot;.&quot;&#xA;update aux_h_inversiones&#xA;set imp_renta_pesos = REPLACE( imp_renta_pesos, ',', '.')&#xA;update aux_h_inversiones&#xA;set imp_renta_pesos = REPLACE( imp_renta_pesos, '-', '0')&#xA;&#xA;&#xA;update AUX_H_BALANCE_INVERSIONES&#xA;set id_periodo = dbo.DevuelvePeriodo(fecha_balance)&#xA;&#xA;update AUX_H_BALANCE_INVERSIONES&#xA;set importe_balance= REPLACE(importe_balance,',', '.')" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualiza H_INVERSIONES"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{3e84b542-cfbd-4337-97cb-f6cdcd2d006e}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza H_INVERSIONES"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="&#xA;&#xA;-- Para los intrumentos no liquidos no calcula tna &#xA;-- Para aquellos insrumentos que no tienen importe le pone 0 en los tna&#xA;update h_inversiones&#xA;set tna_mensual = 0,&#xA;&#x9;tna_anual = 0,&#xA;&#x9;tna_mensual_dolar = 0 ,&#xA;&#x9;tna_anual_dolar = 0,&#xA;&#x9;[tna_mensual_moneda_origen] = 0,&#xA;&#x9;[tna_anual_moneda_origen] = 0&#xA;&#x9;where id_tipo_liquidez_inversion &lt;&gt; 1 or imp_unitario_inversion = 0&#xA;&#xA;&#xA;-- Calcula la ponderacion&#xA;update H_INVERSIONES&#xA;set pond_mensual_inversion = (cant_total_inversion * imp_unitario_inversion) * tna_mensual,&#xA;&#x9;pond_anual_inversion = (cant_total_inversion * imp_unitario_inversion) * tna_anual,&#xA;&#x9;pond_mensual_dolar_inversion = (cant_total_inversion * imp_unitario_inversion_dolar) * tna_mensual_dolar,&#xA;&#x9;pond_anual_dolar_inversion = (cant_total_inversion * imp_unitario_inversion_dolar ) * tna_anual_dolar,&#xA;&#x9;[pond_mensual_moneda_origen_inversion] = (cant_total_inversion * [imp_unitario_inversion_moneda_origen]) * [tna_mensual_moneda_origen],&#xA;&#x9;[pond_anual_moneda_origen_inversion] = (cant_total_inversion * [imp_unitario_inversion_moneda_origen]) * [tna_anual_moneda_origen]&#xA;from H_INVERSIONES&#xA;&#xA;-- Calcula el importe unitario con el que se cerro el mes anterior &#xA;select id_periodo, fecha_cotizacion_inversiones, id_rubro_inversion,id_instrumento_inversion,id_compania_inversion, id_administrador_inversion,max(imp_unitario_inversion)as imp_unitario_inversion ,max(cant_total_inversion) as cant_total_inversion, max(imp_unitario_inversion_dolar) as imp_unitario_inversion_dolar&#xA;into #temp_ultimo_dia from H_INVERSIONES where id_marca_ultimo_dia_mes = 1 &#xA;group by id_periodo, fecha_cotizacion_inversiones, id_rubro_inversion,id_instrumento_inversion,id_compania_inversion,id_administrador_inversion&#xA;&#xA;--pega el importe unitario del ultimo dia del mes anterior, SE UTILIZA PARA CALCULAR EL RENDIMIENTO NOMINAL Y EL RENDIMIENTO PORCENTUAL&#xA;--si no tiene el mes anterior se busca el valor de la fecha minima que si tenga valor&#xA;update h_inversiones &#xA;set imp_unitario_cierre_mes_anterior_inversion =  t.imp_unitario_inversion,&#xA;&#x9;cant_total_inversion_mes_anterior_inversion = t.cant_total_inversion,&#xA;&#x9;imp_unitario_cierre_mes_anterior_inversion_dolar = t.imp_unitario_inversion_dolar&#xA;from h_inversiones h inner join #temp_ultimo_dia t on dbo.PeriodosAnteriores(h.id_periodo,2) = t.id_periodo and h.id_rubro_inversion = t.id_rubro_inversion&#xA;and t.id_instrumento_inversion = h.id_instrumento_inversion and h.id_compania_inversion = t.id_compania_inversion&#xA;&#x9;and t.id_administrador_inversion = h.id_administrador_inversion&#xA;&#xA;-- Calcula la minima fecha que empezo eso instrumento &#xA;select id_periodo,  id_rubro_inversion,&#xA;id_instrumento_inversion,id_compania_inversion, id_administrador_inversion,min(fecha_cotizacion_inversiones) fecha_minima&#xA;,0 as cantidad , cast(0.0 as float) as importe , cast(0.0 as float) as importe_dolares&#xA;into #temp_ultimo_dia_p2&#xA;from h_inversiones &#xA;where imp_unitario_cierre_mes_anterior_inversion = 0 and imp_unitario_inversion &lt;&gt; 0&#xA;group by id_periodo,  id_rubro_inversion,id_instrumento_inversion,id_compania_inversion,id_administrador_inversion&#xA;--- Le pega el importe de la fecha que empezo&#xA;update #temp_ultimo_dia_p2&#xA;set importe = h.imp_unitario_inversion,&#xA;&#x9;importe_dolares = imp_unitario_inversion_dolar,&#xA;&#x9;cantidad = h.cant_total_inversion&#xA;from #temp_ultimo_dia_p2 t inner join h_inversiones h on  h.fecha_cotizacion_inversiones = t.fecha_minima and h.id_rubro_inversion = t.id_rubro_inversion&#xA;and t.id_instrumento_inversion = h.id_instrumento_inversion and h.id_compania_inversion = t.id_compania_inversion and h.id_administrador_inversion = t.id_administrador_inversion&#xA;&#xA;&#xA;&#xA;&#xA;-- pasa el importe y cantidad del mes anterior a la tabla&#xA;update h_inversiones &#xA;set imp_unitario_cierre_mes_anterior_inversion =  t.importe,&#xA;&#x9;imp_unitario_cierre_mes_anterior_inversion_dolar = t.importe_dolares,&#xA;&#x9;cant_total_inversion_mes_anterior_inversion = t.cantidad&#xA;from h_inversiones h inner join #temp_ultimo_dia_p2 t on  h.id_rubro_inversion = t.id_rubro_inversion&#xA;and t.id_instrumento_inversion = h.id_instrumento_inversion and h.id_compania_inversion = t.id_compania_inversion &#xA;and h.id_administrador_inversion = t.id_administrador_inversion and h.id_periodo = t.id_periodo&#xA;where imp_unitario_cierre_mes_anterior_inversion = 0 and imp_unitario_inversion &lt;&gt; 0&#x9;&#xA;&#xA;&#xA;&#xA;-- Busco el dia anterior (si no es el consecutivo busca el maximo valor anterior)&#xA;select fecha_cotizacion_inversiones,id_rubro_inversion,id_instrumento_inversion,id_compania_inversion,id_administrador_inversion,fecha_cotizacion_inversiones as fecha_cotizacion_inversiones_anterior&#xA;&#x9;into #temp_cotizaciones_anteriores from h_inversiones&#xA;-- GUARDO LA MAXIMA FECHA ANTERIOR ACADA FECHA PARA CADA CLAVE&#xA;select t.id_rubro_inversion,t.id_instrumento_inversion,t.id_compania_inversion,t.fecha_cotizacion_inversiones,t.id_administrador_inversion, max(t1.fecha_cotizacion_inversiones)  as fecha_anterior&#xA;into #temp_cotizacion_anteriores_max_fecha&#xA;from #temp_cotizaciones_anteriores t inner join #temp_cotizaciones_anteriores t1 on &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;t.id_rubro_inversion = t1.id_rubro_inversion&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and t.id_instrumento_inversion = t1.id_instrumento_inversion &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and t.id_compania_inversion = t1.id_compania_inversion&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and t.id_administrador_inversion = t1.id_administrador_inversion&#xA;&#x9;where t1.fecha_cotizacion_inversiones &lt; t.fecha_cotizacion_inversiones&#xA;&#x9;group by t.id_rubro_inversion,t.id_instrumento_inversion,t.id_compania_inversion,t.fecha_cotizacion_inversiones,t.id_administrador_inversion&#xA;&#xA;&#xA;&#xA;-- Setea el valor de importe unitario anterior&#xA;update h&#xA;set imp_cotizacion_dia_anterior_inversion = ha.imp_unitario_inversion,&#xA;&#x9;imp_cotizacion_dia_anterior_inversion_dolar = ha.imp_unitario_inversion_dolar,&#xA;variacion_cantidad_inversiones =  h.cant_total_inversion-ha.cant_total_inversion&#xA; from h_inversiones h &#xA;inner join #temp_cotizacion_anteriores_max_fecha t on h.id_rubro_inversion = t.id_rubro_inversion&#xA;&#x9;&#x9;and t.id_instrumento_inversion = h.id_instrumento_inversion and h.id_compania_inversion = t.id_compania_inversion and &#xA;&#x9;&#x9;t.id_administrador_inversion = h.id_administrador_inversion&#xA;&#x9;&#x9;and t.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones&#xA;&#x9;inner join h_inversiones ha on ha.fecha_cotizacion_inversiones = t.fecha_anterior and &#xA;&#x9;&#x9;h.id_rubro_inversion = ha.id_rubro_inversion and &#x9;ha.id_administrador_inversion = h.id_administrador_inversion&#xA;&#x9;&#x9;and ha.id_instrumento_inversion = h.id_instrumento_inversion and h.id_compania_inversion = ha.id_compania_inversion&#xA;&#x9;where ha.cant_total_inversion &lt;&gt;0&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- Copia la marca a los demas instrumentos &#xA;update h&#xA;set id_marca_cotizacion_anterior_inversion = ha.id_marca_cotizacion_anterior_inversion&#xA;from H_INVERSIONES h inner join H_INVERSIONES ha on h.id_rubro_inversion = ha.id_rubro_inversion and h.id_instrumento_inversion = ha.id_instrumento_inversion&#xA;and h.id_compania_inversion = ha.id_compania_inversion and h.id_administrador_inversion = ha.id_administrador_inversion&#xA;where ha.fecha_cotizacion_inversiones = '2019-04-25 00:00:00.000'&#xA;&#xA;update H_INVERSIONES&#xA;set id_marca_cotizacion_anterior_inversion = 1&#xA;where id_instrumento_inversion = 30&#xA;&#xA;-- dEPENDIENDO CADA ADMINISTRADOR TOMA LA COTIZACION DEL DIA O LA DEL DIA ANTERIOR &#xA;-- EN LA MARCA 1 TOMO LA VARIACION (LA DIFERENCIA DE CANTIDADES POR EL IMPORTE DEL DIA)&#xA;-- EN LA MARCA 2 TOMO LA VARIACION * EL COSTO DEL DIA ANTERIOR&#xA;-- EN LA MARCA 3 DEPENDE SI ES RESCATE (DIA ANTERIOR) O SI ES SUSCRIPCION (DIA)&#xA;update h_inversiones&#xA;set variacion_importe_total_inversiones =case when id_marca_cotizacion_anterior_inversion = 1 then  variacion_cantidad_inversiones * imp_unitario_inversion &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when &#x9;&#x9;id_marca_cotizacion_anterior_inversion = 2 then variacion_cantidad_inversiones * imp_cotizacion_dia_anterior_inversion&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when &#x9;&#x9;id_marca_cotizacion_anterior_inversion =  3 and &#x9;variacion_cantidad_inversiones &gt; 0 then variacion_cantidad_inversiones * imp_unitario_inversion &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when &#x9;&#x9;id_marca_cotizacion_anterior_inversion =  3 and &#x9;variacion_cantidad_inversiones &lt; 0 then variacion_cantidad_inversiones * imp_cotizacion_dia_anterior_inversion&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   end,&#xA;&#x9;variacion_importe_total_inversiones_dolar = case when id_marca_cotizacion_anterior_inversion = 1 then  variacion_cantidad_inversiones * imp_unitario_inversion_dolar &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when &#x9;&#x9;id_marca_cotizacion_anterior_inversion = 2 then variacion_cantidad_inversiones * imp_cotizacion_dia_anterior_inversion_dolar&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when &#x9;&#x9;id_marca_cotizacion_anterior_inversion =  3 and &#x9;variacion_cantidad_inversiones &gt; 0 then variacion_cantidad_inversiones * imp_unitario_inversion_dolar &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when &#x9;&#x9;id_marca_cotizacion_anterior_inversion =  3 and &#x9;variacion_cantidad_inversiones &lt; 0 then variacion_cantidad_inversiones * imp_cotizacion_dia_anterior_inversion_dolar&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   end&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; -- where id_moneda_cotizacion_inversion = 2&#xA;/*&#xA;update h_inversiones&#xA;set variacion_importe_total_inversiones =&#x9;variacion_cantidad_inversiones &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;where id_moneda_cotizacion_inversion = 1*/&#xA;&#xA;&#xA;-- Una vez calculado la variacion con el importe correspondiente acumulo para cada fecha todos las variaciones de importe de ese mes hasta ese dia (inclusive)&#xA;select h.id_periodo,h.fecha_cotizacion_inversiones,h.id_rubro_inversion,h.id_administrador_inversion,h.id_compania_inversion,&#xA;h.id_instrumento_inversion,&#xA;sum(ha.variacion_importe_total_inversiones) total_variacion_acumulado_inversiones,sum(ha.variacion_importe_total_inversiones_dolar) total_variacion_acumulado_inversiones_dolar&#xA;into #temp_variaciones&#xA;from h_inversiones h inner join  h_inversiones ha on ha.fecha_cotizacion_inversiones &lt;= h.fecha_cotizacion_inversiones&#xA;&#x9;&#x9;&#x9;&#x9;&#x9; and ha.id_periodo = h.id_periodo and h.id_rubro_inversion = ha.id_rubro_inversion and &#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9; ha.id_administrador_inversion = h.id_administrador_inversion&#xA;&#x9;&#x9;&#x9;&#x9;&#x9; and ha.id_instrumento_inversion = h.id_instrumento_inversion and h.id_compania_inversion = ha.id_compania_inversion&#xA;group by h.id_periodo,h.fecha_cotizacion_inversiones,h.id_rubro_inversion,h.id_administrador_inversion,h.id_compania_inversion,&#xA;h.id_instrumento_inversion&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- Pego este acumulado para cada fecha y clave para luego realizar la formula del rendimiento nominal&#xA;update H_INVERSIONES&#xA;set total_variacion_acumulado_inversiones = ha.total_variacion_acumulado_inversiones,&#xA; total_variacion_acumulado_inversiones_dolar = ha.total_variacion_acumulado_inversiones_dolar&#xA;from H_INVERSIONES h inner join #temp_variaciones ha on  ha.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones&#xA;&#x9;&#x9;&#x9;&#x9;&#x9; and ha.id_periodo = h.id_periodo and h.id_rubro_inversion = ha.id_rubro_inversion and &#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9; ha.id_administrador_inversion = h.id_administrador_inversion&#xA;&#x9;&#x9;&#x9;&#x9;&#x9; and ha.id_instrumento_inversion = h.id_instrumento_inversion and h.id_compania_inversion = ha.id_compania_inversion&#xA;&#xA;&#xA;&#xA;&#xA;-- CUANDO HAY UN RESCATE SE TOMA LA FECHA MINIMA POSTERIOR A ESTE PARA CALCULAR EL IMPORTE DEL MES ANTERIOR PARA HACER EL RENDIMIENTO NOMINAL LUEGO&#xA;&#x9;-- EL PRIMER PASO ES CREAR UNA TABLA POR CADA VEZ QUE SE HIZO UN RESCATE DURANTE EL MES Y EL MES ANTERIOR TENIA VALORES&#xA;select h.id_periodo, id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion,h.id_compania_inversion,&#xA;h1.fecha_cotizacion_inversiones,h1.total_variacion_acumulado_inversiones,&#xA;--El row number se hace para numerar cada rescate en el mes&#xA;ROW_NUMBER () OVER ( PARTITION BY h.id_periodo, id_rubro_inversion, h.id_instrumento_inversion,h.id_compania_inversion order by h1.fecha_cotizacion_inversiones ) as numero_rescate,&#xA; h1.fecha_cotizacion_inversiones as fecha_siguiente_rescate, cast(0 as float) as imp_unitario_inversion, cast(0 as float) as cantidad, cast(0 as float) as imp_unitario_inversion_dolar&#xA; into #temp_Rescates&#xA;from h_inversiones H &#xA;&#x9;inner join (select id_periodo,fecha_cotizacion_inversiones,id_instrumento_inversion,id_compania_inversion,id_administrador_inversion,total_variacion_acumulado_inversiones  &#xA;&#x9;&#x9;&#x9;&#x9;from h_inversiones &#xA;&#x9;&#x9;&#x9;&#x9;where cant_total_inversion = 0 and imp_cotizacion_dia_anterior_inversion &lt;&gt; 0 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and imp_unitario_cierre_mes_anterior_inversion &lt;&gt; 0 ) H1 &#xA;&#x9;on h.id_periodo = h1.id_periodo and h.id_instrumento_inversion = h1.id_instrumento_inversion &#xA;&#x9;&#x9;and h.id_compania_inversion = h1.id_compania_inversion and h.id_administrador_inversion = h1.id_administrador_inversion&#xA;where h.fecha_cotizacion_inversiones &gt; H1.fecha_cotizacion_inversiones AND h.cant_total_inversion &lt;&gt; 0   &#xA;group by h.id_periodo, id_rubro_inversion, h.id_instrumento_inversion,h.id_compania_inversion,h1.fecha_cotizacion_inversiones,h1.total_variacion_acumulado_inversiones ,h.id_administrador_inversion&#xA;order by h.id_instrumento_inversion,h.id_periodo&#xA;&#xA;-- Como segundo paso se calcula si en el mismo periodo hay mas de un rescate &#xA;update t&#xA;set fecha_siguiente_rescate = t1.fecha_cotizacion_inversiones &#xA;from #temp_Rescates t inner join #temp_Rescates t1 &#xA;&#x9;on t.id_periodo = t1.id_periodo and t.id_instrumento_inversion = t1.id_instrumento_inversion &#xA;&#x9;and t.id_compania_inversion = t1.id_compania_inversion &#xA;&#x9;and t.numero_rescate + 1 = t1.numero_rescate&#xA;&#xA;update #temp_Rescates&#xA;set fecha_siguiente_rescate = d.maxima_fecha&#xA;from #temp_Rescates t inner join (select id_periodo, max (id_fecha) as maxima_fecha from d_fecha group by id_periodo ) d &#xA;&#x9;on t.id_periodo = d.id_periodo &#xA;where fecha_siguiente_rescate = fecha_cotizacion_inversiones&#xA;&#xA;-- SE COLOCA EL IMPORTE DEL DIA MINIMO POSTERIOR QUE TENGA VALOR AL DIA DEL RESCATE &#xA;&#x9;update #temp_Rescates &#xA;set imp_unitario_inversion = h.imp_unitario_inversion ,&#xA;&#x9;cantidad = h.cant_total_inversion,&#xA;&#x9;imp_unitario_inversion_dolar = h.imp_unitario_inversion_dolar&#xA;&#x9;FROM H_inversiones h inner join &#xA;&#x9;&#x9;#temp_Rescates t on h.id_periodo = t.id_periodo and h.id_instrumento_inversion = t.id_instrumento_inversion &#xA;&#x9;&#x9;and h.id_compania_inversion = t.id_compania_inversion and h.id_administrador_inversion = t.id_administrador_inversion&#xA;&#x9;where h.fecha_cotizacion_inversiones = (select min(h1.fecha_cotizacion_inversiones) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from H_inversiones h1 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where h1.fecha_cotizacion_inversiones &gt; t.fecha_cotizacion_inversiones and h1.cant_total_inversion &lt;&gt; 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and  h.id_periodo = h1.id_periodo and h.id_instrumento_inversion = h1.id_instrumento_inversion &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and h.id_compania_inversion = h1.id_compania_inversion and h.id_administrador_inversion = h1.id_administrador_inversion)&#x9;&#x9;&#xA;&#xA;&#xA;update h_inversiones&#xA;set imp_unitario_cierre_mes_anterior_inversion =  t.imp_unitario_inversion,&#xA;&#x9;imp_unitario_cierre_mes_anterior_inversion_dolar = t.imp_unitario_inversion_dolar,&#xA;&#x9;cant_total_inversion_mes_anterior_inversion = t.cantidad&#xA;from h_inversiones h inner join #temp_Rescates t&#xA;&#x9;on h.id_periodo = t.id_periodo and h.id_instrumento_inversion = t.id_instrumento_inversion &#xA;&#x9;&#x9;and h.id_compania_inversion = t.id_compania_inversion and h.id_administrador_inversion = t.id_administrador_inversion&#xA;&#x9;&#x9;and h.fecha_cotizacion_inversiones &gt; t.fecha_cotizacion_inversiones and h.fecha_cotizacion_inversiones &lt;= t.fecha_siguiente_rescate&#xA;&#xA;&#xA;update H_INVERSIONES&#xA;set total_variacion_acumulado_inversiones = tv.total_variacion_acumulado_inversiones + tr.total_variacion_acumulado_inversiones * -1,&#xA;&#x9;total_variacion_acumulado_inversiones_dolar = tv.total_variacion_acumulado_inversiones_dolar + tr.total_variacion_acumulado_inversiones * -1&#xA;from H_INVERSIONES tv inner join #temp_Rescates tr &#xA;&#x9;on tv.id_periodo = tr.id_periodo and tv.id_instrumento_inversion = tr.id_instrumento_inversion &#xA;&#x9;&#x9;and tv.id_compania_inversion = tr.id_compania_inversion and tv.id_administrador_inversion = tr.id_administrador_inversion&#xA;&#x9;&#x9;and tv.fecha_cotizacion_inversiones &gt; tr.fecha_cotizacion_inversiones and tv.fecha_cotizacion_inversiones &lt;= tr.fecha_siguiente_rescate&#xA;&#xA;&#xA;&#xA;-- Calcula el rendimiento nominal&#xA;update H_INVERSIONES&#xA;set rendimiento_nominal_inversion =isnull(&#xA;((imp_unitario_inversion*cant_total_inversion) - (imp_unitario_cierre_mes_anterior_inversion * cant_total_inversion_mes_anterior_inversion))&#xA; - total_variacion_acumulado_inversiones,0), &#xA;&#x9;rendimiento_nominal_dolar_inversion = isnull(&#xA;((imp_unitario_inversion_dolar*cant_total_inversion) - (imp_unitario_cierre_mes_anterior_inversion_dolar * cant_total_inversion_mes_anterior_inversion))&#xA; - total_variacion_acumulado_inversiones_dolar,0)&#xA;&#xA;&#xA;update H_INVERSIONES&#xA;set rendimiento_nominal_dolar_inversion = 0,&#xA;&#x9;rendimiento_nominal_inversion = 0&#xA;&#x9;where cant_total_inversion = 0 and id_tipo_liquidez_inversion = 1&#xA;&#xA;&#xA;&#x9;-- Se busca las claves qeu tienen cantidad 0&#xA;select id_periodo, fecha_cotizacion_inversiones, id_rubro_inversion,id_instrumento_inversion,id_compania_inversion,id_administrador_inversion&#xA; into #temp_nominal_0 from h_inversiones  where cant_total_inversion = 0&#xA;&#xA; -- Se calcula el rendimiento para las claves qeu tienen cantidad 0&#xA;select t.id_periodo, t.fecha_cotizacion_inversiones, t.id_rubro_inversion,t.id_instrumento_inversion,t.id_compania_inversion,t.id_administrador_inversion,&#xA;max(h.fecha_cotizacion_inversiones)  as fecha_maxima, cast (0 as decimal(18, 6)) as rendimiento_pesos,cast (0 as decimal(18, 6)) as rendimiento_dolar&#xA;into #temp_nominal_no0&#xA;from #temp_nominal_0 T inner join h_inversiones h &#xA;on t.id_periodo = h.id_periodo and t.id_rubro_inversion = h.id_rubro_inversion and h.id_compania_inversion = t.id_compania_inversion and &#xA;h.id_administrador_inversion = t.id_administrador_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion&#xA;where h.cant_total_inversion &lt;&gt; 0 and h.fecha_cotizacion_inversiones &lt; t.fecha_cotizacion_inversiones&#xA;group by t.id_periodo, t.fecha_cotizacion_inversiones, t.id_rubro_inversion,t.id_instrumento_inversion,t.id_compania_inversion,t.id_administrador_inversion&#xA;&#xA;&#xA;update #temp_nominal_no0&#xA;set rendimiento_pesos =rendimiento_nominal_inversion ,&#xA;&#x9;rendimiento_dolar = rendimiento_nominal_dolar_inversion &#xA;&#x9;from #temp_nominal_no0 t inner join h_inversiones h on t.fecha_maxima = h.fecha_cotizacion_inversiones &#xA;&#x9;and t.id_rubro_inversion = h.id_rubro_inversion and h.id_compania_inversion = t.id_compania_inversion and &#xA;h.id_administrador_inversion = t.id_administrador_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion&#xA;&#x9;&#xA;update H_INVERSIONES&#xA;set rendimiento_nominal_dolar_inversion = rendimiento_dolar  ,&#xA;&#x9;rendimiento_nominal_inversion = rendimiento_pesos &#xA;from H_INVERSIONES h inner join #temp_nominal_no0 t on t.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones &#xA;&#x9;and t.id_rubro_inversion = h.id_rubro_inversion and h.id_compania_inversion = t.id_compania_inversion and &#xA;h.id_administrador_inversion = t.id_administrador_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion&#xA;where cant_total_inversion = 0 and id_tipo_liquidez_inversion = 1&#xA;&#xA;&#xA;update H_INVERSIONES&#xA;set rendimiento_nominal_dolar_inversion = rendimiento_nominal_dolar_inversion + renta_dolar_inversiones ,&#xA;&#x9;rendimiento_nominal_inversion = rendimiento_nominal_inversion + renta_pesos_inversiones &#xA;where  id_tipo_liquidez_inversion = 1&#xA;&#xA;/*&#xA;drop table #temp_nominal_0&#xA; drop table #temp_nominal_no0&#xA; drop table #temp_cotizacion_anteriores_max_fecha&#xA; drop table #temp_variaciones&#xA;drop table #temp_ultimo_dia   &#xA;drop table #temp_valor_cuota_inicial&#xA;drop table #temp_ultimo_dia_p2&#xA;drop table #ultima_fecha&#xA;drop table #temp_calculo_tna_m&#xA;drop table #temp_cotizaciones_anteriores&#xA;--drop table #temp_calculo_tna_dolar&#xA;drop table #temp_calculo_tna_m_dolar&#xA;drop table #temp_calculo_tna_m_origen&#xA;drop table #temp_Rescates&#x9;&#xA; drop table #temp_valor_cuota_inicial_original&#xA; drop table &#x9;#fecha_año_anterior&#x9;&#x9;&#x9;&#xA;drop table #fecha_año_anterior_original */&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualiza tablas de Dimensión"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F55CF781-415B-4E8D-A6D6-7400807B353D}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza tablas de Dimensión"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="--ENVIO DE MAILS CUANDO LAS TABLAS DE DIMENSION SE VEN AFECTADAS&#xA;&#xA;select &#xA;(select max(id_rubro_inversion)&#xA;&#x9;from D_RUBRO_INVERSION) + ROW_NUMBER() over (order by rubro) as id, -- ID&#xA; rubro,&#x9; -- Rubro&#xA;'' as descripcion&#xA; into #temp_rubro&#xA; from AUX_H_INVERSIONES&#xA; where rubro&#xA; not in(select de_rubro_inversion from D_RUBRO_INVERSION)&#xA; group by rubro &#xA;&#xA;&#xA;&#xA;IF (select count(*) from #temp_rubro ) &gt;=1&#xA;begin &#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'matias.paludi@sancorsalud.com.ar, alejandra.quaglia@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Cambio en tabla de dimension  D_RUBRO_INVERSION del proyecto inversiones',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'Esisten rubros nuevos en la D_RUBRO_INVERSION',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;end&#xA;&#xA;&#xA; select &#xA;(select max(id_tipo_liquidez_inversion) &#xA;&#x9;from D_TIPO_LIQUIDEZ_INVERSION) + ROW_NUMBER() over (order by tipo_liquidez) as id, -- ID&#xA; tipo_liquidez&#x9; -- Tipo Liquidez Inversión&#xA; into #temp_liquidez&#xA; from AUX_H_INVERSIONES&#xA; where tipo_liquidez&#xA; not in(select de_tipo_liquidez_inversion from D_TIPO_LIQUIDEZ_INVERSION)&#xA; group by tipo_liquidez &#xA;&#xA; IF (select count(*) from #temp_liquidez ) &gt;=1&#xA;begin &#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'matias.paludi@sancorsalud.com.ar, alejandra.quaglia@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Cambio en tabla de dimension  D_TIPO_LIQUIDEZ_INVERSION del proyecto inversiones',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'Esisten tipos de liquidez nuevos en la D_TIPO_LIQUIDEZ_INVERSION',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;end&#xA;&#xA;&#xA;&#xA;-- Valida si se debe agregar nuevo regisro que exista en Aux y no en D_INSTRUMENTO_INVERSION&#xA; select &#xA;(select max(id_instrumento_inversion) &#xA;&#x9;from D_INSTRUMENTO_INVERSION) + ROW_NUMBER() over (order by instrumento) as id, -- ID&#xA; instrumento&#x9; -- Instrumento Inversion&#xA; into #instrumento&#xA; from AUX_H_INVERSIONES&#xA; where instrumento&#xA; not in(select de_instrumento_inversion from D_INSTRUMENTO_INVERSION)&#xA; group by instrumento &#xA; select * from #instrumento&#xA;&#xA;  IF (select count(*) from #instrumento ) &gt;=1&#xA;begin &#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'matias.paludi@sancorsalud.com.ar, alejandra.quaglia@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Cambio en tabla de dimension  D_INSTRUMENTO_INVERSION del proyecto inversiones',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'Esisten instrumentos nuevos en la D_INSTRUMENTO_INVERSION',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;end&#xA;&#xA; select &#xA;(select max(id_moneda_inversion) &#xA;&#x9;from D_MONEDA_INVERSION) + ROW_NUMBER() over (order by moneda) as id, -- ID&#xA; moneda&#x9; -- Moneda Inversion&#xA; into #moneda&#xA; from AUX_H_INVERSIONES&#xA; where moneda&#xA; not in(select de_moneda_inversion from D_MONEDA_INVERSION)&#xA; group by moneda &#xA;&#xA;   IF (select count(*) from #moneda ) &gt;=1&#xA;begin &#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'matias.paludi@sancorsalud.com.ar, alejandra.quaglia@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Cambio en tabla de dimension  D_MONEDA_INVERSION del proyecto inversiones',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'Esisten monedas nuevos en la D_MONEDA_INVERSION',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;end&#xA;&#xA;&#xA; select &#xA;(select max(id_moneda_cotizacion_inversion) &#xA;&#x9;from D_MONEDA_COTIZACION_INVERSION) + ROW_NUMBER() over (order by moneda_cotizacion) as id, -- ID&#xA; moneda_cotizacion&#x9; -- Moneda Cotización Inversion&#xA; into #moneda_coti&#xA; from AUX_H_INVERSIONES&#xA; where moneda_cotizacion&#xA; not in(select de_moneda_cotizacion_inversion from D_MONEDA_COTIZACION_INVERSION)&#xA; group by moneda_cotizacion &#xA;&#xA;    IF (select count(*) from #moneda_coti ) &gt;=1&#xA;begin &#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'matias.paludi@sancorsalud.com.ar, alejandra.quaglia@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Cambio en tabla de dimension  D_MONEDA_COTIZACION_INVERSION del proyecto inversiones',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'Esisten monedas de cotizacion nuevos en la D_MONEDA_COTIZACION_INVERSION',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;end&#xA;&#xA; select &#xA;(select max(id_administrador_inversion) &#xA;&#x9;from D_ADMINISTRADOR_INVERSION) + ROW_NUMBER() over (order by administrador) as id, -- ID&#xA; administrador&#x9; -- Administrador Inversion&#xA; into #administrador&#xA; from AUX_H_INVERSIONES&#xA; where administrador&#xA; not in(select de_administrador_inversion from D_ADMINISTRADOR_INVERSION)&#xA; group by administrador &#xA;&#xA;     IF (select count(*) from #administrador )&gt;=1&#xA;begin &#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'matias.paludi@sancorsalud.com.ar, alejandra.quaglia@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Cambio en tabla de dimension  D_ADMINISTRADOR_INVERSION del proyecto inversiones',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'Esisten administradores nuevos en la D_ADMINISTRADOR_INVERSION',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;end&#xA;&#xA;&#xA; select &#xA;(select max(id_compania_inversion) &#xA;&#x9;from D_COMPANIA_INVERSION) + ROW_NUMBER() over (order by compania_inversiones) as id, -- ID&#xA; compania_inversiones&#x9; -- compania Inversion&#xA; into #compania&#xA; from AUX_H_INVERSIONES&#xA; where compania_inversiones&#xA; not in(select de_compania_inversion from d_compania_inversion)&#xA; group by compania_inversiones&#xA;&#xA;      IF (select count(*) from #compania ) &gt;=1&#xA;begin &#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'matias.paludi@sancorsalud.com.ar, alejandra.quaglia@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Cambio en tabla de dimension  d_compania_inversion del proyecto inversiones REVISAR PROBLEMA',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'Esisten compañias nuevos en la d_compania_inversion, No se ha insertado',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;end&#xA;&#xA; DROP TABLE #temp_rubro&#xA;dROP TABLE #temp_liquidez&#xA;DROP TABLE #instrumento&#xA;DROP TABLE #moneda&#xA;DROP TABLE #moneda_coti&#xA;DROP TABLE #compania&#xA;DROP TABLE #administrador&#xA;&#xA;--SE REALIZAN LAS ACTUALIZACIONES CORRESPONDIENTES A LAS TABLAS DE DIMENSION&#xA;-- Valida si se debe agregar nuevo regisro que exista en Aux y no en D_RUBRO_INVERSION&#xA;insert into D_RUBRO_INVERSION &#xA; select &#xA;(select max(id_rubro_inversion) &#xA;&#x9;from D_RUBRO_INVERSION) + ROW_NUMBER() over (order by rubro) as id, -- ID&#xA; rubro,&#xA; ''&#x9; -- Rubro&#xA; from AUX_H_INVERSIONES&#xA; where rubro&#xA; not in(select de_rubro_inversion from D_RUBRO_INVERSION)&#xA; group by rubro &#xA; &#xA;&#xA;-- Valida si se debe agregar nuevo regisro que exista en Aux y no en D_TIPO_LIQUIDEZ_INVERSION&#xA;insert into D_TIPO_LIQUIDEZ_INVERSION&#xA; select &#xA;(select max(id_tipo_liquidez_inversion) &#xA;&#x9;from D_TIPO_LIQUIDEZ_INVERSION) + ROW_NUMBER() over (order by tipo_liquidez) as id, -- ID&#xA; tipo_liquidez&#x9; -- Tipo Liquidez Inversión&#xA; from AUX_H_INVERSIONES&#xA; where tipo_liquidez&#xA; not in(select de_tipo_liquidez_inversion from D_TIPO_LIQUIDEZ_INVERSION)&#xA; group by tipo_liquidez &#xA;&#xA;&#xA;&#xA;-- Valida si se debe agregar nuevo regisro que exista en Aux y no en D_INSTRUMENTO_INVERSION&#xA;insert into D_INSTRUMENTO_INVERSION&#xA; select &#xA;(select max(id_instrumento_inversion) &#xA;&#x9;from D_INSTRUMENTO_INVERSION) + ROW_NUMBER() over (order by instrumento) as id, -- ID&#xA; instrumento&#x9; -- Instrumento Inversion&#xA; from AUX_H_INVERSIONES&#xA; where instrumento&#xA; not in(select de_instrumento_inversion from D_INSTRUMENTO_INVERSION)&#xA; group by instrumento &#xA;&#xA;&#xA;&#xA;-- Valida si se debe agregar nuevo regisro que exista en Aux y no en D_MONEDA_INVERSION&#xA;insert into D_MONEDA_INVERSION&#xA; select &#xA;(select max(id_moneda_inversion) &#xA;&#x9;from D_MONEDA_INVERSION) + ROW_NUMBER() over (order by moneda) as id, -- ID&#xA; moneda&#x9; -- Moneda Inversion&#xA; from AUX_H_INVERSIONES&#xA; where moneda&#xA; not in(select de_moneda_inversion from D_MONEDA_INVERSION)&#xA; group by moneda &#xA;&#xA;&#xA;&#xA;-- Valida si se debe agregar nuevo regisro que exista en Aux y no en D_MONEDA_COTIZACION_INVERSION&#xA;insert into D_MONEDA_COTIZACION_INVERSION&#xA; select &#xA;(select max(id_moneda_cotizacion_inversion) &#xA;&#x9;from D_MONEDA_COTIZACION_INVERSION) + ROW_NUMBER() over (order by moneda_cotizacion) as id, -- ID&#xA; moneda_cotizacion&#x9; -- Moneda Cotización Inversion&#xA; from AUX_H_INVERSIONES&#xA; where moneda_cotizacion&#xA; not in(select de_moneda_cotizacion_inversion from D_MONEDA_COTIZACION_INVERSION)&#xA; group by moneda_cotizacion &#xA;&#xA;&#xA;-- Valida si se debe agregar nuevo regisro que exista en Aux y no en D_ADMINISTRADOR_INVERSION&#xA;insert into D_ADMINISTRADOR_INVERSION&#xA; select &#xA;(select max(id_administrador_inversion) &#xA;&#x9;from D_ADMINISTRADOR_INVERSION) + ROW_NUMBER() over (order by administrador) as id, -- ID&#xA; administrador&#x9; -- Administrador Inversion&#xA; from AUX_H_INVERSIONES&#xA; where administrador&#xA; not in(select de_administrador_inversion from D_ADMINISTRADOR_INVERSION)&#xA; group by administrador &#xA;&#xA;&#xA; -- Valida si se debe agregar nuevo regisro que exista en Aux y no en D_ADMINISTRADOR_INVERSION&#xA;insert into D_COMPANIA_INVERSION&#xA; select &#xA;(select max(id_compania_inversion) &#xA;&#x9;from D_COMPANIA_INVERSION) + ROW_NUMBER() over (order by compania_inversiones) as id, -- ID&#xA; compania_inversiones,&#x9; -- Administrador Inversion&#xA; 0 -- agrupador compania&#xA; from AUX_H_INVERSIONES&#xA; where compania_inversiones&#xA; not in(select de_compania_inversion from D_COMPANIA_INVERSION)&#xA; group by compania_inversiones &#xA;&#xA;declare @maxidc int = (select max(id_concepto_balance) from D_CONCEPTO_BALANCE) + 1&#xA;&#xA;insert into D_CONCEPTO_BALANCE&#xA;select distinct @maxidc ,concepto_balance from AUX_H_BALANCE_INVERSIONES&#xA;where concepto_balance not in (select de_concepto_balance from D_CONCEPTO_BALANCE)&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\AUX_H_BALANCE_INVERSIONES"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:DelayValidation="True"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{df64cd47-e715-4a54-9a61-4aa9865e16d8}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="AUX_H_BALANCE_INVERSIONES"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <pipeline
          BLOBTempStoragePath=""
          bufferTempStoragePath=""
          version="1">
          <components>
            <component
              refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source"
              componentClassID="Microsoft.ExcelSource"
              contactInfo="Excel Source;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
              description="Excel Source"
              name="Excel Source"
              usesDispositions="true"
              version="1">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">Indices$</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">0</property>
                <property
                  dataType="System.String"
                  description="The mapping from parameters in the SQL command to variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[File_XLS_Archivo Planif Financiera]"
                  connectionManagerRefId="Package.ConnectionManagers[File_XLS_Archivo Planif Financiera]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output]"
                  name="Excel Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]"
                      dataType="date"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[FECHA]"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]"
                      name="FECHA"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[CONCEPTO]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[CONCEPTO]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[CONCEPTO]"
                      name="CONCEPTO"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[EMPRESA]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[EMPRESA]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[EMPRESA]"
                      name="EMPRESA"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[IMPORTE]"
                      dataType="r8"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[IMPORTE]"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[IMPORTE]"
                      name="IMPORTE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F5]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F5]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F5]"
                      name="F5"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F6]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F6]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F6]"
                      name="F6"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F7]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F7]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F7]"
                      name="F7"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F8]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F8]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F8]"
                      name="F8"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F9]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F9]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F9]"
                      name="F9"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F10]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F10]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F10]"
                      name="F10"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F11]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F11]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F11]"
                      name="F11"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F12]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F12]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F12]"
                      name="F12"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F13]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F13]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F13]"
                      name="F13"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F14]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F14]"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[F14]"
                      name="F14"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[FECHA]"
                      dataType="date"
                      name="FECHA" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[CONCEPTO]"
                      dataType="wstr"
                      length="255"
                      name="CONCEPTO" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[EMPRESA]"
                      dataType="wstr"
                      length="255"
                      name="EMPRESA" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[IMPORTE]"
                      dataType="r8"
                      name="IMPORTE" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F5]"
                      dataType="wstr"
                      length="255"
                      name="F5" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F6]"
                      dataType="wstr"
                      length="255"
                      name="F6" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F7]"
                      dataType="wstr"
                      length="255"
                      name="F7" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F8]"
                      dataType="wstr"
                      length="255"
                      name="F8" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F9]"
                      dataType="wstr"
                      length="255"
                      name="F9" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F10]"
                      dataType="wstr"
                      length="255"
                      name="F10" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F11]"
                      dataType="wstr"
                      length="255"
                      name="F11" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F12]"
                      dataType="wstr"
                      length="255"
                      name="F12" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F13]"
                      dataType="wstr"
                      length="255"
                      name="F13" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F14]"
                      dataType="wstr"
                      length="255"
                      name="F14" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output]"
                  isErrorOut="true"
                  name="Excel Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[FECHA]"
                      dataType="date"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[FECHA]"
                      name="FECHA" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[CONCEPTO]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[CONCEPTO]"
                      name="CONCEPTO" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[EMPRESA]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[EMPRESA]"
                      name="EMPRESA" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[IMPORTE]"
                      dataType="r8"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[IMPORTE]"
                      name="IMPORTE" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F5]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F5]"
                      name="F5" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F6]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F6]"
                      name="F6" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F7]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F7]"
                      name="F7" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F8]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F8]"
                      name="F8" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F9]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F9]"
                      name="F9" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F10]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F10]"
                      name="F10" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F11]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F11]"
                      name="F11" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F12]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F12]"
                      name="F12" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F13]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F13]"
                      name="F13" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F14]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[F14]"
                      name="F14" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="OLE DB Destination"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[AUX_H_BALANCE_INVERSIONES]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Connections[OleDbConnection]"
                  connectionManagerID="{26CC06B3-8F11-44E5-8852-0489F0CF0750}:external"
                  connectionManagerRefId="Project.ConnectionManagers[DS_DW_SALUD]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[FECHA]"
                      cachedDataType="date"
                      cachedName="FECHA"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[fecha_balance]"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]" />
                    <inputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[CONCEPTO]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="CONCEPTO"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[concepto_balance]"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[CONCEPTO]" />
                    <inputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[EMPRESA]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="EMPRESA"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[id_compania_inversiones]"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[EMPRESA]" />
                    <inputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[IMPORTE]"
                      cachedDataType="r8"
                      cachedName="IMPORTE"
                      externalMetadataColumnId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[importe_balance]"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[IMPORTE]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[id_periodo]"
                      dataType="i4"
                      name="id_periodo" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[fecha_balance]"
                      dataType="dbDate"
                      name="fecha_balance" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[concepto_balance]"
                      dataType="wstr"
                      length="50"
                      name="concepto_balance" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[id_compania_inversiones]"
                      dataType="wstr"
                      length="50"
                      name="id_compania_inversiones" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[importe_balance]"
                      dataType="wstr"
                      length="50"
                      name="importe_balance" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\AUX_H_BALANCE_INVERSIONES.Paths[Excel Source Output]"
              endId="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]"
              name="Excel Source Output"
              startId="Package\AUX_H_BALANCE_INVERSIONES\Excel Source.Outputs[Excel Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:DelayValidation="True"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{9D75AAAC-DD0C-4D13-82D8-5103A75B3AFA}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="AUX_H_COTIZACION_MONEDA_INVERSIONES"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <pipeline
          BLOBTempStoragePath=""
          bufferTempStoragePath=""
          version="1">
          <components>
            <component
              refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source"
              componentClassID="Microsoft.ExcelSource"
              contactInfo="Excel Source;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
              description="Excel Source"
              name="Excel Source"
              usesDispositions="true"
              version="1">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">TC$</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">0</property>
                <property
                  dataType="System.String"
                  description="The mapping from parameters in the SQL command to variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[File_XLS_Archivo Planif Financiera]"
                  connectionManagerRefId="Package.ConnectionManagers[File_XLS_Archivo Planif Financiera]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output]"
                  name="Excel Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]"
                      dataType="date"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[FECHA]"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]"
                      name="FECHA"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[TC COMPRADOR]"
                      dataType="r8"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[TC COMPRADOR]"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[TC COMPRADOR]"
                      name="TC COMPRADOR"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[FECHA]"
                      dataType="date"
                      name="FECHA" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[TC COMPRADOR]"
                      dataType="r8"
                      name="TC COMPRADOR" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output]"
                  isErrorOut="true"
                  name="Excel Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[FECHA]"
                      dataType="date"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[FECHA]"
                      name="FECHA" />
                    <outputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[TC COMPRADOR]"
                      dataType="r8"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[TC COMPRADOR]"
                      name="TC COMPRADOR" />
                    <outputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="OLE DB Destination"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[AUX_H_COTIZACION_MONEDA_INVERSIONES]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Connections[OleDbConnection]"
                  connectionManagerID="{26CC06B3-8F11-44E5-8852-0489F0CF0750}:external"
                  connectionManagerRefId="Project.ConnectionManagers[DS_DW_SALUD]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[FECHA]"
                      cachedDataType="date"
                      cachedName="FECHA"
                      externalMetadataColumnId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[fecha_cotizacion]"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]" />
                    <inputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[TC COMPRADOR]"
                      cachedDataType="r8"
                      cachedName="TC COMPRADOR"
                      externalMetadataColumnId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[imp_cotizacion]"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[TC COMPRADOR]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[fecha_cotizacion]"
                      dataType="dbTimeStamp"
                      name="fecha_cotizacion" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[imp_cotizacion]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="imp_cotizacion" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES.Paths[Excel Source Output]"
              endId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]"
              name="Excel Source Output"
              startId="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source.Outputs[Excel Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\AUX_H_INVERSIONES"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:DelayValidation="True"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{A31E092F-FAC9-4983-A1CA-172DBC8E5378}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="AUX_H_INVERSIONES"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <pipeline
          BLOBTempStoragePath=""
          bufferTempStoragePath=""
          version="1">
          <components>
            <component
              refId="Package\AUX_H_INVERSIONES\Data Conversion"
              componentClassID="Microsoft.DataConvert"
              contactInfo="Data Conversion;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
              description="Data Conversion"
              name="Data Conversion"
              usesDispositions="true">
              <inputs>
                <input
                  refId="Package\AUX_H_INVERSIONES\Data Conversion.Inputs[Data Conversion Input]"
                  name="Data Conversion Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\Data Conversion.Inputs[Data Conversion Input].Columns[CANTIDAD]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="CANTIDAD"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[CANTIDAD]" />
                  </inputColumns>
                  <externalMetadataColumns />
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Output]"
                  exclusionGroup="1"
                  name="Data Conversion Output"
                  synchronousInputId="Package\AUX_H_INVERSIONES\Data Conversion.Inputs[Data Conversion Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Output].Columns[Copy of CANTIDAD]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Output].Columns[Copy of CANTIDAD]"
                      name="Copy of CANTIDAD"
                      truncationRowDisposition="FailComponent">
                      <properties>
                        <property
                          containsID="true"
                          dataType="System.Int32"
                          description="Specifies the input column used as the source of data for the conversion."
                          name="SourceInputColumnLineageID">#{Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[CANTIDAD]}</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether the column uses the faster, locale-neutral parsing routines."
                          name="FastParse">false</property>
                      </properties>
                    </outputColumn>
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="Data Conversion Error Output"
                  synchronousInputId="Package\AUX_H_INVERSIONES\Data Conversion.Inputs[Data Conversion Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\AUX_H_INVERSIONES\Excel Source"
              componentClassID="Microsoft.ExcelSource"
              contactInfo="Excel Source;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
              description="Excel Source"
              name="Excel Source"
              usesDispositions="true"
              version="1">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">Carga$</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">0</property>
                <property
                  dataType="System.String"
                  description="The mapping from parameters in the SQL command to variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\AUX_H_INVERSIONES\Excel Source.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[File_XLS_Archivo Planif Financiera]"
                  connectionManagerRefId="Package.ConnectionManagers[File_XLS_Archivo Planif Financiera]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output]"
                  name="Excel Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[TIPO]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[TIPO]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[TIPO]"
                      name="TIPO"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[INSTRUMENTO]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[INSTRUMENTO]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[INSTRUMENTO]"
                      name="INSTRUMENTO"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[ADMINISTRADOR]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[ADMINISTRADOR]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[ADMINISTRADOR]"
                      name="ADMINISTRADOR"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]"
                      dataType="date"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[FECHA]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]"
                      name="FECHA"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[UNITARIO]"
                      dataType="r8"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[UNITARIO]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[UNITARIO]"
                      name="UNITARIO"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[CANTIDAD]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[CANTIDAD]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[CANTIDAD]"
                      name="CANTIDAD"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[RUBRO]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[RUBRO]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[RUBRO]"
                      name="RUBRO"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MONEDA]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[MONEDA]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MONEDA]"
                      name="MONEDA"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MON COTIZ]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[MON COTIZ]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MON COTIZ]"
                      name="MON COTIZ"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[COMPAÑÍA]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[COMPAÑÍA]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[COMPAÑÍA]"
                      name="COMPAÑÍA"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Calculo Rendimiento]"
                      dataType="r8"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[Calculo Rendimiento]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Calculo Rendimiento]"
                      name="Calculo Rendimiento"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MOBILE]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[MOBILE]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MOBILE]"
                      name="MOBILE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Renta pesos]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[Renta pesos]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Renta pesos]"
                      name="Renta pesos"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Renta dolar]"
                      dataType="wstr"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[Renta dolar]"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Renta dolar]"
                      name="Renta dolar"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[DÍA]"
                      dataType="r8"
                      name="DÍA" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[MES]"
                      dataType="r8"
                      name="MES" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[AÑO]"
                      dataType="r8"
                      name="AÑO" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[TIPO]"
                      dataType="wstr"
                      length="255"
                      name="TIPO" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[INSTRUMENTO]"
                      dataType="wstr"
                      length="255"
                      name="INSTRUMENTO" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[ADMINISTRADOR]"
                      dataType="wstr"
                      length="255"
                      name="ADMINISTRADOR" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[FECHA]"
                      dataType="date"
                      name="FECHA" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[UNITARIO]"
                      dataType="r8"
                      name="UNITARIO" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[Importe u$s]"
                      dataType="r8"
                      name="Importe u$s" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[Importe $]"
                      dataType="r8"
                      name="Importe $" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[CANTIDAD]"
                      dataType="wstr"
                      length="255"
                      name="CANTIDAD" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[RUBRO]"
                      dataType="wstr"
                      length="255"
                      name="RUBRO" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[MONEDA]"
                      dataType="wstr"
                      length="255"
                      name="MONEDA" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[MON COTIZ]"
                      dataType="wstr"
                      length="255"
                      name="MON COTIZ" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[COMPAÑÍA]"
                      dataType="wstr"
                      length="255"
                      name="COMPAÑÍA" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[Calculo Rendimiento]"
                      dataType="r8"
                      name="Calculo Rendimiento" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[MOBILE]"
                      dataType="wstr"
                      length="255"
                      name="MOBILE" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F20]"
                      dataType="wstr"
                      length="255"
                      name="F20" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F21]"
                      dataType="wstr"
                      length="255"
                      name="F21" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F22]"
                      dataType="wstr"
                      length="255"
                      name="F22" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[F23]"
                      dataType="wstr"
                      length="255"
                      name="F23" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[Renta pesos]"
                      dataType="wstr"
                      length="255"
                      name="Renta pesos" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].ExternalColumns[Renta dolar]"
                      dataType="wstr"
                      length="255"
                      name="Renta dolar" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output]"
                  isErrorOut="true"
                  name="Excel Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[TIPO]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[TIPO]"
                      name="TIPO" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[INSTRUMENTO]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[INSTRUMENTO]"
                      name="INSTRUMENTO" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ADMINISTRADOR]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ADMINISTRADOR]"
                      name="ADMINISTRADOR" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[RUBRO]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[RUBRO]"
                      name="RUBRO" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[MOBILE]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[MOBILE]"
                      name="MOBILE" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[FECHA]"
                      dataType="date"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[FECHA]"
                      name="FECHA" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[UNITARIO]"
                      dataType="r8"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[UNITARIO]"
                      name="UNITARIO" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[MONEDA]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[MONEDA]"
                      name="MONEDA" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[MON COTIZ]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[MON COTIZ]"
                      name="MON COTIZ" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[COMPAÑÍA]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[COMPAÑÍA]"
                      name="COMPAÑÍA" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[CANTIDAD]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[CANTIDAD]"
                      name="CANTIDAD" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[Calculo Rendimiento]"
                      dataType="r8"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[Calculo Rendimiento]"
                      name="Calculo Rendimiento" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[Renta pesos]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[Renta pesos]"
                      name="Renta pesos" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[Renta dolar]"
                      dataType="wstr"
                      length="255"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Error Output].Columns[Renta dolar]"
                      name="Renta dolar" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\AUX_H_INVERSIONES\OLE DB Destination"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="OLE DB Destination"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[AUX_H_INVERSIONES]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Connections[OleDbConnection]"
                  connectionManagerID="{26CC06B3-8F11-44E5-8852-0489F0CF0750}:external"
                  connectionManagerRefId="Project.ConnectionManagers[DS_DW_SALUD]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[FECHA]"
                      cachedDataType="date"
                      cachedName="FECHA"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[fecha_cotizacion]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[FECHA]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[UNITARIO]"
                      cachedDataType="r8"
                      cachedName="UNITARIO"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[imp_unitario]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[UNITARIO]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[Copy of CANTIDAD]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="255"
                      cachedName="Copy of CANTIDAD"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[cantidad_total]"
                      lineageId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Output].Columns[Copy of CANTIDAD]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[TIPO]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="TIPO"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[tipo_liquidez]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[TIPO]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[ADMINISTRADOR]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="ADMINISTRADOR"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[administrador]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[ADMINISTRADOR]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[RUBRO]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="RUBRO"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[rubro]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[RUBRO]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[INSTRUMENTO]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="INSTRUMENTO"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[instrumento]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[INSTRUMENTO]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[MONEDA]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="MONEDA"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[moneda]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MONEDA]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[MON COTIZ]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="MON COTIZ"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[moneda_cotizacion]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MON COTIZ]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[COMPAÑÍA]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="COMPAÑÍA"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[compania_inversiones]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[COMPAÑÍA]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[Calculo Rendimiento]"
                      cachedDataType="r8"
                      cachedName="Calculo Rendimiento"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[marca_cotizacion_anterior]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Calculo Rendimiento]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[MOBILE]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="MOBILE"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[de_rubro_inversion_resumida]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[MOBILE]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[Renta dolar]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="Renta dolar"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[imp_renta_dolar]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Renta dolar]" />
                    <inputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[Renta pesos]"
                      cachedDataType="wstr"
                      cachedLength="255"
                      cachedName="Renta pesos"
                      externalMetadataColumnId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[imp_renta_pesos]"
                      lineageId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output].Columns[Renta pesos]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[fecha_cotizacion]"
                      dataType="dbTimeStamp"
                      name="fecha_cotizacion" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[rubro]"
                      dataType="wstr"
                      length="50"
                      name="rubro" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[tipo_liquidez]"
                      dataType="wstr"
                      length="50"
                      name="tipo_liquidez" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[instrumento]"
                      dataType="wstr"
                      length="50"
                      name="instrumento" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[moneda]"
                      dataType="wstr"
                      length="50"
                      name="moneda" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[moneda_cotizacion]"
                      dataType="wstr"
                      length="50"
                      name="moneda_cotizacion" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[compania_inversiones]"
                      dataType="wstr"
                      length="50"
                      name="compania_inversiones" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[administrador]"
                      dataType="wstr"
                      length="50"
                      name="administrador" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[cantidad_total]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="cantidad_total" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[imp_unitario]"
                      dataType="numeric"
                      name="imp_unitario"
                      precision="18"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[marca_cotizacion_anterior]"
                      dataType="wstr"
                      length="50"
                      name="marca_cotizacion_anterior" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[de_rubro_inversion_resumida]"
                      dataType="wstr"
                      length="50"
                      name="de_rubro_inversion_resumida" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[imp_renta_dolar]"
                      dataType="wstr"
                      length="50"
                      name="imp_renta_dolar" />
                    <externalMetadataColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[imp_renta_pesos]"
                      dataType="wstr"
                      length="50"
                      name="imp_renta_pesos" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\AUX_H_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\AUX_H_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\AUX_H_INVERSIONES\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\AUX_H_INVERSIONES.Paths[Data Conversion Output]"
              endId="Package\AUX_H_INVERSIONES\OLE DB Destination.Inputs[OLE DB Destination Input]"
              name="Data Conversion Output"
              startId="Package\AUX_H_INVERSIONES\Data Conversion.Outputs[Data Conversion Output]" />
            <path
              refId="Package\AUX_H_INVERSIONES.Paths[Excel Source Output]"
              endId="Package\AUX_H_INVERSIONES\Data Conversion.Inputs[Data Conversion Input]"
              name="Excel Source Output"
              startId="Package\AUX_H_INVERSIONES\Excel Source.Outputs[Excel Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Borrar Auxiliares"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{DA3EB16A-DE18-4415-8F44-EAD1054BD20D}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Borrar Auxiliares"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="truncate table aux_h_inversiones&#xA;truncate table aux_h_cotizacion_moneda_inversiones&#xA;truncate table AUX_H_BALANCE_INVERSIONES" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Copia XLS a Local"
      DTS:CreationName="Microsoft.FileSystemTask"
      DTS:Description="Tarea Sistema de archivos"
      DTS:DTSID="{1D610343-4D5B-4A22-8DB9-2C959F1A1C35}"
      DTS:ExecutableType="Microsoft.FileSystemTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Copia XLS a Local"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <FileSystemData
          TaskOverwriteDestFile="True"
          TaskSourcePath="{3DC1BA31-244E-4219-BCC5-AFF6416D6D1C}"
          TaskDestinationPath="{2CE01C72-FC3D-4B68-864B-908754BCEA79}" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Envia mail Tras fallo"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{BE979103-5F89-4CF2-9591-6DEC89F89FB2}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Envia mail Tras fallo"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'david.angeletti@sancorsalud.com.ar; maximiliano.olmedo@sancorsalud.com.ar; Hugo.Valler@sancorsalud.com.ar; German.Scarafia@sancorsalud.com.ar; Luciano.Cicchino@sancorsalud.com.ar ',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Data Inversiones Ejecucion Fallida',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'El proceso no termino correctamente, comunicarse con planeamiento y control de gestion. Interno: 3086 ',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Envio de mail Tras finalizacion correcta"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{2240CFA4-E6A5-44E7-9A65-B4E8282BA151}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Envio de mail Tras finalizacion correcta"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="&#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'david.angeletti@sancorsalud.com.ar ;maximiliano.olmedo@sancorsalud.com.ar ;Hugo.Valler@sancorsalud.com.ar ; German.Scarafia@sancorsalud.com.ar ;Luciano.Cicchino@sancorsalud.com.ar; matias.paludi@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Data Inversiones Ejecucion Correcta',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'El proceso termino correctamente, cualquier duda comunicarse con planeamiento y control de gestion Interno: 3086',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Inserta en la h"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{1C3AA17B-F74B-40F8-9AAC-2C5B0D0B16B1}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Inserta en la h"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="--ELIMINA TODAS LAS INVERSIONES DEL ULTIMO DIA&#xA;delete from h_inversiones --where fecha_cotizacion_inversiones = @fecha_maxima&#xA;&#xA;-- ACTUALIZA EL ULTIMO DIA&#xA;insert into h_inversiones&#xA;select dbo.DevuelvePeriodo(fecha_cotizacion),&#xA;fecha_cotizacion, &#xA;id_rubro_inversion,&#xA;id_tipo_liquidez_inversion,&#xA;id_instrumento_inversion,&#xA;id_moneda_inversion,&#xA;id_moneda_cotizacion_inversion, &#xA;id_compania_inversion,&#xA;id_administrador_inversion,&#xA;isnull(round(cantidad_total,0),0) as cant_total_inversion, &#xA;isnull(imp_unitario,0) as imp_unitario_inversion,&#xA;0 as id_marca_ultimo_dia_mes, &#xA;1 as imp_cotizacion_dolar ,&#xA;0 as tna_ytd,&#xA;0 as tna_mtd,&#xA;0 as pond_mensual,&#xA;0 as pond_anual,&#xA;0 as imp_unitario_mes_anterior_inversiones,&#xA;0 as cant_total_mes_anterior_inversion,&#xA;0 as cotizacion_anterior_inversion,&#xA;isnull(marca_cotizacion_anterior,1) as marca_cotizacion_anterior_inversion,&#xA;case when tipo_liquidez = 'No Líq.' and imp_unitario is not null then imp_unitario else 0 end as rendimiento_nominal_inversion,&#xA;0 as variacion_cantidad_inversiones,&#xA;0 as variacion_importe_total_inversiones,&#xA;0 as total_variacion_acumulado_inversiones,&#xA;0 as imp_unitario_inversion_dolar,&#xA;0 as imp_unitario_cierre_mes_anterior_inversion_dolar,&#xA;0 as rendimiento_nominal_dolar_inversion,&#xA;0  AS tna_ytd_dolar,&#xA;0  as tna_mtd_dolar,&#xA;0  as pond_mensual_dolar_inversion,&#xA;0 as pond_anual_dolar_inversion,&#xA;isnull(imp_renta_dolar,0),&#xA;isnull(imp_renta_pesos,0),&#xA;0 as imp_unitario_inversion_moneda_origen,&#xA;0 as tna_mensual_moneda_origen,&#xA;0 as tna_anual_moneda_origen,&#xA;0 as pond_mensual_moneda_origen_inversion,&#xA;0 as pond_anual_moneda_origen_inversion,&#xA;0 as rendimiento_nominal_inversion_dolar,&#xA;0 as variacion_importe_total_inversiones_dolar,&#xA;0 as imp_cotizacion_dia_anterior_inversion_dolar,&#xA;0 as total_variacion_acumulado_inversiones_dolar&#xA;from aux_h_inversiones A&#xA;&#x9;inner join D_RUBRO_INVERSION D on a.rubro = d.de_rubro_inversion&#xA;&#x9;inner join D_TIPO_LIQUIDEZ_INVERSION L on a.tipo_liquidez = l.de_tipo_liquidez_inversion&#xA;&#x9;inner join D_INSTRUMENTO_INVERSION II on ii.de_instrumento_inversion = a.instrumento&#xA;&#x9;inner join D_MONEDA_INVERSION M  on a.moneda = m.de_moneda_inversion&#xA;&#x9;inner join D_MONEDA_COTIZACION_INVERSION C on a.moneda_cotizacion =  c.de_moneda_cotizacion_inversion &#xA;&#x9;inner join D_COMPANIA_INVERSION I on a.compania_inversiones = I.de_compania_inversion&#xA;&#x9;inner join D_ADMINISTRADOR_INVERSION AI on a.administrador = AI.de_administrador_inversion&#xA;--where a.fecha_cotizacion = @fecha_maxima&#xA;&#xA;&#xA;-- Elimina La cotizacion de la moneda para cargarla de nuevo entera&#xA;declare @fecha_maxima_cot as datetime = (select max(fecha_cotizacion) from aux_h_cotizacion_moneda_inversiones)&#xA;delete from aux_h_cotizacion_moneda_inversiones where fecha_cotizacion is null and imp_cotizacion is null&#xA;delete from h_cotizacion_moneda_inversiones --where fecha_cotizacion = @fecha_maxima_cot&#xA;&#xA;insert into h_cotizacion_moneda_inversiones&#xA;select fecha_cotizacion, isnull(imp_cotizacion,0) from aux_h_cotizacion_moneda_inversiones&#xA;--where fecha_cotizacion = @fecha_maxima_cot&#xA;&#xA;&#xA;&#xA;&#xA;-----------------------------------------------------------------------------------&#xA;--Setea marca ultimo dia del mes en 0&#xA;update h_inversiones&#xA;set id_marca_ultimo_dia_mes = 0&#xA;-- Guarda el ultimo dia del mes por cada periodo&#xA;select id_periodo , max(fecha_cotizacion_inversiones) fecha into #ultima_fecha from h_inversiones group by id_periodo&#xA;&#xA;&#xA;--Setea marca ultimo dia del mes en 1 para los ultimos dias&#xA;update h_inversiones&#xA;set id_marca_ultimo_dia_mes = 1&#xA;from h_inversiones h inner join #ultima_fecha t on h.fecha_cotizacion_inversiones = fecha&#xA;&#xA;&#xA;-- Setea el importe del dolar para cada dia segun la tabla de cotizaciones&#xA;update h_inversiones&#xA;set imp_cotizacion_dolar = t.imp_cotizacion_dolar&#xA;from h_inversiones h inner join H_COTIZACION_MONEDA_INVERSIONES t on h.fecha_cotizacion_inversiones = t.fecha_cotizacion_inversiones&#xA;&#xA;&#xA;&#xA;-- Almaceno los importes en dolares &#x9;&#xA;&#x9;update H_INVERSIONES&#xA;&#x9;set imp_unitario_inversion_dolar = imp_unitario_inversion&#xA;&#x9;from H_INVERSIONES&#xA;&#x9;where id_moneda_cotizacion_inversion = 1&#xA;&#xA;&#x9;-- Almaceno los importes en dolares &#x9;&#xA;&#x9;update H_INVERSIONES&#xA;&#x9;set imp_unitario_inversion_dolar = imp_unitario_inversion / imp_cotizacion_dolar&#xA;&#x9;from H_INVERSIONES&#xA;&#x9;where id_moneda_cotizacion_inversion = 2&#xA;&#xA;&#xA;&#xA;-- Almaceno la moneda de origen &#xA;&#x9;update H_INVERSIONES&#xA;&#x9;set imp_unitario_inversion_moneda_origen = imp_unitario_inversion&#xA;&#x9;from H_INVERSIONES&#xA;&#xA;&#xA;-- Caluclo el MTD Y el YTD Con la moneda de origen&#xA;&#xA;--Calculo la fecha minima de cada instrumento con tope a un año y que sea el ultimo dia del mes&#xA;select id_periodo,id_rubro_inversion, id_instrumento_inversion,id_administrador_inversion,&#xA;id_compania_inversion,cast(null as date)  fecha, cast(0 as float) as valor_cuota, cast(0 as float) as valor_dolar, cast(0 as float) as valor_cuota_dolar&#xA;into #temp_valor_cuota_inicial_original&#xA;from h_inversiones where imp_unitario_inversion &gt; 0 --and cant_total_inversion &gt;0&#xA;group by id_periodo,id_rubro_inversion, id_instrumento_inversion,id_administrador_inversion,id_compania_inversion&#xA;&#xA;select t.id_periodo,h.id_rubro_inversion,h.id_instrumento_inversion,&#xA;&#x9;h.id_administrador_inversion,h.id_compania_inversion, min(fecha_cotizacion_inversiones) as minima_fecha&#xA;&#x9;&#x9;&#x9;into #fecha_año_anterior_original&#xA;&#x9;&#x9;&#x9;from h_inversiones h &#xA;&#x9;&#x9;&#x9;&#x9;inner join #temp_valor_cuota_inicial_original t &#xA;&#x9;&#x9;&#x9;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;&#x9;&#x9;&#x9;t.id_administrador_inversion = h.id_administrador_inversion &#xA;&#x9;&#x9;&#x9;&#x9;and h.id_compania_inversion = t.id_compania_inversion and h.id_periodo &gt;= dbo.PeriodosAnteriores(t.id_periodo,13)&#xA;&#x9;&#x9;&#x9;&#x9;and  h.id_marca_ultimo_dia_mes = 1 and h.imp_unitario_inversion &gt; 0 &#xA;&#x9;&#x9;&#x9;&#x9;group by t.id_periodo,h.id_rubro_inversion,h.id_instrumento_inversion,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;h.id_administrador_inversion,h.id_compania_inversion&#xA;&#xA;update #temp_valor_cuota_inicial_original&#xA;set fecha = minima_fecha&#xA;&#x9;&#x9;from #fecha_año_anterior_original h &#xA;&#x9;&#x9;inner join #temp_valor_cuota_inicial_original t &#xA;&#x9;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;&#x9;t.id_administrador_inversion = h.id_administrador_inversion &#xA;&#x9;&#x9;and h.id_compania_inversion = t.id_compania_inversion and t.id_periodo = h.id_periodo&#xA;&#xA;-- Seteo para esa fecha el valor cuota correspondiente &#xA;update #temp_valor_cuota_inicial_original&#xA;set valor_cuota = imp_unitario_inversion_moneda_origen,&#xA;&#x9;valor_Dolar = imp_cotizacion_dolar&#xA;from h_inversiones h &#xA;inner join #temp_valor_cuota_inicial_original t &#xA;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;&#x9;t.id_administrador_inversion = h.id_administrador_inversion &#xA;&#x9;&#x9;and h.id_compania_inversion = t.id_compania_inversion  and h.fecha_cotizacion_inversiones = t.fecha&#xA;&#xA;--TNA YTD&#xA;--Calcula la tasa nominal anual comparando con la fehca minima del instrumento con tope a un año y la multiplica por 365&#xA;-- la formula es el (importe actual / importe inicial ) / cantidad de dias entre hoy y inicio de instrumento&#xA;update h_inversiones&#xA;set tna_anual_moneda_origen = calculo &#xA;from h_inversiones h inner join   (&#xA;&#x9;select fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion,h.id_compania_inversion,&#xA;&#x9;max (fecha) fechaminima,max(valor_cuota) valorviejo,  max(fecha_cotizacion_inversiones) fechaactual,max(imp_unitario_inversion) importe_actual ,&#xA;&#x9;--datediff(dd,fecha,fecha_cotizacion_inversiones),( imp_unitario_inversion/valor_cuota-1),&#xA;&#x9;(((max(imp_unitario_inversion_moneda_origen)/max(valor_cuota))-1)/datediff(dd,max(fecha),max(fecha_cotizacion_inversiones))*365)  as calculo&#xA;&#x9;from h_inversiones h inner join #temp_valor_cuota_inicial_original t &#xA;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;t.id_administrador_inversion = h.id_administrador_inversion &#x9;and &#x9;h.id_compania_inversion = t.id_compania_inversion and h.id_periodo = t.id_periodo&#xA;&#x9;where datediff(dd,fecha,fecha_cotizacion_inversiones) &lt;&gt; 0 and valor_cuota &gt; 0 and fecha_cotizacion_inversiones &gt; fecha&#xA;&#x9;and h.id_tipo_liquidez_inversion = 1 &#xA;&#x9;group by fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion,h.id_compania_inversion) A &#xA;&#x9;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones&#xA;and h.id_compania_inversion = a.id_compania_inversion&#xA;&#xA;&#xA;--TNA MTD&#xA;-- Calcula la tasa nominal mensual&#xA;-- similar a la anual pero multiplica por 30&#xA;update h_inversiones&#xA;set tna_mensual_moneda_origen = calculo &#xA;from h_inversiones h inner join (&#xA;select h.fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion,&#xA;max (hv.fecha_cotizacion_inversiones) fechaminima,max(hv.imp_unitario_inversion) valorviejo,  max(h.fecha_cotizacion_inversiones) fechaactual,max(h.imp_unitario_inversion) importe_actual ,&#xA;--datediff(dd,fecha,fecha_cotizacion_inversiones),(imp_unitario_inversion/valor_cuota-1),&#xA;((max(h.imp_unitario_inversion_moneda_origen)/max(hv.imp_unitario_inversion_moneda_origen) -1)&#xA;/(datediff(dd,max(hv.fecha_cotizacion_inversiones),max(h.fecha_cotizacion_inversiones)))*30)    as calculo -- Cambio 365 a 30&#xA;from h_inversiones h inner join h_inversiones hv &#xA;&#x9;on hv.id_rubro_inversion = h.id_rubro_inversion and hv.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;hv.id_administrador_inversion = h.id_administrador_inversion and dbo.periodosanteriores(h.id_periodo,2) = hv.id_periodo&#xA;&#x9;and &#x9;h.id_compania_inversion = hv.id_compania_inversion &#xA;&#x9;where  datediff(dd,hv.fecha_cotizacion_inversiones,h.fecha_cotizacion_inversiones) &lt;&gt; 0 and hv.imp_unitario_inversion &gt; 0&#xA;&#x9;and h.id_tipo_liquidez_inversion = 1 and hv.id_marca_ultimo_dia_mes = 1 and h.imp_unitario_inversion &gt; 0&#xA;group by h.fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,&#xA;&#x9;&#x9; h.id_administrador_inversion,h.id_compania_inversion&#xA;&#x9;&#xA;) A&#xA;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion &#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones&#xA;and a.id_compania_inversion = h.id_compania_inversion&#xA;&#xA;&#xA;&#xA;-- Para los instrumentos que aun no tienen mas de un mes se toma la fecha minima donde tiene valor en ese periodo &#xA;select h.id_periodo,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion,&#xA;cast('1900-01-01' as date) as fecha,cast(0.0 as decimal(18,6)) as importe &#xA;into #temp_calculo_tna_m_origen&#xA;from h_inversiones h &#xA;where h.id_tipo_liquidez_inversion = 1 and tna_mensual = 0 and imp_unitario_inversion &lt;&gt; 0 and cant_total_inversion &lt;&gt; 0&#xA;group by  h.id_periodo,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion&#xA;&#xA;UPDATE #temp_calculo_tna_m_origen&#xA;SET fecha = (SELECT MIN(fecha_cotizacion_inversiones) &#xA;&#x9;&#x9;&#x9;FROM h_inversiones H INNER JOIN #temp_calculo_tna_m_origen A on h.id_rubro_inversion = a.id_rubro_inversion&#xA;&#x9;&#x9;&#x9;and h.id_instrumento_inversion = a.id_instrumento_inversion and h.id_compania_inversion = a.id_compania_inversion&#xA;&#x9;&#x9;&#x9;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;&#x9;&#x9;&#x9;AND H.id_periodo = A.id_periodo&#xA;&#x9;&#x9;&#x9;WHERE imp_unitario_inversion &lt;&gt; 0 )&#xA;&#xA;&#xA;&#xA;-- Pega el importe de inicio para los instrumentos que no llegan a un mes&#xA;update #temp_calculo_tna_m_origen&#xA;set importe = imp_unitario_inversion_moneda_origen&#xA;from #temp_calculo_tna_m_origen a inner join h_inversiones h on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion and h.id_compania_inversion = a.id_compania_inversion&#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.fecha = h.fecha_cotizacion_inversiones AND H.id_periodo = A.id_periodo&#xA;where cant_total_inversion &lt;&gt; 0 AND fecha &lt;&gt; '1900-01-01'&#xA;-- Calcula la tna mensual para estos casos &#xA;&#xA;update h_inversiones&#xA;set tna_mensual_moneda_origen= ((h.imp_unitario_inversion_moneda_origen /a.importe) - 1  / datediff(dd,a.fecha,h.fecha_cotizacion_inversiones)*30)&#xA;from h_inversiones h inner join #temp_calculo_tna_m_origen a&#xA;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion &#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.id_periodo = h.id_periodo and a.id_compania_inversion = h.id_compania_inversion&#xA;where tna_mensual= 0 and h.cant_total_inversion &lt;&gt; 0 &#xA;and h.imp_unitario_inversion &lt;&gt; 0 and (datediff(dd,a.fecha,h.fecha_cotizacion_inversiones) &lt;&gt; 0 and a.importe-1 &lt;&gt; 0 and a.importe &lt;&gt; 0  )&#xA;&#xA;&#xA;&#xA;&#xA;-- Cuando el instrumento esta en dolar el valor unitario se pecifica&#xA;&#x9;update H_INVERSIONES&#xA;&#x9;set imp_unitario_inversion = imp_unitario_inversion * imp_cotizacion_dolar&#xA;&#x9;from H_INVERSIONES&#xA;&#x9;where id_moneda_cotizacion_inversion = 1&#xA;&#xA;&#xA;--Calculo la fecha minima de cada instrumento con tope a un año y que sea el ultimo dia del mes&#xA;select id_periodo,id_rubro_inversion, id_instrumento_inversion,id_administrador_inversion,&#xA;id_compania_inversion,cast(null as date)  fecha, cast(0 as float) as valor_cuota, cast(0 as float) as valor_dolar, cast(0 as float) as valor_cuota_dolar&#xA;into #temp_valor_cuota_inicial&#xA;from h_inversiones where imp_unitario_inversion &gt; 0  --and cant_total_inversion &gt;0&#xA;group by id_periodo,id_rubro_inversion, id_instrumento_inversion,id_administrador_inversion,id_compania_inversion&#xA;&#xA;select t.id_periodo,h.id_rubro_inversion,h.id_instrumento_inversion,&#xA;&#x9;h.id_administrador_inversion,h.id_compania_inversion, min(fecha_cotizacion_inversiones) as minima_fecha&#xA;&#x9;&#x9;&#x9;into #fecha_año_anterior&#xA;&#x9;&#x9;&#x9;from h_inversiones h &#xA;&#x9;&#x9;&#x9;&#x9;inner join #temp_valor_cuota_inicial t &#xA;&#x9;&#x9;&#x9;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;&#x9;&#x9;&#x9;t.id_administrador_inversion = h.id_administrador_inversion &#xA;&#x9;&#x9;&#x9;&#x9;and h.id_compania_inversion = t.id_compania_inversion and h.id_periodo &gt;= dbo.PeriodosAnteriores(t.id_periodo,13)&#xA;&#x9;&#x9;&#x9;&#x9;and  h.id_marca_ultimo_dia_mes = 1 and h.imp_unitario_inversion &gt; 0 &#xA;&#x9;&#x9;&#x9;&#x9;group by t.id_periodo,h.id_rubro_inversion,h.id_instrumento_inversion,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;h.id_administrador_inversion,h.id_compania_inversion&#xA;&#xA;update #temp_valor_cuota_inicial&#xA;set fecha = minima_fecha&#xA;&#x9;&#x9;from #fecha_año_anterior h &#xA;&#x9;&#x9;inner join #temp_valor_cuota_inicial t &#xA;&#x9;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;&#x9;t.id_administrador_inversion = h.id_administrador_inversion &#xA;&#x9;&#x9;and h.id_compania_inversion = t.id_compania_inversion and t.id_periodo = h.id_periodo&#xA;&#x9;&#x9;&#xA;&#xA;-- Seteo para esa fecha el valor cuota correspondiente &#xA;update #temp_valor_cuota_inicial&#xA;set valor_cuota = imp_unitario_inversion,&#xA;&#x9;valor_cuota_dolar = imp_unitario_inversion_dolar,&#xA;&#x9;valor_Dolar = imp_cotizacion_dolar&#xA;from h_inversiones h &#xA;inner join #temp_valor_cuota_inicial t &#xA;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;&#x9;t.id_administrador_inversion = h.id_administrador_inversion &#xA;&#x9;&#x9;and h.id_compania_inversion = t.id_compania_inversion and h.fecha_cotizacion_inversiones = t.fecha&#xA;&#xA;&#xA;--TNA YTD&#xA;--Calcula la tasa nominal anual comparando con la fehca minima del instrumento con tope a un año y la multiplica por 365&#xA;-- la formula es el (importe actual / importe inicial ) / cantidad de dias entre hoy y inicio de instrumento&#xA;update h_inversiones&#xA;set tna_anual = calculo &#xA;from h_inversiones h inner join   (&#xA;&#x9;&#x9;select fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion,&#xA;&#x9;&#x9;max (fecha) fechaminima,max(valor_cuota) valorviejo,  max(fecha_cotizacion_inversiones) fechaactual,max(imp_unitario_inversion) importe_actual ,&#xA;&#x9;&#x9;--datediff(dd,fecha,fecha_cotizacion_inversiones),( imp_unitario_inversion/valor_cuota-1),&#xA;&#x9;&#x9;(((max(imp_unitario_inversion)/max(valor_cuota)) - 1)/datediff(dd,max(fecha),max(fecha_cotizacion_inversiones))*365)  as calculo&#xA;from h_inversiones h inner join #temp_valor_cuota_inicial t &#xA;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;t.id_administrador_inversion = h.id_administrador_inversion &#x9;and &#x9;h.id_compania_inversion = t.id_compania_inversion and t.id_periodo = h.id_periodo&#xA;&#x9;where datediff(dd,fecha,fecha_cotizacion_inversiones) &lt;&gt; 0 and valor_cuota &gt; 0 &#xA;&#x9;and h.id_tipo_liquidez_inversion = 1 and fecha_cotizacion_inversiones &gt; fecha&#xA;&#x9;group by fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,&#xA;&#x9;h.id_administrador_inversion,h.id_compania_inversion&#xA;&#x9;) A &#xA;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion &#xA;and h.id_administrador_inversion = a.id_administrador_inversion and a.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones&#xA;and h.id_compania_inversion = a.id_compania_inversion&#xA;&#xA;&#xA;&#xA;&#xA;--TNA MTD&#xA;-- Calcula la tasa nominal mensual&#xA;-- similar a la anual pero multiplica por 30&#xA;update h_inversiones&#xA;set tna_mensual = calculo &#xA;from h_inversiones h inner join (&#xA;select h.fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion,&#xA;max (hv.fecha_cotizacion_inversiones) fechaminima,max(hv.imp_unitario_inversion) valorviejo,  max(h.fecha_cotizacion_inversiones) fechaactual,max(h.imp_unitario_inversion) importe_actual ,&#xA;--datediff(dd,max(hv.fecha_cotizacion_inversiones),max(h.fecha_cotizacion_inversiones)),--(imp_unitario_inversion/valor_cuota-1),&#xA;((max(h.imp_unitario_inversion)/max(hv.imp_unitario_inversion))-1)&#xA;/(datediff(dd,max(hv.fecha_cotizacion_inversiones),max(h.fecha_cotizacion_inversiones)))*30    as calculo -- Cambio 365 a 30&#xA;from h_inversiones h inner join h_inversiones hv &#xA;&#x9;on hv.id_rubro_inversion = h.id_rubro_inversion and hv.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;hv.id_administrador_inversion = h.id_administrador_inversion and dbo.periodosanteriores(h.id_periodo,2) = hv.id_periodo&#xA;&#x9;and &#x9;h.id_compania_inversion = hv.id_compania_inversion &#xA;&#x9;where  datediff(dd,hv.fecha_cotizacion_inversiones,h.fecha_cotizacion_inversiones) &lt;&gt; 0 and hv.imp_unitario_inversion &gt; 0&#xA;&#x9;and h.id_tipo_liquidez_inversion = 1 and hv.id_marca_ultimo_dia_mes = 1 &#xA;&#x9;and h.imp_unitario_inversion &lt;&gt; 0 --and hv.cant_total_inversion &lt;&gt; 0 &#xA;&#x9;and hv.imp_unitario_inversion &lt;&gt; 0  &#xA;group by h.fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,&#xA;&#x9;&#x9; h.id_administrador_inversion,h.id_compania_inversion&#xA;&#x9;&#xA;) A&#xA;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion &#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones&#xA;and a.id_compania_inversion = h.id_compania_inversion&#xA;&#xA;&#xA;&#xA;&#xA;-- Para los instrumentos que aun no tienen mas de un mes se toma la fecha minima donde tiene valor en ese periodo &#xA;select h.id_periodo,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion,&#xA;cast('1900-01-01' as date) as fecha,cast(0.0 as decimal(18,6)) as importe &#xA;into #temp_calculo_tna_m&#xA;from h_inversiones h &#xA;where h.id_tipo_liquidez_inversion = 1 and tna_mensual = 0 and imp_unitario_inversion &lt;&gt; 0 &#xA;group by  h.id_periodo,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion&#xA;&#xA;UPDATE #temp_calculo_tna_m&#xA;SET fecha = (SELECT MIN(fecha_cotizacion_inversiones) &#xA;&#x9;&#x9;&#x9;FROM h_inversiones H INNER JOIN #temp_calculo_tna_m A on h.id_rubro_inversion = a.id_rubro_inversion&#xA;&#x9;&#x9;&#x9;and h.id_instrumento_inversion = a.id_instrumento_inversion and h.id_compania_inversion = a.id_compania_inversion&#xA;&#x9;&#x9;&#x9;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;&#x9;&#x9;&#x9;AND H.id_periodo = A.id_periodo&#xA;&#x9;&#x9;&#x9;WHERE imp_unitario_inversion &lt;&gt; 0 )&#xA;&#xA;&#xA;&#xA;-- Pega el importe de inicio para los instrumentos que no llegan a un mes&#xA;update #temp_calculo_tna_m&#xA;set importe = imp_unitario_inversion&#xA;from #temp_calculo_tna_m a inner join h_inversiones h on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion and h.id_compania_inversion = a.id_compania_inversion&#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.fecha = h.fecha_cotizacion_inversiones AND H.id_periodo = A.id_periodo&#xA;where imp_unitario_inversion &lt;&gt; 0 AND fecha &lt;&gt; '1900-01-01'-- Era cantidad en vez de importe&#xA;-- Calcula la tna mensual para estos casos &#xA;&#xA;update h_inversiones&#xA;set tna_mensual= ((h.imp_unitario_inversion /a.importe) - 1  / datediff(dd,a.fecha,h.fecha_cotizacion_inversiones)*30)&#xA;from h_inversiones h inner join #temp_calculo_tna_m a&#xA;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion &#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.id_periodo = h.id_periodo and a.id_compania_inversion = h.id_compania_inversion&#xA;where tna_mensual= 0 and h.cant_total_inversion &lt;&gt; 0 &#xA;and h.imp_unitario_inversion &lt;&gt; 0 and (datediff(dd,a.fecha,h.fecha_cotizacion_inversiones) &lt;&gt; 0 and a.importe-1 &lt;&gt; 0 and a.importe &lt;&gt; 0  )&#xA;&#xA;&#xA;---- CALCULA TNA MTD Y TNA YTD DOLARIZADO&#xA;--TNA YTD&#xA;--Calcula la tasa nominal anual comparando con la fehca minima del instrumento con tope a un año y la multiplica por 365&#xA;-- la formula es el (importe actual / importe inicial ) / cantidad de dias entre hoy y inicio de instrumento&#xA;update h_inversiones&#xA;set tna_anual_dolar = calculo &#xA;from h_inversiones h inner join   (&#xA;&#x9;select fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion,h.id_compania_inversion, &#xA;&#x9;max (fecha) fechaminima,max(valor_cuota_dolar) valorviejo,  max(fecha_cotizacion_inversiones) fechaactual,max(imp_unitario_inversion_dolar) importe_actual ,&#xA;&#x9;--datediff(dd,fecha,fecha_cotizacion_inversiones),( imp_unitario_inversion/valor_cuota-1),&#xA;&#x9;((((max(imp_unitario_inversion_dolar))/(max(valor_cuota_dolar)) -1&#xA;&#x9;))/datediff(dd,max(fecha),max(fecha_cotizacion_inversiones))*365)  as calculo&#xA;&#x9;from h_inversiones h inner join #temp_valor_cuota_inicial t &#xA;&#x9;on t.id_rubro_inversion = h.id_rubro_inversion and t.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;t.id_administrador_inversion = h.id_administrador_inversion  and t.id_compania_inversion = h.id_compania_inversion and h.id_periodo = t.id_periodo&#xA;&#x9;where datediff(dd,fecha,fecha_cotizacion_inversiones) &lt;&gt; 0 and valor_cuota_dolar &gt; 0 and fecha_cotizacion_inversiones &gt; fecha&#xA;&#x9;and h.id_tipo_liquidez_inversion = 1 and h.imp_unitario_inversion_dolar &gt; 0&#xA;&#x9;group by fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion,h.id_compania_inversion&#xA;&#x9;) A &#xA;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion and h.id_administrador_inversion = a.id_administrador_inversion&#xA;and a.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones and h.id_compania_inversion = a.id_compania_inversion&#xA;&#xA;&#xA;&#xA;--TNA MTD&#xA;-- Calcula la tasa nominal mensual&#xA;-- similar a la anual pero multiplica por 30&#xA;update h_inversiones&#xA;set tna_mensual_dolar = calculo &#xA;from h_inversiones h inner join (&#xA;&#x9;select h.fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion,h.id_compania_inversion, &#xA;&#x9;max (hv.fecha_cotizacion_inversiones) fechaminima,max(hv.imp_unitario_inversion_dolar) valorviejo,  max(h.fecha_cotizacion_inversiones) fechaactual,max(h.imp_unitario_inversion_dolar) importe_actual ,&#xA;&#x9;--datediff(dd,max(hv.fecha_cotizacion_inversiones),max(h.fecha_cotizacion_inversiones)) as diferencia_fecha,&#xA;&#x9;--((max(h.imp_unitario_inversion_dolar))/(max(hv.imp_unitario_inversion_dolar)))-1 as primer_termino,&#xA;&#x9;datediff(dd,max(hv.fecha_cotizacion_inversiones),max(h.fecha_cotizacion_inversiones)) as segundo_termino,&#xA;&#x9;--( imp_unitario_inversion/valor_cuota-1),&#xA;&#x9;((max(h.imp_unitario_inversion_dolar)/max(hv.imp_unitario_inversion_dolar))-1)&#xA;/(datediff(dd,max(hv.fecha_cotizacion_inversiones),max(h.fecha_cotizacion_inversiones)))*30&#x9;as calculo -- Cambio 365 a 30&#xA;&#x9;from h_inversiones h inner join h_inversiones hv &#xA;&#x9;&#x9;on hv.id_rubro_inversion = h.id_rubro_inversion and hv.id_instrumento_inversion = h.id_instrumento_inversion and&#xA;&#x9;&#x9;hv.id_administrador_inversion = h.id_administrador_inversion and dbo.periodosanteriores(h.id_periodo,2) = hv.id_periodo and&#xA;&#x9;&#x9;h.id_compania_inversion = hv.id_compania_inversion &#xA;&#x9;&#x9;where  datediff(dd,hv.fecha_cotizacion_inversiones,h.fecha_cotizacion_inversiones) &lt;&gt; 0 and hv.imp_unitario_inversion_dolar &gt; 0&#xA;&#x9;&#x9;and h.id_tipo_liquidez_inversion = 1 and hv.id_marca_ultimo_dia_mes = 1  and  h.imp_unitario_inversion_dolar &gt; 0&#xA;&#x9;group by h.fecha_cotizacion_inversiones,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion,h.id_compania_inversion&#xA;) A&#xA;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion &#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.fecha_cotizacion_inversiones = h.fecha_cotizacion_inversiones&#xA;and a.id_compania_inversion = h.id_compania_inversion&#xA;&#xA;&#xA;-- Para los instrumentos que aun no tienen mas de un mes se toma la fecha minima donde tiene valor en ese periodo &#xA;select h.id_periodo,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion,&#xA;cast('1900-01-01' as date) as fecha,cast(0.0 as decimal(18,6)) as importe &#xA;into #temp_calculo_tna_m_dolar&#xA;from h_inversiones h &#xA;where h.id_tipo_liquidez_inversion = 1 and tna_mensual = 0 and imp_unitario_inversion &lt;&gt; 0 and cant_total_inversion &lt;&gt; 0&#xA;group by  h.id_periodo,h.id_rubro_inversion, h.id_instrumento_inversion,h.id_administrador_inversion, h.id_compania_inversion&#xA;&#xA;UPDATE #temp_calculo_tna_m_dolar&#xA;SET fecha = (SELECT MIN(fecha_cotizacion_inversiones) &#xA;&#x9;&#x9;&#x9;FROM h_inversiones H INNER JOIN #temp_calculo_tna_m_dolar A on h.id_rubro_inversion = a.id_rubro_inversion&#xA;&#x9;&#x9;&#x9;and h.id_instrumento_inversion = a.id_instrumento_inversion and h.id_compania_inversion = a.id_compania_inversion&#xA;&#x9;&#x9;&#x9;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;&#x9;&#x9;&#x9;AND H.id_periodo = A.id_periodo&#xA;&#x9;&#x9;&#x9;WHERE imp_unitario_inversion &lt;&gt; 0 )&#xA;&#xA;&#xA;&#xA;-- Pega el importe de inicio para los instrumentos que no llegan a un mes&#xA;update #temp_calculo_tna_m_dolar&#xA;set importe = imp_unitario_inversion_dolar&#xA;from #temp_calculo_tna_m_dolar a inner join h_inversiones h on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion and h.id_compania_inversion = a.id_compania_inversion&#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.fecha = h.fecha_cotizacion_inversiones AND H.id_periodo = A.id_periodo&#xA;where cant_total_inversion &lt;&gt; 0 AND fecha &lt;&gt; '1900-01-01'&#xA;-- Calcula la tna mensual para estos casos &#xA;&#xA;update h_inversiones&#xA;set tna_mensual_dolar= ((h.imp_unitario_inversion_dolar /a.importe) - 1  / datediff(dd,a.fecha,h.fecha_cotizacion_inversiones)*30)&#xA;from h_inversiones h inner join #temp_calculo_tna_m_dolar a&#xA;on h.id_rubro_inversion = a.id_rubro_inversion&#xA;and h.id_instrumento_inversion = a.id_instrumento_inversion &#xA;and h.id_administrador_inversion = a.id_administrador_inversion &#xA;and a.id_periodo = h.id_periodo and a.id_compania_inversion = h.id_compania_inversion&#xA;where tna_mensual= 0 and h.cant_total_inversion &lt;&gt; 0 and h.imp_unitario_inversion &lt;&gt; 0 and (datediff(dd,a.fecha,h.fecha_cotizacion_inversiones) &lt;&gt; 0 and a.importe-1 &lt;&gt; 0 and a.importe &lt;&gt; 0  )&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\inserta H_BALANCE_INVERSIONES"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{a9e18732-6cb5-4021-9e89-2217fcd2ada2}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="inserta H_BALANCE_INVERSIONES"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="delete from H_BALANCE_INVERSIONES &#xA;&#xA;insert into H_BALANCE_INVERSIONES&#xA;select id_periodo,fecha_balance,id_concepto_balance,c.id_compania_inversion,importe_balance from AUX_H_BALANCE_INVERSIONES a&#xA;inner join D_CONCEPTO_BALANCE d on a.concepto_balance = d.de_concepto_balance&#xA;inner join D_COMPANIA_INVERSION c on a.id_compania_inversiones = c.de_compania_inversion&#xA;where id_periodo is not null&#xA;&#xA;&#xA;insert into h_balance_inversiones&#xA;select DISTINCT id_periodo,'1900-01-01',5,1,1 &#xA;from h_balance_inversiones &#xA;&#xA;&#xA;insert into h_balance_inversiones&#xA;select DISTINCT id_periodo,'1900-01-01',4,1,1 &#xA;from h_balance_inversiones &#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Mueve XLS a Historico"
      DTS:CreationName="Microsoft.FileSystemTask"
      DTS:Description="Tarea Sistema de archivos"
      DTS:DTSID="{BF0661FD-98A2-4489-A9E0-BBE36CA11E47}"
      DTS:ExecutableType="Microsoft.FileSystemTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Mueve XLS a Historico"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <FileSystemData
          TaskOperationType="MoveFile"
          TaskOverwriteDestFile="True"
          TaskSourcePath="{E57C0FE8-854B-4BD2-9BD0-7B7C00AEDE5C}"
          TaskDestinationPath="{31EE885E-1B8E-40CF-AC5A-B62048E9393A}" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Notificacion fallo"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{b9befe42-d950-47b4-9b7a-ad0486cccf93}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Notificacion fallo"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{26CC06B3-8F11-44E5-8852-0489F0CF0750}"
          SQLTask:SqlStatementSource="&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'david.angeletti@sancorsalud.com.ar;maximiliano.olmedo@sancorsalud.com.ar; Hugo.Valler@sancorsalud.com.ar ; German.Scarafia@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Data Inversiones Ejecucion Fallida Comprobar Excel',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'El proceso no pudo cargar el excel correctamente,comprobar que el excel se encuentre cerrado si lo esta, comunicarse con planeamiento y control de gestion. Interno: 3086 ',&#xA;&#x9;&#x9;&#x9;&#x9;@query = '',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{70255D5F-7528-42F8-BD22-124CB13A9264}"
      DTS:From="Package\AUX_H_INVERSIONES"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{9C770E92-E165-4980-B53B-E2CBD6C27FE4}"
      DTS:From="Package\Borrar Auxiliares"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\AUX_H_INVERSIONES" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 11]"
      DTS:CreationName=""
      DTS:DTSID="{58820A22-3B04-4A5B-AAFB-05A321545B11}"
      DTS:From="Package\Actualiza H_INVERSIONES"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 11"
      DTS:To="Package\Envia mail Tras fallo"
      DTS:Value="1" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 12]"
      DTS:CreationName=""
      DTS:DTSID="{D66F2BED-079D-4CB4-8295-E2CC5966C5A1}"
      DTS:From="Package\Actualiza tablas de Dimensión"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 12"
      DTS:To="Package\Inserta en la h" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{20C28EA6-B16A-478E-90FA-1BF11F562745}"
      DTS:From="Package\Actualiza Aux"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Actualiza tablas de Dimensión" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{850E8088-6CA9-4147-B65E-8EDBED43FB18}"
      DTS:From="Package\Copia XLS a Local"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\Borrar Auxiliares" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{9241552A-0A3B-4D09-919B-0CB6A79615D2}"
      DTS:From="Package\Envio de mail Tras finalizacion correcta"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\Mueve XLS a Historico" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{AA6E510C-8A1D-4B49-9279-8AD95B393C5C}"
      DTS:From="Package\AUX_H_INVERSIONES"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\Notificacion fallo"
      DTS:Value="1" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{7926B323-9A8E-43E0-8B60-0070C70F8D70}"
      DTS:From="Package\Envia mail Tras fallo"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\Mueve XLS a Historico" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 8]"
      DTS:CreationName=""
      DTS:DTSID="{E2D10956-EE0C-4A21-B11D-07B22CBC3BC3}"
      DTS:From="Package\Inserta en la h"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 8"
      DTS:To="Package\Actualiza H_INVERSIONES" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 9]"
      DTS:CreationName=""
      DTS:DTSID="{FE53F627-D8BF-4F13-A587-DD07AD6C7BD5}"
      DTS:From="Package\Inserta en la h"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 9"
      DTS:To="Package\Envia mail Tras fallo"
      DTS:Value="1" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restricción]"
      DTS:CreationName=""
      DTS:DTSID="{07EF5684-41E3-4F9D-8C06-5AC8341EA127}"
      DTS:From="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restricción"
      DTS:To="Package\AUX_H_BALANCE_INVERSIONES" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restricción 1]"
      DTS:CreationName=""
      DTS:DTSID="{73D000D3-9A00-41E8-A9A9-E66634A35460}"
      DTS:From="Package\AUX_H_BALANCE_INVERSIONES"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restricción 1"
      DTS:To="Package\Actualiza Aux" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restricción 2]"
      DTS:CreationName=""
      DTS:DTSID="{B4B83073-BBF4-4BFB-9A6C-9E2293080B76}"
      DTS:From="Package\Actualiza H_INVERSIONES"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restricción 2"
      DTS:To="Package\inserta H_BALANCE_INVERSIONES" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Restricción 3]"
      DTS:CreationName=""
      DTS:DTSID="{44CFC126-1645-4149-BF7A-8C6E48A47186}"
      DTS:From="Package\inserta H_BALANCE_INVERSIONES"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Restricción 3"
      DTS:To="Package\Envio de mail Tras finalizacion correcta" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="146,42"
          Id="Package\Actualiza Aux"
          TopLeft="251.932783018868,419.424922431866" />
        <NodeLayout
          Size="216,42"
          Id="Package\Actualiza H_INVERSIONES"
          TopLeft="64.7452830188679,641.915094339623" />
        <NodeLayout
          Size="226,42"
          Id="Package\Actualiza tablas de Dimensión"
          TopLeft="211.932783018868,495.839819706499" />
        <NodeLayout
          Size="254,42"
          Id="Package\AUX_H_BALANCE_INVERSIONES"
          TopLeft="191.75,339.25" />
        <NodeLayout
          Size="325,42"
          Id="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES"
          TopLeft="162.432783018868,241.010025157233" />
        <NodeLayout
          Size="197,42"
          Id="Package\AUX_H_INVERSIONES"
          TopLeft="226.432783018868,164.5951278826" />
        <NodeLayout
          Size="160,42"
          Id="Package\Borrar Auxiliares"
          TopLeft="244.932783018868,88.1802306079665" />
        <NodeLayout
          Size="170,42"
          Id="Package\Copia XLS a Local"
          TopLeft="239.932783018868,11.7653333333333" />
        <NodeLayout
          Size="178,42"
          Id="Package\Envia mail Tras fallo"
          TopLeft="368.669811320755,834.783018867925" />
        <NodeLayout
          Size="270,42"
          Id="Package\Envio de mail Tras finalizacion correcta"
          TopLeft="55.8396226415094,834.745283018868" />
        <NodeLayout
          Size="148,42"
          Id="Package\Inserta en la h"
          TopLeft="250.932783018868,572.254716981132" />
        <NodeLayout
          Size="262,42"
          Id="Package\inserta H_BALANCE_INVERSIONES"
          TopLeft="7.5,753.5" />
        <NodeLayout
          Size="191,42"
          Id="Package\Mueve XLS a Historico"
          TopLeft="229.432783018868,923.5" />
        <NodeLayout
          Size="159,42"
          Id="Package\Notificacion fallo"
          TopLeft="7.5,170.424528301887" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="324.932783018868,206.5951278826">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34.4148972746331"
              Start="0,0"
              End="0,26.9148972746331">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.9148972746331" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="324.932783018868,130.180230607966">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34.4148972746331"
              Start="0,0"
              End="0,26.9148972746331">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.9148972746331" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 11]"
          TopLeft="207.411949685535,683.915094339623">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="221.924528301887,150.867924528302"
              Start="0,0"
              End="221.924528301887,143.367924528302">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,71.2878469330246" />
                  <mssgle:CubicBezierSegment
                    Point1="0,71.2878469330246"
                    Point2="0,75.2878469330246"
                    Point3="4,75.2878469330246" />
                  <mssgle:LineSegment
                    End="217.924528301887,75.2878469330246" />
                  <mssgle:CubicBezierSegment
                    Point1="217.924528301887,75.2878469330246"
                    Point2="221.924528301887,75.2878469330246"
                    Point3="221.924528301887,79.2878469330246" />
                  <mssgle:LineSegment
                    End="221.924528301887,143.367924528302" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="99.4335727446936,80.2878469330246,30.4826953125,9.7490234375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 12]"
          TopLeft="324.932783018868,537.839819706499">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34.4148972746332"
              Start="0,0"
              End="0,26.9148972746332">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.9148972746332" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="324.932783018868,461.424922431866">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34.4148972746331"
              Start="0,0"
              End="0,26.9148972746331">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.9148972746331" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="324.932783018868,53.7653333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,34.4148972746331"
              Start="0,0"
              End="0,26.9148972746331">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26.9148972746331" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="190.839622641509,876.745283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="103.593160377358,46.7547169811321"
              Start="0,0"
              End="103.593160377358,39.2547169811321">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.8197848703932" />
                  <mssgle:CubicBezierSegment
                    Point1="0,23.8197848703932"
                    Point2="0,27.8197848703932"
                    Point3="4,27.8197848703932" />
                  <mssgle:LineSegment
                    End="99.593160377358,27.8197848703932" />
                  <mssgle:CubicBezierSegment
                    Point1="99.593160377358,27.8197848703932"
                    Point2="103.593160377358,27.8197848703932"
                    Point3="103.593160377358,31.8197848703932" />
                  <mssgle:LineSegment
                    End="103.593160377358,39.2547169811321" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="226.432783018868,188.509828092243">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-59.9327830188679,0"
              Start="0,0"
              End="-52.4327830188679,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-52.4327830188679,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-41.4577391656839,5,30.4826953125,9.7490234375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="457.669811320755,876.783018867925">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-102.237028301887,46.7169811320755"
              Start="0,0"
              End="-102.237028301887,39.2169811320755">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.7973314524187" />
                  <mssgle:CubicBezierSegment
                    Point1="0,23.7973314524187"
                    Point2="0,27.7973314524187"
                    Point3="-4,27.7973314524187" />
                  <mssgle:LineSegment
                    End="-98.237028301887,27.7973314524187" />
                  <mssgle:CubicBezierSegment
                    Point1="-98.237028301887,27.7973314524187"
                    Point2="-102.237028301887,27.7973314524187"
                    Point3="-102.237028301887,31.7973314524187" />
                  <mssgle:LineSegment
                    End="-102.237028301887,39.2169811320755" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 8]"
          TopLeft="301.599449685535,614.254716981132">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-128.854166666667,27.660377358491"
              Start="0,0"
              End="-128.854166666667,20.160377358491">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,7.24165069115143" />
                  <mssgle:CubicBezierSegment
                    Point1="0,7.24165069115143"
                    Point2="0,11.2416506911514"
                    Point3="-4,11.2416506911514" />
                  <mssgle:LineSegment
                    End="-124.854166666667,11.2416506911514" />
                  <mssgle:CubicBezierSegment
                    Point1="-124.854166666667,11.2416506911514"
                    Point2="-128.854166666667,11.2416506911514"
                    Point3="-128.854166666667,15.2416506911514" />
                  <mssgle:LineSegment
                    End="-128.854166666667,20.160377358491" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 9]"
          TopLeft="348.266116352201,614.254716981132">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="137.737028301887,220.528301886793"
              Start="0,0"
              End="137.737028301887,213.028301886793">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,106.509218696271" />
                  <mssgle:CubicBezierSegment
                    Point1="0,106.509218696271"
                    Point2="0,110.509218696271"
                    Point3="4,110.509218696271" />
                  <mssgle:LineSegment
                    End="133.737028301887,110.509218696271" />
                  <mssgle:CubicBezierSegment
                    Point1="133.737028301887,110.509218696271"
                    Point2="137.737028301887,110.509218696271"
                    Point3="137.737028301887,114.509218696271" />
                  <mssgle:LineSegment
                    End="137.737028301887,213.028301886793" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="57.3398227446935,115.509218696271,30.4826953125,9.7490234375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restricción]"
          TopLeft="321.841391509434,283.010025157233">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,56.239974842767"
              Start="0,0"
              End="0,48.739974842767">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,48.739974842767" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restricción 1]"
          TopLeft="321.841391509434,381.25">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,38.174922431866"
              Start="0,0"
              End="0,30.674922431866">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.674922431866" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restricción 2]"
          TopLeft="138.289308176101,683.915094339623">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,69.584905660377"
              Start="0,0"
              End="0,62.084905660377">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,62.084905660377" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Restricción 3]"
          TopLeft="138.5,795.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="52.3396226415094,39.245283018868"
              Start="0,0"
              End="52.3396226415094,31.745283018868">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.6226415094341" />
                  <mssgle:CubicBezierSegment
                    Point1="0,15.6226415094341"
                    Point2="0,19.6226415094341"
                    Point3="4,19.6226415094341" />
                  <mssgle:LineSegment
                    End="48.3396226415094,19.6226415094341" />
                  <mssgle:CubicBezierSegment
                    Point1="48.3396226415094,19.6226415094341"
                    Point2="52.3396226415094,19.6226415094341"
                    Point3="52.3396226415094,23.6226415094341" />
                  <mssgle:LineSegment
                    End="52.3396226415094,31.745283018868" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\AUX_H_BALANCE_INVERSIONES">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="144,42"
          Id="Package\AUX_H_BALANCE_INVERSIONES\Excel Source"
          TopLeft="31.7311320754717,5.5" />
        <NodeLayout
          Size="177,42"
          Id="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination"
          TopLeft="15.2311320754717,115.349056603774" />
        <EdgeLayout
          Id="Package\AUX_H_BALANCE_INVERSIONES.Paths[Excel Source Output]"
          TopLeft="103.731132075472,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,67.8490566037736"
              Start="0,0"
              End="0,60.3490566037736">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,60.3490566037736" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\AUX_H_BALANCE_INVERSIONES\Excel Source">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\AUX_H_BALANCE_INVERSIONES\OLE DB Destination">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="144,42"
          Id="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source"
          TopLeft="31.7311320754717,5.5" />
        <NodeLayout
          Size="177,42"
          Id="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination"
          TopLeft="15.2311320754717,115.349056603774" />
        <EdgeLayout
          Id="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES.Paths[Excel Source Output]"
          TopLeft="103.731132075472,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,67.8490566037736"
              Start="0,0"
              End="0,60.3490566037736">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,60.3490566037736" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\Excel Source">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\AUX_H_COTIZACION_MONEDA_INVERSIONES\OLE DB Destination">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\AUX_H_INVERSIONES">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="177,42"
          Id="Package\AUX_H_INVERSIONES\OLE DB Destination"
          TopLeft="7.67295597484276,181.084905660377" />
        <NodeLayout
          Size="144,42"
          Id="Package\AUX_H_INVERSIONES\Excel Source"
          TopLeft="24.1729559748428,5.5" />
        <NodeLayout
          Size="161,42"
          Id="Package\AUX_H_INVERSIONES\Data Conversion"
          TopLeft="15.6729559748428,93.2924528301887" />
        <EdgeLayout
          Id="Package\AUX_H_INVERSIONES.Paths[Excel Source Output]"
          TopLeft="96.1729559748428,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,45.7924528301887"
              Start="0,0"
              End="0,38.2924528301887">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38.2924528301887" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\AUX_H_INVERSIONES.Paths[Data Conversion Output]"
          TopLeft="96.1729559748428,135.292452830189">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,45.7924528301887"
              Start="0,0"
              End="0,38.2924528301887">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38.2924528301887" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\AUX_H_INVERSIONES\OLE DB Destination">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>