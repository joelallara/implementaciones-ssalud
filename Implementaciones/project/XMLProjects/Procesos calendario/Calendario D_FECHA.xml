<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="4/7/2014 11:27:36 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="AMS06"
  DTS:CreatorName="AMS\adminb"
  DTS:DTSID="{276DECEC-8FC5-47E9-8B49-9DEA1467A5C4}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="11274"
  DTS:ObjectName="Calendario D_FECHA"
  DTS:PackageType="5"
  DTS:VersionBuild="12"
  DTS:VersionGUID="{E2557ABF-AF30-4347-966A-014D7F82DCAA}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{FCB64DCF-4FD3-4848-8DCC-219A1A9B9D5B}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">1,7,OnError</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{FCB64DCF-4FD3-4848-8DCC-219A1A9B9D5B}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Actualiza D_FECHA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{69692532-4B12-442E-8C8D-8B161DD8DAEC}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza D_FECHA"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3BE99828-8109-4A1B-AE2C-93BA993956A4}"
          SQLTask:SqlStatementSource="/* Inserto Ultima Fecha - Posterior a la ultima cargada en tabla D_FECHA */&#xA;&#xA;INSERT INTO D_FECHA (id_fecha, de_fecha)&#xA;SELECT DateAdd(day, 1, id_fecha), '1900-01-01' as de_fecha&#xA;FROM D_FECHA&#xA;WHERE id_fecha in (select max(id_fecha) from d_fecha)&#xA;&#xA;&#xA;/* En este paso, ya con la Ultima Fecha actualizada, le pego su CHAR correspondiente */&#xA;&#xA;UPDATE D_FECHA&#xA;SET de_fecha = Replace((case when CAST(DatePart(day, id_fecha) as CHAR(2)) &lt; 10 then '0'+CAST(DatePart(day, id_fecha) as CHAR(2)) else CAST(DatePart(day, id_fecha) as CHAR(2)) end),' ','')+'/'+ Replace((case when CAST(DatePart(month, id_fecha) as CHAR(2)) &lt; 10 then '0'+CAST(DatePart(month, id_fecha) as CHAR(2)) else CAST(DatePart(month, id_fecha) as CHAR(2)) end),' ','')&#x9; +'/'+ CAST(DatePart(year, id_fecha) as CHAR(4))&#xA;WHERE id_fecha in (select max(id_fecha) from d_fecha)&#xA;&#xA;&#xA;UPDATE D_FECHA&#xA;SET id_dia_habil = 1&#xA;/*---------------------------------------------------*/&#xA;UPDATE D_FECHA&#xA;SET id_dia_habil = 0&#xA;WHERE DATEPART(weekday,id_FECHA) in (7,1)&#xA;/*---------------------------------------------------*/&#xA;UPDATE D_FECHA&#xA;SET id_dia_habil = 0&#xA;WHERE id_fecha in (select id_fecha from D_CC_DIA_NO_LABORAL)&#xA;&#xA;&#xA;/* Actualiza id_periodo en D_FECHA. */&#xA;&#x9;UPDATE D_FECHA SET id_periodo = SUBSTRING(de_fecha,7,10)+SUBSTRING(de_fecha,4,2)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Controla Fecha a Cargar"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{FB117AFD-4B8B-43F1-9096-75F932E6962D}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Controla Fecha a Cargar"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server v9; © 2004 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{3BE99828-8109-4A1B-AE2C-93BA993956A4}"
          SQLTask:SqlStatementSource="declare @Fecha_Hoy  datetime&#xA;&#xA;set @Fecha_Hoy = CAST(DatePart(year, GETDATE()) as CHAR(4))&#x9;+'-'+&#x9;Replace((case when CAST(DatePart(month, GETDATE()) as CHAR(2)) &lt; 10 then '0'+CAST(DatePart(month, GETDATE()) as CHAR(2)) else CAST(DatePart(month, GETDATE()) as CHAR(2)) end),' ','')&#x9; +'-'+&#x9;Replace((case when CAST(DatePart(day, GETDATE()) as CHAR(2)) &lt; 10 then '0'+CAST(DatePart(day, GETDATE()) as CHAR(2)) else CAST(DatePart(day, GETDATE()) as CHAR(2)) end),' ','')&#xA;&#xA;If @Fecha_Hoy = (Select max(id_fecha) from D_FECHA)&#xA;RAISERROR ('Fecha ya actualizada en D_FECHA', 16, 1)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{5DA6EE99-B7D8-4A38-BC13-4BC0F3E2AB13}"
      DTS:From="Package\Controla Fecha a Cargar"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Actualiza D_FECHA" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="178,42"
          Id="Package\Actualiza D_FECHA"
          TopLeft="18.4811320754717,110.330188679245" />
        <NodeLayout
          Size="200,42"
          Id="Package\Controla Fecha a Cargar"
          TopLeft="5.5,5.5" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="106.490566037736,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,62.8301886792453"
              Start="0,0"
              End="0,55.3301886792453">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,55.3301886792453" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>