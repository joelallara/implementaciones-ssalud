<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="4/27/2017 9:40:31 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="AMS06X"
  DTS:CreatorName="AMS\nprida"
  DTS:DTSID="{6E10AE1F-A742-4BB2-9AC6-4208C91528A8}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1301.433"
  DTS:LocaleID="11274"
  DTS:ObjectName="Comercial_PROYECTO_EMPRESAS"
  DTS:PackageType="5"
  DTS:VersionBuild="39"
  DTS:VersionGUID="{A96CFF8A-AF28-4FC7-B08A-208AEBB8C004}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="DS_MSDB"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{D8E1FB50-BCAF-47BF-B29B-802788848DB1}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:Property
      DTS:DataType="8"
      DTS:Name="EventFilter">1,7,OnError</DTS:Property>
    <DTS:Property
      DTS:EventName="OnError"
      DTS:Name="ColumnFilter">
      <DTS:Property
        DTS:Name="Computer">-1</DTS:Property>
      <DTS:Property
        DTS:Name="Operator">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceName">-1</DTS:Property>
      <DTS:Property
        DTS:Name="SourceID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="ExecutionID">-1</DTS:Property>
      <DTS:Property
        DTS:Name="MessageText">-1</DTS:Property>
      <DTS:Property
        DTS:Name="DataBytes">-1</DTS:Property>
    </DTS:Property>
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{D8E1FB50-BCAF-47BF-B29B-802788848DB1}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Actualiza D_EMPRESAS e Historial_marca_interes_comercial"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{8C8ECDB8-5722-40E5-925F-EADF78ECA2A0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualiza D_EMPRESAS e Historial_marca_interes_comercial"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C58967E1-D6E6-45BE-BAEB-DD39AA465CE7}"
          SQLTask:SqlStatementSource="update D_EMPRESAS&#xA;set id_marca_interes_comercial = ES_DE_INTERES_COMERCIAL&#xA;from HOST03.HOST03.EMPRESA.EMPRESAS  E inner join D_EMPRESAS d on&#xA;&#x9;e.id = d.id_empresa &#xA;&#x9;where Id_Tipo_Entidad = 'E'&#xA;&#xA;update D_EMPRESAS&#xA;SET id_marca_interes_comercial = 'N'&#xA;where id_marca_interes_comercial is null &#xA;&#xA;declare @Periodo int set @Periodo = (select MAX(id_periodo) from AUX_PERIODO_MES_BORRA)&#xA;insert into AUX_HISTORIAL_EMPRESAS_INTERES_COMERCIAL&#xA;select @periodo as id_periodo, id as id_empresa, es_de_interes_comercial as id_marca_interes_comercial  &#xA;from AS400.HOST03.EMPRESA.EMPRESAS  E &#xA;--where @Periodo not in (select id_periodo from AUX_HISTORIAL_EMPRESAS_INTERES_COMERCIAL)&#xA;&#xA;&#xA;TRUNCATE TABLE AUX_H_COMER_STOCK_AFILIA_PE&#xA;&#xA;declare @periodo_max int = (select  max(id_periodo) from [H_COMER_STOCK_AFILIA])&#xA;declare @periodo_min int = dbo.periodosanteriores(@periodo_max,2)&#xA;&#xA;-- Alamaceno aquellas empresas que sufrieron un cambio de marca&#xA;insert into  AUX_H_COMER_STOCK_AFILIA_PE&#xA;select id_empresa, count(distinct id_marca_interes_comercial) as marca , '   ' as tipocambio &#xA;from AUX_HISTORIAL_EMPRESAS_INTERES_COMERCIAL where id_periodo &gt;= @periodo_min &#xA;group by id_empresa &#xA;having count(distinct id_marca_interes_comercial) &gt; 1&#xA;&#xA;-- Alamaceno que tipo de cambion sufrieron NaS = de no a si y SaN = de si a no&#xA;update AUX_H_COMER_STOCK_AFILIA_PE&#xA;set tipocambio = case when a.id_marca_interes_comercial = 'S' then 'NaS'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  when a.id_marca_interes_comercial = 'N' then 'SaN' end&#xA;from AUX_H_COMER_STOCK_AFILIA_PE t  inner join AUX_HISTORIAL_EMPRESAS_INTERES_COMERCIAL a on t.id_empresa_facturacion = a.id_empresa&#xA;and a.id_periodo = @periodo_max&#xA;&#xA;&#xA;&#xA;-- borra aquellas empresas que no aparecen en stock&#xA;&#xA;delete from AUX_H_COMER_STOCK_AFILIA_PE where id_empresa_facturacion not in (select id_empresa_facturacion from h_comer_stock_afilia)&#xA;&#xA;-- Borra las que aparecen solo en un stock&#xA;delete from AUX_H_COMER_STOCK_AFILIA_PE where id_empresa_facturacion in (select id_empresa_facturacion from h_comer_stock_afilia&#xA; where id_empresa_facturacion in (select id_empresa_facturacion from AUX_H_COMER_STOCK_AFILIA_PE)&#xA;group by id_empresa_facturacion&#xA;having count(distinct id_periodo) = 1)&#xA;&#xA;delete from AUX_H_COMER_STOCK_AFILIA_PE where id_empresa_facturacion not in (select id_empresa_facturacion from H_COMER_STOCK_AFILIA where id_periodo = @periodo_max)&#xA;delete from AUX_H_COMER_STOCK_AFILIA_PE where id_empresa_facturacion not in (select id_empresa_facturacion from H_COMER_STOCK_AFILIA where id_periodo = @periodo_min)&#xA;&#xA;IF (select count(id_empresa_facturacion) from AUX_H_COMER_STOCK_AFILIA_PE ) &gt;1&#xA;begin &#xA;&#x9;EXEC msdb.dbo.sp_send_dbmail&#xA;&#x9;&#x9;&#x9;&#x9;@profile_name = 'Soporte Microstrategy',&#xA;&#x9;&#x9;&#x9;&#x9;@recipients = 'matias.paludi@sancorsalud.com.ar; nicolas.prida@sancorsalud.com.ar',&#xA;&#x9;&#x9;&#x9;&#x9;@subject = 'Cambio de marca de interes comercial',&#xA;&#x9;&#x9;&#x9;&#x9;@body = 'Esisten empresa quen han cambiado su marca de interes comercial',&#xA;&#x9;&#x9;&#x9;&#x9;@query = 'select * from AUX_H_COMER_STOCK_AFILIA_PE',&#xA;&#x9;&#x9;&#x9;&#x9;@query_result_separator = '|',&#xA;&#x9;&#x9;&#x9;&#x9;@execute_query_database = 'DW_SALUD';&#xA;end" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualizacion en H_ALTAS_GENUINAS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{963D9FA9-94A3-4B7A-A9A1-16F8DFD56F29}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualizacion en H_ALTAS_GENUINAS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C58967E1-D6E6-45BE-BAEB-DD39AA465CE7}"
          SQLTask:SqlStatementSource="&#xA;/* Actualiza Empresas Nuevo en H_ALTAS_GENUINAS. */&#xA;&#xA;&#x9;declare @Periodo int set @Periodo = (select MAX(id_periodo) from AUX_PERIODO_MES_BORRA)&#xA;&#xA;&#x9;UPDATE H_ALTAS_GENUINAS&#xA;&#x9;&#x9;set id_factura_A_E = S.id_factura_A_E,&#xA;&#x9;&#x9;&#x9;id_empresa_PE = S.id_empresa_PE,&#xA;&#x9;&#x9;&#x9;id_tipo_entidad_PE = S.id_tipo_entidad_PE,&#xA;&#x9;&#x9;&#x9;id_marca_PE = S.id_marca_PE,&#xA;&#x9;&#x9;&#x9;id_convenio_especial = S.id_convenio_especial&#xA;&#x9;FROM H_COMER_STOCK_AFILIA S&#xA;&#x9;LEFT JOIN H_ALTAS_GENUINAS A on (A.afiliado = S.afiliado and A.subnumero = S.subnumero and A.id_persona = S.id_persona and A.id_periodo = S.id_periodo)&#xA;&#x9;WHERE A.id_periodo = @Periodo &#xA;&#x9;&#xA;&#x9;&#xA;&#x9;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualizacion en H_BAJAS_GENUINAS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{2E0C8708-D672-436D-8F8B-ED1CAE8F9B4B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualizacion en H_BAJAS_GENUINAS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C58967E1-D6E6-45BE-BAEB-DD39AA465CE7}"
          SQLTask:SqlStatementSource="&#xA;/* Actualiza Empresas Nuevo en H_BAJAS_GENUINAS. */&#xA;&#xA;&#x9;Declare @Periodo int set @Periodo = (select MAX(id_periodo) from AUX_PERIODO_MES_BORRA)&#xA;&#xA;&#x9;UPDATE H_BAJAS_GENUINAS&#xA;&#x9;&#x9;set id_factura_A_E = S.id_factura_A_E,&#xA;&#x9;&#x9;&#x9;id_empresa_PE = S.id_empresa_PE,&#xA;&#x9;&#x9;&#x9;id_tipo_entidad_PE = S.id_tipo_entidad_PE,&#xA;&#x9;&#x9;&#x9;id_marca_PE = S.id_marca_PE,&#xA;&#x9;&#x9;&#x9;id_convenio_especial = S.id_convenio_especial&#xA;&#x9;FROM H_COMER_STOCK_AFILIA S&#xA;&#x9;LEFT JOIN H_BAJAS_GENUINAS A on (A.afiliado = S.afiliado and A.subnumero = S.subnumero and A.id_persona = S.id_persona)&#xA;&#x9;JOIN TRANS_PERIODO T on (A.id_periodo = T.id_periodo and S.id_periodo = T.ID_PERIODO_ANTERIOR)&#xA;&#x9;where A.id_periodo = @Periodo &#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualizacion en H_COMER_STOCK_AFILIA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{1BD7CC90-ABB5-4D7C-866D-C1EA3B8278DA}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualizacion en H_COMER_STOCK_AFILIA"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C58967E1-D6E6-45BE-BAEB-DD39AA465CE7}"
          SQLTask:SqlStatementSource="declare @Periodo int set @Periodo = (select MAX(id_periodo) from AUX_PERIODO_MES_BORRA)&#xA;&#xA;UPDATE H_COMER_STOCK_AFILIA &#xA;&#x9;&#x9;SET id_factura_A_E = W20PFA,&#xA;&#x9;&#x9;id_empresa_PE = case &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (W20PFA = 'A') then WL7GPO&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else W20CPF end,&#xA;&#x9;&#x9;Id_Tipo_Entidad_PE = case &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when W20PFA = 'E' then 'E' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (W20PFA = 'A' and WL7GPO not in (0)) then 'G'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else 'I' end,&#xA;&#x9;&#x9;id_marca_PE = case when (W20PFA = 'A' and WL7GPO in (254,324,472,641,689,691,719,723)) then 1  -- TarjCred/CBU &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   when (W20PFA = 'A' and WL7GPO not in (254,324,472,641,689,691,719,723,0)) then 8 end,--Grupo Afinidad Otros&#xA;&#x9;&#x9;id_empresa_facturacion = 0,&#xA;&#x9;&#x9;Id_Tipo_Entidad_facturacion = 'I'&#xA;&#x9;from H_COMER_STOCK_AFILIA H left join dw_salud.dbo.AUX_COMER_PROYECTO_EMPRESAS T on (T.W20NAF = H.afiliado and T.W20SAF = H.subnumero)&#xA;&#x9;where H.id_periodo = @Periodo&#xA;&#xA;&#xA;&#x9;-- Se pasa a la empresa a la cual se factura al id_empresa_facturacion&#xA;&#xA;&#x9;update H_COMER_STOCK_AFILIA&#xA;&#x9;set id_empresa_facturacion =  id_empresa_PE,&#xA;&#x9;&#x9;id_tipo_entidad_facturacion = 'E'&#x9;&#xA;&#x9;where  id_factura_A_E = 'E' and id_periodo = @Periodo &#xA;&#xA;&#xA;/* ACTUALIZAMOS SINDICALES */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;SET&#x9;id_marca_PE = case when ((id_subproducto in (84,--OSCONARA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;42, --OSME&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;40, --OSUTI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;85, --OSCICA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;75, --OSTEL&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;86, --FRUTOS DEL PAIS&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;87, --OSMAD&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;91, --OSDIC&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;94, --OSPIQYP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;97) --OSPEGAP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR id_producto IN (83, --OSCONARA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   68, --OSTEL&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   93, --OSPIQYP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   95)--OSPEGAP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR (id_producto = 44 and id_subproducto = 96)) --OSPEGAP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and Id_Tipo_Entidad_PE not in ('G')) then 6 --Sindicales&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  /* este caso de OSPACA es uno de los casos raros de comercial, en realidad es sindical, pero se quiere analizar por fuera, si se ve el dato&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  en la tabla figura con una marca distinta a la sindical pero sigue teniendo ID de convenio. */&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  else id_marca_PE end&#xA;&#x9;FROM H_COMER_STOCK_AFILIA H join DW_SALUD.dbo.D_EMPRESAS E on (E.id_empresa = H.id_empresa_PE and E.Id_Tipo_Entidad = H.Id_Tipo_Entidad_PE)&#xA;&#x9;WHERE Id_Tipo_Entidad_PE not in ('G') and H.id_periodo = @Periodo&#xA;&#xA;&#xA;/* Categorización por cantidad de asociados solo para los asociados que se le factura a empresa METODO NUEVO&#xA;&#x9;y por si tiene o no interes comercial */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;SET id_marca_PE = case &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when Res.CantPers between 0 and 100 and d.id_marca_interes_comercial = 'S' then 2 -- Pyme&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when Res.CantPers between 101 and 1000 and d.id_marca_interes_comercial = 'S' then 3 --Mediana&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when Res.CantPers &gt; 1000 and d.id_marca_interes_comercial = 'S' then 4 --Grande&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when d.id_marca_interes_comercial = 'N' or d.id_marca_interes_comercial is null then 7 -- Individual&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  else id_marca_PE end,&#xA;&#x9;&#x9;Id_Tipo_Entidad_PE =  case when  d.id_marca_interes_comercial = 'N' or d.id_marca_interes_comercial is null then 'I' else Id_Tipo_Entidad_PE end,&#xA;&#x9;&#x9;id_empresa_PE =  case when  d.id_marca_interes_comercial = 'N' or d.id_marca_interes_comercial is null then 0  else h.id_empresa_PE end&#xA;&#x9;FROM H_COMER_STOCK_AFILIA H &#xA;&#x9;inner join dw_salud.dbo.D_EMPRESAS d on h.id_empresa_PE = d.id_empresa and H.id_tipo_entidad_PE = d.Id_Tipo_Entidad &#xA;&#x9;INNER JOIN (SELECT id_empresa_PE, COUNT(distinct id_persona) as CantPers&#xA;&#x9;&#x9;&#x9;&#x9;from H_COMER_STOCK_AFILIA&#xA;&#x9;&#x9;&#x9;&#x9;where id_factura_A_E = 'E' and id_periodo = @Periodo &#xA;&#x9;&#x9;&#x9;&#x9;group by id_empresa_PE) AS Res&#xA;&#x9;ON (H.id_empresa_PE=Res.id_empresa_PE)&#xA;&#x9;WHERE id_factura_A_E = 'E' and id_periodo = @Periodo &#xA;&#x9;and  H.id_marca_PE is null&#xA;&#xA;&#xA;/* ACTUALIZO DATOS PARA CUANDO SE FACTUDRA AL AFILIADO */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;SET id_marca_PE = 7&#xA;&#x9;WHERE id_factura_A_E = 'A' and id_marca_PE is null and Id_Tipo_Entidad_PE = 'I' and id_periodo = @Periodo&#xA;&#xA;&#x9;/* Sindicales - OSCICA Y MICA - OSMAD Y FEMA&#xA;Estos casos son convenios empresas, lo de OSCICA Y OSMAD se identifica por el subproducto (ya fueron categorizados), en cambio para MICA Y FEMA entran como &#xA;producto gravado, y se identifican por la empresa a la que facturan, 390765 y 390764 */&#xA;/* El convenio de electricistas navales  OSEN se identifica por la empresa 407812, tmb puede hacerce por el producto 88, pero de comercial lo hacer por la empresa&#xA;asi que lo marcamos como sindical a travez de ésta */&#xA;&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;&#x9;set id_marca_PE = 6&#xA;&#x9;WHERE Id_Tipo_Entidad_PE not in ('G') and id_periodo = @Periodo &#xA;&#x9;and &#xA;&#x9;id_empresa_PE in (390764, --FEMA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  390765, --MICA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  407812, --OSEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  414018) --FOSDIC &#xA;&#x9;&#xA;&#xA;&#xA;/* Lo que corresponde a OSCONARA se carga en el stock con un GA, pero no corresponde este analisis, por eso forzamos la categoria de sindical &#xA;a todo lo que tenga prod y aubprod de OSCONARA  y para OSPEGAP*/&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;SET id_marca_PE = 6&#xA;&#x9;WHERE (id_producto = 83 or id_subproducto = 84) and id_periodo = @Periodo&#xA;&#xA;&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;SET id_marca_PE = 6,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;id_tipo_entidad_PE = 'S',&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;id_empresa_pe = 12,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;id_convenio_especial = 12&#xA;&#x9;WHERE id_periodo = @periodo and ((id_subproducto = 97 ) or (id_producto = 44 and id_subproducto = 96))&#xA;&#x9;and id_marca_pe &lt;&gt; 6&#xA;&#xA;/*una vez que tenemos marcados todos los casos que son sindicales, identificamos mediante un ID a cada convenio &#xA;esto se prodría haber hecho antes de pegar la marca de sindical, pero como fue un agregado posterior a ello, quedo de esta forma. */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA &#xA;&#x9;&#x9;set id_convenio_especial = case when id_subproducto = 42 then 1 --OSME&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when id_subproducto = 40 then 2 --OSUTI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 84 OR id_producto = 83) then 3 --OSCONARA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 75 OR id_producto = 68) then 4 --OSTEL &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 85 OR id_empresa_PE = 390765) then 5 --OSCICA - MICA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when id_subproducto = 86 then 6 --FRUTOS DEL PAIS&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 87 OR id_empresa_PE = 390764)then 7 --OSMAD - FEMA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 91 OR id_empresa_PE = 414018)then 10 --OSDIC - FOSDIC&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when id_empresa_PE = 407812 then 9 --OSEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN id_producto = 93 OR id_subproducto = 94 then 11 --OSPIQYP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN (id_producto = 95 OR id_subproducto = 97 OR (id_producto = 44 AND id_subproducto = 96)) THEN 12 --OSPEGAP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else 0 --SIN CONVENIO ESPECIAL &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;WHERE  id_marca_PE = 6 and id_periodo = @Periodo &#xA;&#xA;&#xA;&#xA;/* Se tiene que hacer una actualizacion exclusiva para OSPACA xq no tiene marca sindical (6), pero si deve tener el id de convenio que le corresponde(8) */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;set id_convenio_especial = 8 --OSPACA&#xA;&#x9;WHERE id_marca_PE = 10 --corresponde a la marca de OSPACA&#xA;&#x9;and id_periodo = @Periodo &#xA;-- Lo que queda en null, se pasa a 0 que es el id que no tiene convenio.&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA set id_convenio_especial = 0&#xA;&#x9;WHERE id_convenio_especial is null and id_periodo = @Periodo&#xA;&#xA;&#xA;&#x9;/*Se actualiza la id_empresa_PE = id_convenio_especial de convenios especiales (es igual al id_empresa de la D_EMPRESA cuando el &#xA;id_tipo_entidad = 'S' para aquellos que son convenio especial*/&#xA;&#xA;&#x9;&#x9;update H_COMER_STOCK_AFILIA&#xA;&#x9;&#x9;set id_tipo_entidad_PE = 'S',&#xA;&#x9;&#x9;&#x9;id_empresa_PE = id_convenio_especial&#xA;&#x9;&#x9;from H_COMER_STOCK_AFILIA h &#xA;&#x9;&#x9;where id_marca_PE = 6 and H.id_periodo = @Periodo &#xA;&#xA;&#x9;/* por pedido de comercial (Ramiro) se debe identificar tambien a AMPS, por eso para el producto 18 se creo una marca_PE especial (9) */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;set id_marca_PE = 9 --AMPS&#xA;&#x9;WHERE id_producto = 18 --producto de AMPS &#xA;&#x9;and id_periodo = @Periodo &#xA;&#xA;&#xA;-- PASAMOS TODO A INDIVIDUAL LO QUE QUEDO SIN DATO&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;SET id_factura_A_E = 'A',&#xA;&#x9;&#x9;id_marca_PE = case when id_marca_PE not in (1,2,3,4,5,6,8,9) or id_marca_PE is null then 7&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else id_marca_PE end,&#xA;&#x9;&#x9;id_tipo_entidad_PE = case when id_tipo_entidad_PE = 'S' then 'S' else 'I'end,&#xA;&#x9;&#x9;id_empresa_PE = 0&#xA;&#x9;where id_periodo = @Periodo and (id_factura_A_E IS NULL or id_factura_A_E NOT IN ('A','E'))&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualizacion en H_COMER_STOCK_AFILIA vigente hasta 08-2018"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{39DB3F2E-4355-45E4-9683-1BE66154322C}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualizacion en H_COMER_STOCK_AFILIA vigente hasta 08-2018"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C58967E1-D6E6-45BE-BAEB-DD39AA465CE7}"
          SQLTask:SqlStatementSource="&#xA;declare @Periodo int set @Periodo = (select MAX(id_periodo) from AUX_PERIODO_MES_BORRA)&#xA;&#xA;&#xA;/* DETERMINO SI SE LE FACTURA A AFILIADO O EMPRESA Y PEGO EL ID QUE CORRESPONDA CON EL TIPO DE ENTIDAD */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA &#xA;&#x9;&#x9;SET id_factura_A_E = W20PFA,&#xA;&#x9;&#x9;id_empresa_PE = case &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (W20PFA = 'A') then WL7GPO&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else W20CPF end,&#xA;&#x9;&#x9;Id_Tipo_Entidad_PE = case &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when W20PFA = 'E' then 'E' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (W20PFA = 'A' and WL7GPO not in (0)) then 'G'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else 'I' end,&#xA;&#x9;&#x9;id_marca_PE = case when (W20PFA = 'A' and WL7GPO in (254,324,472,641,689,691,719,723)) then 1  -- TarjCred/CBU &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   when (W20PFA = 'A' and WL7GPO not in (254,324,472,641,689,691,719,723,0)) then 8 end--Grupo Afinidad Otros&#xA;&#x9;from H_COMER_STOCK_AFILIA H left join AUX_COMER_PROYECTO_EMPRESAS T on (T.W20NAF = H.afiliado and T.W20SAF = H.subnumero)&#xA;&#x9;where H.id_periodo = @Periodo&#xA;&#xA;&#xA;/* ACTUALIZAMOS SINDICALES Y SANCOR CUL */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;SET&#x9;id_marca_PE = case when ((id_subproducto in (84,--OSCONARA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;42, --OSME&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;40, --OSUTI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;85, --OSCICA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;75, --OSTEL&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;86, --FRUTOS DEL PAIS&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;87, --OSMAD&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;91, --OSDIC&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;94, --OSPIQYP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;97) --OSPEGAP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR id_producto IN (83, --OSCONARA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   68, --OSTEL&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   93, --OSPIQYP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   95)--OSPEGAP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR (id_producto = 44 and id_subproducto = 96)) --OSPEGAP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and Id_Tipo_Entidad_PE not in ('G')) then 6 --Sindicales&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when  E.cuit_empresa in (30501677643,33640230059,30526323560,30707450475) then 5 --Sancor CUL &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when id_producto = 78 then 10 --OSPACA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  /* este caso de OSPACA es uno de los casos raros de comercial, en realidad es sindical, pero se quiere analizar por fuera, si se ve el dato&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  en la tabla figura con una marca distinta a la sindical pero sigue teniendo ID de convenio. */&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  else id_marca_PE end&#xA;&#x9;FROM H_COMER_STOCK_AFILIA H join DW_SALUD.dbo.D_EMPRESAS E on (E.id_empresa = H.id_empresa_PE and E.Id_Tipo_Entidad = H.Id_Tipo_Entidad_PE)&#xA;&#x9;WHERE Id_Tipo_Entidad_PE not in ('G') and H.id_periodo = @Periodo&#xA;&#xA;&#xA;/* Categorización por cantidad de asociados solo para los asociados que se le factura a empresa */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;SET id_marca_PE = case &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when Res.CantPers &lt; 10 then 7 --Individual&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when Res.CantPers between 10 and 100 then 2 -- Pyme&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when Res.CantPers between 101 and 500 then 3 --Mediana&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  when Res.CantPers &gt; 500 then 4 --Grande&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  else id_marca_PE end,&#xA;&#x9;&#x9;id_factura_A_E = case when Res.CantPers &lt; 10 then 'A' else id_factura_A_E end,&#xA;&#x9;&#x9;Id_Tipo_Entidad_PE = case when Res.CantPers &lt; 10 then 'I' else Id_Tipo_Entidad_PE end,&#xA;&#x9;&#x9;id_empresa_PE = case when Res.CantPers &lt; 10 then 0 else H.id_empresa_PE end &#xA;&#x9;FROM H_COMER_STOCK_AFILIA H &#xA;&#x9;INNER JOIN (SELECT id_empresa_PE, COUNT(distinct id_persona) as CantPers&#xA;&#x9;&#x9;&#x9;&#x9;from H_COMER_STOCK_AFILIA&#xA;&#x9;&#x9;&#x9;&#x9;where id_factura_A_E = 'E' AND id_periodo = @Periodo&#xA;&#x9;&#x9;&#x9;&#x9;group by id_empresa_PE) AS Res&#xA;&#x9;ON (H.id_empresa_PE=Res.id_empresa_PE)&#xA;&#x9;WHERE id_factura_A_E = 'E' and id_periodo = @Periodo and  H.id_marca_PE is null&#xA;&#xA;&#xA;/* ACTUALIZO DATOS PARA CUANDO SE FACTUDRA AL AFILIADO */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;SET id_marca_PE = 7&#xA;&#x9;WHERE id_factura_A_E = 'A' and id_marca_PE is null and Id_Tipo_Entidad_PE = 'I' and id_periodo = @Periodo&#xA;&#xA;&#xA;/* EXCEPCIONES  */&#xA;&#xA;/* Si las empresas corresponden a ramos especificos se analizan como individuales. Y se debe averiguar si tienen GA */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA &#xA;&#x9;&#x9;SET id_factura_A_E = 'A',&#xA;&#x9;&#x9;&#x9;id_empresa_PE = WL7GPO,&#xA;&#x9;&#x9;&#x9;Id_Tipo_Entidad_PE = case when (WL7GPO not in (0)) then 'G'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else 'I' end,&#xA;&#x9;&#x9;&#x9;id_marca_PE = case when (WL7GPO in (254,324,472,641,689,691,719,723)) then 1  -- TarjCred/CBU &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   when (WL7GPO not in (254,324,472,641,689,691,719,723,0)) then 8 --Grupo Afinidad Otros&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  else 7 end --Individual   &#xA;&#x9;FROM H_COMER_STOCK_AFILIA H left join AUX_COMER_PROYECTO_EMPRESAS T on (T.W20NAF = H.afiliado and T.W20SAF = H.subnumero)&#xA;&#x9;JOIN DW_SALUD.dbo.D_EMPRESAS E on (E.id_empresa = H.id_empresa_PE and E.Id_Tipo_Entidad = H.Id_Tipo_Entidad_PE)&#xA;&#x9;WHERE id_ramo_empresa in (1, 12, 13, 20) and H.id_periodo = @Periodo&#xA;&#xA;&#xA;&#xA;/* para el ramo 14 (empresas de sancor) y las empresas que se especifican se las debe tratar como individual  */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA &#xA;&#x9;&#x9;SET id_factura_A_E = 'A',&#xA;&#x9;&#x9;&#x9;id_empresa_PE = WL7GPO,&#xA;&#x9;&#x9;&#x9;Id_Tipo_Entidad_PE = case when (WL7GPO not in (0)) then 'G'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else 'I' end,&#xA;&#x9;&#x9;&#x9;id_marca_PE = case when (WL7GPO in (254,324,472,641,689,691,719,723)) then 1  -- TarjCred/CBU &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;   when (WL7GPO not in (254,324,472,641,689,691,719,723,0)) then 8 --Grupo Afinidad Otros&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  else 7 end --Individual&#xA;&#x9;FROM H_COMER_STOCK_AFILIA H left join AUX_COMER_PROYECTO_EMPRESAS T on (T.W20NAF = H.afiliado and T.W20SAF = H.subnumero)&#xA;&#x9;JOIN DW_SALUD.dbo.D_EMPRESAS E on (E.id_empresa = H.id_empresa_PE and E.Id_Tipo_Entidad = H.Id_Tipo_Entidad_PE)&#xA;&#x9;WHERE id_ramo_empresa in (14) and E.id_empresa in (310018,98454,291002,312299) and H.id_periodo = @Periodo&#xA;&#xA;&#xA;/* Sindicales - OSCICA Y MICA - OSMAD Y FEMA&#xA;Estos casos son convenios empresas, lo de OSCICA Y OSMAD se identifica por el subproducto (ya fueron categorizados), en cambio para MICA Y FEMA entran como &#xA;producto gravado, y se identifican por la empresa a la que facturan, 390765 y 390764 */&#xA;/* El convenio de electricistas navales  OSEN se identifica por la empresa 407812, tmb puede hacerce por el producto 88, pero de comercial lo hacer por la empresa&#xA;asi que lo marcamos como sindical a travez de ésta */&#xA;&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;&#x9;set id_marca_PE = 6&#xA;&#x9;WHERE Id_Tipo_Entidad_PE not in ('G') and id_periodo = @Periodo and &#xA;&#x9;id_empresa_PE in (390764, --FEMA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  390765, --MICA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  407812, --OSEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;  414018) --FOSDIC &#xA;&#x9;&#xA;&#xA;&#xA;/* Lo que corresponde a OSCONARA se carga en el stock con un GA, pero no corresponde este analisis, por eso forzamos la categoria de sindical &#xA;a todo lo que tenga prod y aubprod de OSCONARA */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;SET id_marca_PE = 6&#xA;&#x9;WHERE (id_producto = 83 or id_subproducto = 84) and id_periodo = @Periodo&#xA;&#xA;/*una vez que tenemos marcados todos los casos que son sindicales, identificamos mediante un ID a cada convenio &#xA;esto se prodría haber hecho antes de pegar la marca de sindical, pero como fue un agregado posterior a ello, quedo de esta forma. */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA &#xA;&#x9;&#x9;set id_convenio_especial = case when id_subproducto = 42 then 1 --OSME&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when id_subproducto = 40 then 2 --OSUTI&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 84 OR id_producto = 83) then 3 --OSCONARA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 75 OR id_producto = 68) then 4 --OSTEL &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 85 OR id_empresa_PE = 390765) then 5 --OSCICA - MICA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when id_subproducto = 86 then 6 --FRUTOS DEL PAIS&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 87 OR id_empresa_PE = 390764)then 7 --OSMAD - FEMA&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when (id_subproducto = 91 OR id_empresa_PE = 414018)then 10 --OSDIC - FOSDIC&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;when id_empresa_PE = 407812 then 9 --OSEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN id_producto = 93 OR id_subproducto = 94 then 11 --OSPIQYP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN (id_producto = 95 OR id_subproducto = 97 OR (id_producto = 44 AND id_subproducto = 96)) THEN 12 --OSPEGAP&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else 0 --SIN CONVENIO ESPECIAL &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;WHERE id_periodo = @Periodo and id_marca_PE = 6&#xA;&#xA;/* Se tiene que hacer una actualizacion exclusiva para OSPACA xq no tiene marca sindical (6), pero si deve tener el id de convenio que le corresponde(8) */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;set id_convenio_especial = 8 --OSPACA&#xA;&#x9;WHERE id_periodo = @Periodo  and id_marca_PE = 10 --corresponde a la marca de OSPACA&#xA;&#xA;-- Lo que queda en null, se pasa a 0 que es el id que no tiene convenio.&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA set id_convenio_especial = 0&#xA;&#x9;WHERE id_convenio_especial is null and id_periodo = @Periodo&#xA;&#xA;&#xA;/* por pedido de comercial (Ramiro) se debe identificar tambien a AMPS, por eso para el producto 18 se creo una marca_PE especial (9) */&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#x9;set id_marca_PE = 9 --AMPS&#xA;&#x9;WHERE id_periodo = @Periodo and id_producto = 18 --producto de AMPS &#xA;&#xA;&#xA;/* LOS CASOS QUE QUEDAN EN NULL, O VACIO SE LE PONE UN VALOR POR DEFECTO(S/D) PARA EVITAR TENER CAMPOS NULL EN LA BASE */&#xA;&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;SET id_factura_A_E = 'X',&#xA;&#x9;&#x9;id_marca_PE = 0,&#xA;&#x9;&#x9;id_empresa_PE = 0&#xA;&#x9;WHERE id_periodo = @Periodo AND id_factura_A_E IS NULL&#xA;&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;SET id_factura_A_E = 'X',&#xA;&#x9;&#x9;id_marca_PE = 0,&#xA;&#x9;&#x9;id_empresa_PE = 0&#xA;&#x9;WHERE id_periodo = @Periodo AND id_factura_A_E NOT IN ('A','E')&#xA;&#xA;-- LUEGO DE ANALIZAR ALGUNOS CASOS CON F/D PASAMOS TODO A INDIVIDUAL&#xA;&#x9;UPDATE H_COMER_STOCK_AFILIA&#xA;&#x9;SET id_factura_A_E = 'A',&#xA;&#x9;&#x9;id_marca_PE = 7,&#xA;&#x9;&#x9;id_tipo_entidad_PE = 'I',&#xA;&#x9;&#x9;id_empresa_PE = 0&#xA;&#x9;where id_periodo = @Periodo and id_factura_A_E = 'X'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{6F639F60-9DB7-4027-965B-E31746FFE218}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Actualizar AUX_COMER_PROYECTO_EMPRESAS"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server v10; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <pipeline
          BLOBTempStoragePath=""
          bufferTempStoragePath=""
          version="1">
          <components>
            <component
              refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column"
              componentClassID="Microsoft.DerivedColumn"
              contactInfo="Derived Column;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
              description="Updates column values using expressions"
              name="Derived Column"
              usesDispositions="true">
              <inputs>
                <input
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Inputs[Derived Column Input]"
                  description="Input to the Derived Column Transformation"
                  name="Derived Column Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Inputs[Derived Column Input].Columns[WL7GPO]"
                      cachedDataType="numeric"
                      cachedName="WL7GPO"
                      cachedPrecision="5"
                      errorOrTruncationOperation="Computation"
                      errorRowDisposition="FailComponent"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[WL7GPO]"
                      truncationRowDisposition="FailComponent"
                      usageType="readWrite">
                      <properties>
                        <property
                          containsID="true"
                          dataType="System.String"
                          description="Derived Column Expression"
                          name="Expression">[ISNULL](#{Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[WL7GPO]}) ? 0 : #{Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[WL7GPO]}</property>
                        <property
                          containsID="true"
                          dataType="System.String"
                          description="Derived Column Friendly Expression"
                          expressionType="Notify"
                          name="FriendlyExpression">ISNULL(WL7GPO) ? 0 : WL7GPO</property>
                      </properties>
                    </inputColumn>
                  </inputColumns>
                  <externalMetadataColumns />
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Outputs[Derived Column Output]"
                  description="Default Output of the Derived Column Transformation"
                  exclusionGroup="1"
                  name="Derived Column Output"
                  synchronousInputId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Inputs[Derived Column Input]">
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Outputs[Derived Column Error Output]"
                  description="Error Output of the Derived Column Transformation"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="Derived Column Error Output"
                  synchronousInputId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Inputs[Derived Column Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Outputs[Derived Column Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Outputs[Derived Column Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Outputs[Derived Column Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Outputs[Derived Column Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="OLE DB Destination"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[AUX_COMER_PROYECTO_EMPRESAS]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Connections[OleDbConnection]"
                  connectionManagerID="{C58967E1-D6E6-45BE-BAEB-DD39AA465CE7}:external"
                  connectionManagerRefId="Project.ConnectionManagers[DS_DW_SALUD]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[W20NAF]"
                      cachedDataType="numeric"
                      cachedName="W20NAF"
                      cachedPrecision="8"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[W20NAF]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20NAF]" />
                    <inputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[W20SAF]"
                      cachedDataType="numeric"
                      cachedName="W20SAF"
                      cachedPrecision="3"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[W20SAF]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20SAF]" />
                    <inputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[W20PFA]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="W20PFA"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[W20PFA]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20PFA]" />
                    <inputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[WL7GPO]"
                      cachedDataType="numeric"
                      cachedName="WL7GPO"
                      cachedPrecision="5"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[WL7GPO]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[WL7GPO]" />
                    <inputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[W20CPF]"
                      cachedDataType="numeric"
                      cachedName="W20CPF"
                      cachedPrecision="8"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[W20CPF]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20CPF]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[W20NAF]"
                      dataType="numeric"
                      name="W20NAF"
                      precision="8" />
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[W20SAF]"
                      dataType="numeric"
                      name="W20SAF"
                      precision="3" />
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[W20PFA]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="W20PFA" />
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[WL7GPO]"
                      dataType="numeric"
                      name="WL7GPO"
                      precision="5" />
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[W20CPF]"
                      dataType="numeric"
                      name="W20CPF"
                      precision="8" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SqlServer v10; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE DB Source"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">select W20NAF, W20SAF, W20PFA, WL7GPO, W20CPF
from SMPLIBD.M20FPAD Pad 
left join SMPLIBD.M07FSAL Sal on (Pad.W20NAF = Sal.WL7NAF AND Pad.W20SAF = Sal.WL7SAF)
where Pad.W20TIP = 'P'</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Connections[OleDbConnection]"
                  connectionManagerID="{DEF61386-9B9F-4B6A-B439-088B2A65DD60}:external"
                  connectionManagerRefId="Project.ConnectionManagers[DS_HOST03]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20NAF]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[W20NAF]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20NAF]"
                      name="W20NAF"
                      precision="8"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20SAF]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[W20SAF]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20SAF]"
                      name="W20SAF"
                      precision="3"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20PFA]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[W20PFA]"
                      length="1"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20PFA]"
                      name="W20PFA"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[WL7GPO]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[WL7GPO]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[WL7GPO]"
                      name="WL7GPO"
                      precision="5"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20CPF]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[W20CPF]"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].Columns[W20CPF]"
                      name="W20CPF"
                      precision="8"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[W20NAF]"
                      dataType="numeric"
                      name="W20NAF"
                      precision="8" />
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[W20SAF]"
                      dataType="numeric"
                      name="W20SAF"
                      precision="3" />
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[W20PFA]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="W20PFA" />
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[WL7GPO]"
                      dataType="numeric"
                      name="WL7GPO"
                      precision="5" />
                    <externalMetadataColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[W20CPF]"
                      dataType="numeric"
                      name="W20CPF"
                      precision="8" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[W20NAF]"
                      dataType="numeric"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[W20NAF]"
                      name="W20NAF"
                      precision="8" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[W20SAF]"
                      dataType="numeric"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[W20SAF]"
                      name="W20SAF"
                      precision="3" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[W20PFA]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[W20PFA]"
                      name="W20PFA" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[WL7GPO]"
                      dataType="numeric"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[WL7GPO]"
                      name="WL7GPO"
                      precision="5" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[W20CPF]"
                      dataType="numeric"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[W20CPF]"
                      name="W20CPF"
                      precision="8" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS.Paths[Derived Column Output]"
              endId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination.Inputs[OLE DB Destination Input]"
              name="Derived Column Output"
              startId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Outputs[Derived Column Output]" />
            <path
              refId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS.Paths[OLE DB Source Output]"
              endId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column.Inputs[Derived Column Input]"
              name="OLE DB Source Output"
              startId="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Borrar AUX_COMER_PROYECTO_EMPRESAS"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4FE915E8-4D8D-4B90-B21D-43CEFBE36DC6}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Borrar AUX_COMER_PROYECTO_EMPRESAS"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C58967E1-D6E6-45BE-BAEB-DD39AA465CE7}"
          SQLTask:SqlStatementSource="TRUNCATE TABLE AUX_COMER_PROYECTO_EMPRESAS" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{F2C45858-07ED-49A9-8F19-B25CD55928DF}"
      DTS:From="Package\Borrar AUX_COMER_PROYECTO_EMPRESAS"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{B03D9933-56DD-45DC-9E51-02F72833BC8A}"
      DTS:From="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Actualizacion en H_COMER_STOCK_AFILIA" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{6AF4BC4A-0766-438E-9740-86E74B48EB35}"
      DTS:From="Package\Actualizacion en H_COMER_STOCK_AFILIA"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Actualizacion en H_ALTAS_GENUINAS" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{053C60B5-7164-4A17-80EF-FE08C0C5B0CF}"
      DTS:From="Package\Actualizacion en H_ALTAS_GENUINAS"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Actualizacion en H_BAJAS_GENUINAS" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{675D4B8D-093C-41AB-9BA0-BE3B3C419F56}"
      DTS:From="Package\Actualiza D_EMPRESAS e Historial_marca_interes_comercial"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\Borrar AUX_COMER_PROYECTO_EMPRESAS" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="362,44"
          Id="Package\Actualiza D_EMPRESAS e Historial_marca_interes_comercial"
          TopLeft="5.5,7.5377358490566" />
        <NodeLayout
          Size="239,44"
          Id="Package\Actualizacion en H_ALTAS_GENUINAS"
          TopLeft="67.3490566037736,287.084905660377" />
        <NodeLayout
          Size="239,44"
          Id="Package\Actualizacion en H_BAJAS_GENUINAS"
          TopLeft="67.3490566037736,358.632075471698" />
        <NodeLayout
          Size="285,44"
          Id="Package\Actualizacion en H_COMER_STOCK_AFILIA"
          TopLeft="44.4056603773585,220.179245283019" />
        <NodeLayout
          Size="265,44"
          Id="Package\Actualizacion en H_COMER_STOCK_AFILIA vigente hasta 08-2018"
          TopLeft="418.028301886792,5.5" />
        <NodeLayout
          Size="288,44"
          Id="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS"
          TopLeft="42.8962264150943,147.877358490566" />
        <NodeLayout
          Size="271,44"
          Id="Package\Borrar AUX_COMER_PROYECTO_EMPRESAS"
          TopLeft="51.3867924528302,74.8962264150943" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="186.669811320755,118.820754716981">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29.0566037735849"
              Start="0,0"
              End="0,21.5566037735849">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.5566037735849" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="186.669811320755,191.801886792453">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,28.377358490566"
              Start="0,0"
              End="0,20.877358490566">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,20.877358490566" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="186.669811320755,264.103773584906">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,22.9811320754717"
              Start="0,0"
              End="0,15.4811320754717">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,15.4811320754717" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="186.669811320755,331.009433962264">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27.6226415094339"
              Start="0,0"
              End="0,20.1226415094339">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,20.1226415094339" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="186.707547169811,51.4622641509434">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-0.0377358490566166,23.4339622641509"
              Start="0,0"
              End="-0.0377358490566166,15.9339622641509">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,11.6981132075472" />
                  <mssgle:LineSegment
                    End="-0.0377358490566166,11.6981132075472" />
                  <mssgle:LineSegment
                    End="-0.0377358490566166,15.9339622641509" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="177,42"
          Id="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination"
          TopLeft="5.50000000000003,209.5" />
        <NodeLayout
          Size="157,42"
          Id="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source"
          TopLeft="15.5,5.5" />
        <NodeLayout
          Size="158,42"
          Id="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\Derived Column"
          TopLeft="15,107.5" />
        <EdgeLayout
          Id="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS.Paths[OLE DB Source Output]"
          TopLeft="94,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS.Paths[Derived Column Output]"
          TopLeft="94,149.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Destination">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Actualizar AUX_COMER_PROYECTO_EMPRESAS\OLE DB Source">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>